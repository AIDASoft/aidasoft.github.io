<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>DD4hep: /afs/cern.ch/user/m/mpetric/nightly_cppcheck/dd4hep/DDG4/plugins/Geant4TrackerWeightedSD.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="DD4hep.css" rel="stylesheet" type="text/css" />
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 100px;">
  <td id="projectlogo"><img alt="Logo" src="../doc/LaTex/CERN-logo.png" height="72"/></td>
  <td id="projectlogo"><img alt="Logo" src="DD4hep-AIDA-logo.png" height="72"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectbrief">DD4hep - The AIDA detector description toolkit for high energy physics experiments</div>
   <div id="projectname">DD4hep
   &#160;<span id="projectnumber">Rev:exported</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dd77d67ee2e5674e427bb81b037d3ccd.html">DDG4</a></li><li class="navelem"><a class="el" href="dir_a075450c9d7ff3a3611d36c5cf3c1c76.html">plugins</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Geant4TrackerWeightedSD.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_geant4_tracker_weighted_s_d_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// $Id$</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//==========================================================================</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//  AIDA Detector description implementation for LCD</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Copyright (C) Organisation europeenne pour la Recherche nucleaire (CERN)</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// All rights reserved.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// For the licensing terms see $DD4hepINSTALL/LICENSE.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// For the list of contributors see $DD4hepINSTALL/doc/CREDITS.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// Author     : M.Frank</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//==========================================================================</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// Framework include files</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_d_d4hep_units_8h.html">DD4hep/DD4hepUnits.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_geant4_sens_det_action_8inl.html">DDG4/Geant4SensDetAction.inl</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_geant4_stepping_action_8h.html">DDG4/Geant4SteppingAction.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_geant4_tracking_action_8h.html">DDG4/Geant4TrackingAction.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_geant4_event_action_8h.html">DDG4/Geant4EventAction.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;G4Event.hh&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;G4VSolid.hh&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_d_d4hep.html">DD4hep</a> {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keyword">namespace </span>Simulation   {</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespace_geometry.html">Geometry</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html">   70</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html">TrackerWeighted</a> {</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a99a4be34af7901b0aab7398894ba906a">   71</a></span>&#160;      <span class="keyword">typedef</span> <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection.html">Geant4HitCollection</a> <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a99a4be34af7901b0aab7398894ba906a">HitCollection</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keyword">enum</span>  {</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8cdc474134c1f8b3a8344e32fc3d4421a675d7a02b8891bd8f45bc5f27c5c1746">   75</a></span>&#160;        POSITION_WEIGHTED  = 1, <span class="comment">// Use energy weights to define the position of the energy deposit</span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8cdc474134c1f8b3a8344e32fc3d4421a4b7f40d92a4823d71b75c6894d032489">   76</a></span>&#160;        POSITION_MIDDLE    = 2, <span class="comment">// Set the hit position between the step pre and post point</span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8cdc474134c1f8b3a8344e32fc3d4421a1419a617e564f58140744d38381ee4c1">   77</a></span>&#160;        POSITION_PREPOINT  = 3, <span class="comment">// Set the hit position to the position of the step pre point</span></div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8cdc474134c1f8b3a8344e32fc3d4421ac0ca75f525d337568debb34bf3545e29">   78</a></span>&#160;        POSITION_POSTPOINT = 4  <span class="comment">// Set the hit position to the position of the step post point</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      };</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      </div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a3bb8dbd97551f655071ce36e357593ef">   81</a></span>&#160;      <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html">Geant4Tracker::Hit</a>    <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a3bb8dbd97551f655071ce36e357593ef">pre</a>, post;</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ab378f01fcca56a21b21f3d90c600c984">   82</a></span>&#160;      <a class="code" href="namespace_d_d4hep_1_1_geometry.html#a55083902099d03506c6db01b80404900">Position</a>              <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ab378f01fcca56a21b21f3d90c600c984">mean_pos</a>;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a6c247f2290b5f072a9be93c75dacf631">   83</a></span>&#160;      <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html">Geant4Sensitive</a>*      <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a6c247f2290b5f072a9be93c75dacf631">sensitive</a>;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a75a27a45aa4197181191c68eb92f9863">   84</a></span>&#160;      <a class="code" href="class_g4_v_sensitive_detector.html">G4VSensitiveDetector</a>* <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a75a27a45aa4197181191c68eb92f9863">thisSD</a>;</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a77ce382a300e188a9ed772615abfa4f2">   85</a></span>&#160;      <span class="keywordtype">double</span>                <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a77ce382a300e188a9ed772615abfa4f2">distance_to_inside</a>;</div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ad898a4f6ed0a4424a2bd8f7d52292c32">   86</a></span>&#160;      <span class="keywordtype">double</span>                <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ad898a4f6ed0a4424a2bd8f7d52292c32">distance_to_outside</a>;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a222fd48188979006e286b3688452ff6d">   87</a></span>&#160;      <span class="keywordtype">double</span>                <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a222fd48188979006e286b3688452ff6d">mean_time</a>;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a82fd5f47ec95d179a132145c54a78873">   88</a></span>&#160;      <span class="keywordtype">double</span>                <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a82fd5f47ec95d179a132145c54a78873">step_length</a>;</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a404e62198a8830c8e6b7c185873bb4d1">   89</a></span>&#160;      <span class="keywordtype">double</span>                <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a404e62198a8830c8e6b7c185873bb4d1">e_cut</a>;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8fcddaa426fa0d7a901991856f3f4d1a">   90</a></span>&#160;      <span class="keywordtype">int</span>                   current, <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8fcddaa426fa0d7a901991856f3f4d1a">parent</a>;</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a7059ba8b2d85cb67220b0184f038f9f9">   91</a></span>&#160;      <span class="keywordtype">int</span>                   <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a7059ba8b2d85cb67220b0184f038f9f9">combined</a>;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a5120f0b661148efb35b7432c8c58c7ce">   92</a></span>&#160;      <span class="keywordtype">int</span>                   <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a5120f0b661148efb35b7432c8c58c7ce">hit_position_type</a>;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a9ffa7f998b3a1f16864ecbb894ca2e54">   93</a></span>&#160;      <span class="keywordtype">int</span>                   <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a9ffa7f998b3a1f16864ecbb894ca2e54">hit_flag</a>;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a1205a645db026a115eb182e439929818">   94</a></span>&#160;      <span class="keywordtype">int</span>                   <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a1205a645db026a115eb182e439929818">g4ID</a>;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#afc2a6289bb11f08b03d50e0b8e271083">   95</a></span>&#160;      EInside               <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#afc2a6289bb11f08b03d50e0b8e271083">last_inside</a>;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aeced4bab28aa79ad7bab14ca9ce02c79">   96</a></span>&#160;      <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>         <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aeced4bab28aa79ad7bab14ca9ce02c79">cell</a>;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aca48801717dfd735529eb3fda99e999a">   97</a></span>&#160;      <span class="keywordtype">bool</span>                  <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aca48801717dfd735529eb3fda99e999a">single_deposit_mode</a>;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ae628c5cfae79d839a0640338ba31a6ad">   98</a></span>&#160;      <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ae628c5cfae79d839a0640338ba31a6ad">TrackerWeighted</a>() : pre(), post(), sensitive(0), thisSD(0), </div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                          distance_to_inside(0.0), distance_to_outside(0.0), mean_time(0.0), </div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                          step_length(0.0), e_cut(0.0), current(-1), parent(0), combined(0),</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                          hit_position_type(POSITION_MIDDLE), hit_flag(0), g4ID(0), cell(0),</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                          single_deposit_mode(false)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a0c6304d5c3a6b0964f7388c3440235db">  107</a></span>&#160;      <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html">TrackerWeighted</a>&amp; <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a0c6304d5c3a6b0964f7388c3440235db">clear</a>()   {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        mean_pos.SetXYZ(0,0,0);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        distance_to_inside = 0;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        distance_to_outside = 0;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        mean_time = 0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        step_length  = 0;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#aafcd9c0b786c16d9db3de2de661c9200">clear</a>();</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#aafcd9c0b786c16d9db3de2de661c9200">clear</a>();</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        current  = -1;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        parent   = -1;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        combined =  0;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        cell     =  0;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        hit_flag =  0;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        g4ID     =  0;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        last_inside = kOutside;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#abb50962377c010e8430400035d5e3dcf">  126</a></span>&#160;      <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html">TrackerWeighted</a>&amp; <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#abb50962377c010e8430400035d5e3dcf">start</a>(<span class="keyword">const</span> G4Step* step, <span class="keyword">const</span> G4StepPoint* point)   {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        clear();</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a8f2563ce396b2d2f7f6c6534aed3cdb4">storePoint</a>(step,point);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a34177a48fce1f52d1b58d6ab47e1cacc">deposit</a> = 0.0;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a34177a48fce1f52d1b58d6ab47e1cacc">deposit</a> = 0.0;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        current = pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a80a8546851d931b3b39e690a3bc1b3d8">trackID</a>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        sensitive-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html#a5dd1e49bfcc1937ad6dc302f969ee544">mark</a>(step-&gt;GetTrack());</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        post = pre;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        parent = step-&gt;GetTrack()-&gt;GetParentID();</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        g4ID = step-&gt;GetTrack()-&gt;GetTrackID();</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8ffc0941260d20698a82015cd39cf744">  140</a></span>&#160;      <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html">TrackerWeighted</a>&amp; <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8ffc0941260d20698a82015cd39cf744">update</a>(<span class="keyword">const</span> G4Step* step)   {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a8f2563ce396b2d2f7f6c6534aed3cdb4">storePoint</a>(step,step-&gt;GetPostStepPoint());</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="namespace_d_d4hep_1_1_geometry.html#a55083902099d03506c6db01b80404900">Position</a> mean    = (post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a7f992369c5178cac0cc00ffc8a9c36a0">position</a>+pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a7f992369c5178cac0cc00ffc8a9c36a0">position</a>)*0.5;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">double</span>   mean_tm = (post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a2d1cbbdb9da1af65acb58ef97fe10277">time</a>+pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a2d1cbbdb9da1af65acb58ef97fe10277">time</a>)*0.5;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a34177a48fce1f52d1b58d6ab47e1cacc">deposit</a> += post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a34177a48fce1f52d1b58d6ab47e1cacc">deposit</a>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        mean_pos.SetX(mean_pos.x()+mean.x()*post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a34177a48fce1f52d1b58d6ab47e1cacc">deposit</a>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        mean_pos.SetY(mean_pos.y()+mean.y()*post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a34177a48fce1f52d1b58d6ab47e1cacc">deposit</a>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        mean_pos.SetZ(mean_pos.z()+mean.z()*post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a34177a48fce1f52d1b58d6ab47e1cacc">deposit</a>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        mean_time += mean_tm*post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a34177a48fce1f52d1b58d6ab47e1cacc">deposit</a>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        step_length  += step-&gt;GetStepLength();</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span> ( 0 == cell )   {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          cell = sensitive-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html#a1e79173455ccff4d70cd1325b26ad3e9">cellID</a>(step);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <span class="keywordflow">if</span> ( 0 == cell )  {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            cell = sensitive-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html#a9aa1270e3fb490a4ebe511343903d72f">volumeID</a>(step) ;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            sensitive-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_action.html#a9817394f45f311d2fb19f544e9a72e23">except</a>(<span class="stringliteral">&quot;+++ Invalid CELL ID for hit!&quot;</span>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        ++combined;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aecd97f73f71f722a320badfe3272e374">  162</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aecd97f73f71f722a320badfe3272e374">mustSaveTrack</a>(<span class="keyword">const</span> G4Track* tr)<span class="keyword">  const   </span>{</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">return</span> current &gt; 0 &amp;&amp; current != tr-&gt;GetTrackID();</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8299b772daa5da7c49399a40c1de172d">  167</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8299b772daa5da7c49399a40c1de172d">extractHit</a>(EInside ended)   {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection.html">Geant4HitCollection</a>* collection = sensitive-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html#a49d2a794d7824475b7bac71d7342306b">collection</a>(0);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        extractHit(collection, ended);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ac7628c08fbf29a1dc2133ac7b30e1499">  172</a></span>&#160;      <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html">TrackerWeighted</a>&amp; <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ac7628c08fbf29a1dc2133ac7b30e1499">calc_dist_out</a>(<span class="keyword">const</span> G4VSolid* solid)    {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="namespace_d_d4hep_1_1_geometry.html#a55083902099d03506c6db01b80404900">Position</a> <a class="code" href="_multi_view_8cpp.html#a8320ee13ac034dbf6d624fe8953dd337">v</a>(pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#abdd1f621f202ef83c2078a52cbb242b3">momentum</a>.unit()), &amp;p=post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a7f992369c5178cac0cc00ffc8a9c36a0">position</a>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordtype">double</span> dist = solid-&gt;DistanceToOut(G4ThreeVector(p.X(),p.Y(),p.Z()),</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                           G4ThreeVector(<a class="code" href="_multi_view_8cpp.html#a8320ee13ac034dbf6d624fe8953dd337">v</a>.X(),<a class="code" href="_multi_view_8cpp.html#a8320ee13ac034dbf6d624fe8953dd337">v</a>.Y(),<a class="code" href="_multi_view_8cpp.html#a8320ee13ac034dbf6d624fe8953dd337">v</a>.Z()));</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        distance_to_outside = dist;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aa9139da9ecb7c109b7108cc27a27c13d">  180</a></span>&#160;      <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html">TrackerWeighted</a>&amp; <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aa9139da9ecb7c109b7108cc27a27c13d">calc_dist_in</a>(<span class="keyword">const</span> G4VSolid* solid)    {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <a class="code" href="namespace_d_d4hep_1_1_geometry.html#a55083902099d03506c6db01b80404900">Position</a> <a class="code" href="_multi_view_8cpp.html#a8320ee13ac034dbf6d624fe8953dd337">v</a>(pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#abdd1f621f202ef83c2078a52cbb242b3">momentum</a>.unit()), &amp;p=pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a7f992369c5178cac0cc00ffc8a9c36a0">position</a>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordtype">double</span> dist = solid-&gt;DistanceToOut(G4ThreeVector(p.X(),p.Y(),p.Z()),</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                           G4ThreeVector(<a class="code" href="_multi_view_8cpp.html#a8320ee13ac034dbf6d624fe8953dd337">v</a>.X(),<a class="code" href="_multi_view_8cpp.html#a8320ee13ac034dbf6d624fe8953dd337">v</a>.Y(),<a class="code" href="_multi_view_8cpp.html#a8320ee13ac034dbf6d624fe8953dd337">v</a>.Z()));</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        distance_to_inside = dist;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a690b6f7fdcda6bbec2e7cb89f4fce9af">  188</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a690b6f7fdcda6bbec2e7cb89f4fce9af">extractHit</a>(<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection.html">Geant4HitCollection</a>* collection, EInside ended)   {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordtype">double</span> deposit  = pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a34177a48fce1f52d1b58d6ab47e1cacc">deposit</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">if</span> ( current != -1 )  {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          <a class="code" href="namespace_d_d4hep_1_1_geometry.html#a55083902099d03506c6db01b80404900">Position</a> pos;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          <a class="code" href="namespace_d_d4hep_1_1_simulation.html#aead01eb580dc503a5abba194d179c963">Momentum</a> mom  = 0.5 * (pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#abdd1f621f202ef83c2078a52cbb242b3">momentum</a> + post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#abdd1f621f202ef83c2078a52cbb242b3">momentum</a>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <span class="keywordtype">double</span>   time = deposit != 0 ? mean_time / deposit : mean_time;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          <span class="keywordtype">char</span>     dist_in[64], dist_out[64];</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          <span class="keywordflow">switch</span>(hit_position_type)  {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;          <span class="keywordflow">case</span> POSITION_WEIGHTED:</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            pos = deposit != 0 ? mean_pos / deposit : mean_pos;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          <span class="keywordflow">case</span> POSITION_PREPOINT:</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            pos = pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a7f992369c5178cac0cc00ffc8a9c36a0">position</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          <span class="keywordflow">case</span> POSITION_POSTPOINT:</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            pos = post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a7f992369c5178cac0cc00ffc8a9c36a0">position</a>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          <span class="keywordflow">case</span> POSITION_MIDDLE:</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          <span class="keywordflow">default</span>:</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            pos = (post.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a7f992369c5178cac0cc00ffc8a9c36a0">position</a> + pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a7f992369c5178cac0cc00ffc8a9c36a0">position</a>) / 2.0;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          <span class="keywordflow">if</span> ( ended == kSurface || distance_to_outside &lt; numeric_limits&lt;float&gt;::epsilon() )</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            hit_flag |= Geant4Tracker::Hit::HIT_ENDED_SURFACE;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ended == kInside )</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            hit_flag |= Geant4Tracker::Hit::HIT_ENDED_INSIDE;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ended == kOutside )</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            hit_flag |= Geant4Tracker::Hit::HIT_ENDED_OUTSIDE;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html">Geant4Tracker::Hit</a>* hit = <span class="keyword">new</span> <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html">Geant4Tracker::Hit</a>(pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a80a8546851d931b3b39e690a3bc1b3d8">trackID</a>,</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                                           pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a7b755dfa6639f3cc02cd4696719d0580">pdgID</a>,</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                                           deposit,time);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          hit-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data.html#aee4dddb74fa4230f4a450f5eb96416af">flag</a>     = hit_flag;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          hit-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a7f992369c5178cac0cc00ffc8a9c36a0">position</a> = pos;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          hit-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#abdd1f621f202ef83c2078a52cbb242b3">momentum</a> = mom;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          hit-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a39d50debf1a95beaad59be2477877327">length</a>   = step_length;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          hit-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data.html#a3ad003b720e4d7a1c6e66e0eabb58540">cellID</a>   = cell;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          hit-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data.html#adaf354d937bc941aac70b2327aa1d1f3">g4ID</a>     = g4ID;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          dist_in[0] = dist_out[0] = 0;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          <span class="keywordflow">if</span> ( !(hit_flag&amp;Geant4Tracker::Hit::HIT_STARTED_SURFACE) )</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            ::snprintf(dist_in,<span class="keyword">sizeof</span>(dist_in),<span class="stringliteral">&quot; [%.2e um]&quot;</span>,distance_to_inside/<a class="code" href="namespacedd4hep.html#a7ca6a7ec6a20ddb5678bd46c47996d26">CLHEP::um</a>);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          <span class="keywordflow">if</span> ( !(hit_flag&amp;Geant4Tracker::Hit::HIT_ENDED_SURFACE) )</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            ::snprintf(dist_out,<span class="keyword">sizeof</span>(dist_out),<span class="stringliteral">&quot; [%.2e um]&quot;</span>,distance_to_outside/<a class="code" href="namespacedd4hep.html#a7ca6a7ec6a20ddb5678bd46c47996d26">CLHEP::um</a>);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          sensitive-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_action.html#a623119a9f20ff7f5a2fb78f4f76b9276">print</a>(<span class="stringliteral">&quot;+++ G4Track:%5d CREATE hit[%03d]:%3d deps E:&quot;</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                           <span class="stringliteral">&quot; %.2e keV Pos:%7.2f %7.2f %7.2f [mm] Start:%s%s%s%s End:%s%s%s%s&quot;</span>,</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                           pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a80a8546851d931b3b39e690a3bc1b3d8">trackID</a>,<span class="keywordtype">int</span>(collection-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection.html#adccefc2f8a73f693d2b87b146db87d44">GetSize</a>()),</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                           combined,pre.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">truth</a>.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a34177a48fce1f52d1b58d6ab47e1cacc">deposit</a>/<a class="code" href="namespacedd4hep.html#a2b928c9b9d50fa8a9d3f9840f3a5f258">CLHEP::keV</a>,</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                           pos.X()/<a class="code" href="namespacedd4hep.html#a124f4e9c11400c971e1a829ba8d4a3d0">CLHEP::mm</a>,pos.Y()/<a class="code" href="namespacedd4hep.html#a124f4e9c11400c971e1a829ba8d4a3d0">CLHEP::mm</a>,pos.Z()/<a class="code" href="namespacedd4hep.html#a124f4e9c11400c971e1a829ba8d4a3d0">CLHEP::mm</a>,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                           ((hit_flag&amp;Geant4Tracker::Hit::HIT_STARTED_SURFACE) ? <span class="stringliteral">&quot;SURFACE&quot;</span> : <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                           ((hit_flag&amp;Geant4Tracker::Hit::HIT_STARTED_OUTSIDE) ? <span class="stringliteral">&quot;OUTSIDE&quot;</span> : <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                           ((hit_flag&amp;Geant4Tracker::Hit::HIT_STARTED_INSIDE)  ? <span class="stringliteral">&quot;INSIDE &quot;</span> : <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                           dist_in,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                           ((hit_flag&amp;Geant4Tracker::Hit::HIT_ENDED_SURFACE)   ? <span class="stringliteral">&quot;SURFACE&quot;</span> : <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                           ((hit_flag&amp;Geant4Tracker::Hit::HIT_ENDED_OUTSIDE)   ? <span class="stringliteral">&quot;OUTSIDE&quot;</span> : <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                           ((hit_flag&amp;Geant4Tracker::Hit::HIT_ENDED_INSIDE)    ? <span class="stringliteral">&quot;INSIDE &quot;</span> : <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                           dist_out);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          collection-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection.html#aeb5ededae3913d70a3aeecfa8ba0b853">add</a>(hit);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        clear();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ab258cb542897a7bd369fd204eafbb245">  253</a></span>&#160;      G4bool <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ab258cb542897a7bd369fd204eafbb245">process</a>(<span class="keyword">const</span> G4Step* step, G4TouchableHistory* )   {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html">Geant4StepHandler</a> h(step);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot; process called - pre pos: &quot; &lt;&lt; h.prePos() &lt;&lt; &quot; post pos &quot; &lt;&lt; h.postPos() </span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">//        &lt;&lt; &quot; edep: &quot; &lt;&lt; h.deposit() &lt;&lt; std::endl ;</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        G4VSolid*     preSolid    = h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aa132f6298c07600c95aa3a6f92f26985">solid</a>(h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a7c18f2d6e46ecbb380fbe0995029accb">pre</a>);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        G4VSolid*     postSolid   = h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aa132f6298c07600c95aa3a6f92f26985">solid</a>(h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aed9081f8334e95c40e321c14621c0a35">post</a>);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        G4ThreeVector local_pre   = h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a2f746a7669e0ab4e52f39e4fbc2cd742">globalToLocalG4</a>(h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a087079e78925eeaedf2e20c394c5c820">prePosG4</a>());</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        G4ThreeVector local_post  = h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a2f746a7669e0ab4e52f39e4fbc2cd742">globalToLocalG4</a>(h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a8724fb0d717e73716f12a30a851a6b3f">postPosG4</a>());</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        EInside       pre_inside  = preSolid-&gt;Inside(local_pre);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        EInside       post_inside = postSolid-&gt;Inside(local_post);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     </div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">void</span>* postPV = h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#afee73068f429b8f9956acad5580493a9">postVolume</a>();</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">void</span>* prePV  = h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#ac40ec64fd69ed915b95fb79cdc20c741">preVolume</a>();</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">void</span>* postSD = h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#adb9d9942e898b61710985c58eda88972">postSD</a>();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">void</span>* preSD  = h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a7b3384fa3ce4d4465a79aa286371b4bb">preSD</a>();</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        G4VSolid* solid = (preSD == thisSD) ? preSolid : postSolid;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">// 1) Track killed inside SD: trace incomplete. This deposition must be added as well.</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">if</span> ( current == h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aeebb8ecf7ce627d87e08d61b712e32b5">trkID</a>() &amp;&amp; !h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a37df3c141c8f16fbad4f17bf32a4538b">trkAlive</a>() )  {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          hit_flag |= Geant4Tracker::Hit::HIT_KILLED_TRACK;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          update(step).calc_dist_out(solid).extractHit(post_inside);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">// 2) Track leaving SD volume. Sensitive detector changed. Store hit.</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( current == h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aeebb8ecf7ce627d87e08d61b712e32b5">trkID</a>() &amp;&amp; postSD != thisSD )  {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          update(step).calc_dist_out(solid).extractHit(kOutside);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="comment">// 3) Track leaving SD volume. Store hit.</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( current == h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aeebb8ecf7ce627d87e08d61b712e32b5">trkID</a>() &amp;&amp; postSD == thisSD &amp;&amp; post_inside == kSurface )  {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          update(step).calc_dist_out(solid).extractHit(kSurface);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="comment">// 4) Track leaving SD volume. Store hit.</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( current == h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aeebb8ecf7ce627d87e08d61b712e32b5">trkID</a>() &amp;&amp; postSD == thisSD &amp;&amp; post_inside == kOutside )  {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          update(step).calc_dist_out(solid).extractHit(post_inside);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">// 5) Normal update: either intermediate deposition or track is going to be killed.</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( current == h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aeebb8ecf7ce627d87e08d61b712e32b5">trkID</a>() &amp;&amp; postSD == thisSD &amp;&amp; post_inside == kInside )  {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          last_inside = post_inside;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          update(step).calc_dist_out(solid);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">// 6) Track from secondary created in SD volume. Store hit from previous. </span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">// --&gt; New hit will be created, to whom also this deposition belongs</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( current != h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aeebb8ecf7ce627d87e08d61b712e32b5">trkID</a>() &amp;&amp; current &gt;= 0 )  {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          extractHit(last_inside);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">// If the hit got extracted, a new one must be set up</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">if</span> ( current &lt; 0 )  {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          EInside  inside  = pre_inside;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <span class="comment">// Track entering SD volume</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          <span class="keywordflow">if</span> ( preSD != thisSD )   {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            start(step, h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aed9081f8334e95c40e321c14621c0a35">post</a>);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            inside = post_inside;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            sensitive-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_action.html#a623119a9f20ff7f5a2fb78f4f76b9276">print</a>(<span class="stringliteral">&quot;++++++++++ Using POST step volume to start hit -- dubious ?&quot;</span>);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          <span class="keywordflow">else</span>  {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            start(step, h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a7c18f2d6e46ecbb380fbe0995029accb">pre</a>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          calc_dist_in(solid);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          <span class="keywordflow">if</span> ( inside == kSurface )</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            hit_flag |= Geant4Tracker::Hit::HIT_STARTED_SURFACE;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( inside == kInside )</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            hit_flag |= Geant4Tracker::Hit::HIT_STARTED_INSIDE;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( inside == kOutside )</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            hit_flag |= Geant4Tracker::Hit::HIT_STARTED_OUTSIDE;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          </div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          <span class="comment">// New (secondary) track created by some process starting inside the volume</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          <span class="keywordflow">if</span> ( inside == kInside )  {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            hit_flag |= Geant4Tracker::Hit::HIT_SECONDARY_TRACK;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="comment">// Update Data</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        last_inside = post_inside;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        update(step);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        calc_dist_out(solid);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="comment">// Track killed inside SD: trace incomplete. This deposition must be added as well.</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">if</span> ( !h.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a37df3c141c8f16fbad4f17bf32a4538b">trkAlive</a>() )  {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          hit_flag |= Geant4Tracker::Hit::HIT_KILLED_TRACK;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;          extractHit(post_inside);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="comment">// Avoid danglich hits if the track leaves the sensitive volume</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( post_inside == kSurface )  {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          extractHit(post_inside);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">// Avoid danglich hits if the track leaves the sensitive volume</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( thisSD == preSD &amp;&amp; (preSD != postSD || prePV != postPV) )  {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          extractHit(post_inside);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment">// This should simply not happen!</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( thisSD == postSD &amp;&amp; (preSD != postSD || prePV != postPV) )  {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          sensitive-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_action.html#a1abdae5d2d2af327f406697322b0d821">error</a>(<span class="stringliteral">&quot;+++++ WRONG!!! Extract. How did we get here?&quot;</span>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          extractHit(post_inside);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">// In single hit mode we MUST write the hit after update</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( single_deposit_mode )  {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;          extractHit(post_inside);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aa489deb875d6f5867917d2b7aae00747">  362</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aa489deb875d6f5867917d2b7aae00747">endEvent</a>()   {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">// We need to add the possibly last added hit to the collection here.</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment">// otherwise the last hit would be assigned to the next event and the</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="comment">// MC truth would be screwed.</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">if</span> ( current &gt; 0 )   {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;          <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection.html">Geant4HitCollection</a>* coll = sensitive-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html#a49d2a794d7824475b7bac71d7342306b">collection</a>(0);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          sensitive-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_action.html#a623119a9f20ff7f5a2fb78f4f76b9276">print</a>(<span class="stringliteral">&quot;++++++++++ Found dangling hit: Is the hit extraction logic correct?&quot;</span>);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          extractHit(coll,last_inside);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      }</div><div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a15fd630fa0e1ca7e3c0516952ad5f976">  374</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a15fd630fa0e1ca7e3c0516952ad5f976">startEvent</a>()   {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        thisSD = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_g4_v_sensitive_detector.html">G4VSensitiveDetector</a>*<span class="keyword">&gt;</span>(&amp;sensitive-&gt;<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html#aec1bfe9ac838d359d9e3948118b5c42d">detector</a>());</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    };</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html#abbda4901e215cc296b7769ed9893d6de">  380</a></span>&#160;    <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html">Geant4SensitiveAction&lt;TrackerWeighted&gt;::initialize</a>() {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      declareProperty(<span class="stringliteral">&quot;HitPositionCombination&quot;</span>, m_userData.hit_position_type);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      declareProperty(<span class="stringliteral">&quot;CollectSingleDeposits&quot;</span>, m_userData.single_deposit_mode);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      m_userData.e_cut = m_sensitive.energyCutoff();</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      m_userData.sensitive = <span class="keyword">this</span>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html#a601b872018378ba77a1573f4458b61e1">  388</a></span>&#160;    <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html">Geant4SensitiveAction&lt;TrackerWeighted&gt;::begin</a>(G4HCofThisEvent* <span class="comment">/* hce */</span>)   {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      m_userData.startEvent();</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html#a9847064b0c71d72bc079dcc4ff00b64f">  393</a></span>&#160;    <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html">Geant4SensitiveAction&lt;TrackerWeighted&gt;::end</a>(G4HCofThisEvent* <span class="comment">/* hce */</span>)   {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      m_userData.endEvent();</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html#af2a7d081e4173833bd77977cbc20ee0f">  398</a></span>&#160;    <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html">Geant4SensitiveAction&lt;TrackerWeighted&gt;::defineCollections</a>() {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      m_collectionID = declareReadoutFilteredCollection&lt;Geant4Tracker::Hit&gt;();</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html#a37038afed1f3cc353e9b16a264d505ec">  403</a></span>&#160;    <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html">Geant4SensitiveAction&lt;TrackerWeighted&gt;::clear</a>(G4HCofThisEvent* <span class="comment">/* hce */</span>) {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      m_userData.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html#a52a9e46a54f3e1605637dc281a878b0d">clear</a>();</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keyword">template</span> &lt;&gt; G4bool</div><div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html#ad11ea4c3e4623fb5e2a8851d1aebb5c7">  409</a></span>&#160;    <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html">Geant4SensitiveAction&lt;TrackerWeighted&gt;::process</a>(G4Step* step, G4TouchableHistory* history) {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordflow">return</span> m_userData.<a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html#a36759982ed0876a5ce81c14973c18077">process</a>(step, history);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="namespace_d_d4hep_1_1_simulation.html#a63833833f53787d1116da0c3bb635dc8">  413</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html">Geant4SensitiveAction&lt;TrackerWeighted&gt;</a>  <a class="code" href="namespace_d_d4hep_1_1_simulation.html#a63833833f53787d1116da0c3bb635dc8">Geant4TrackerWeightedAction</a>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespace_d_d4hep_1_1_simulation.html">DD4hep::Simulation</a>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_d_d_g4_2include_2_d_d_g4_2_factories_8h.html">DDG4/Factories.h</a>&quot;</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<a class="code" href="_d_d_g4_2include_2_d_d_g4_2_factories_8h.html#a4b45b064ac34cecb1cf0a31c2edc346a">DECLARE_GEANT4SENSITIVE</a>(<a class="code" href="namespace_geant4_tracker_weighted_action.html">Geant4TrackerWeightedAction</a>)</div><div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit_html"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html">DD4hep::Simulation::Geant4Tracker::Hit</a></div><div class="ttdoc">DDG4 tracker hit class used by the generic DDG4 tracker sensitive detector. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00228">Geant4Data.h:228</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_aa489deb875d6f5867917d2b7aae00747"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aa489deb875d6f5867917d2b7aae00747">DD4hep::Simulation::TrackerWeighted::endEvent</a></div><div class="ttdeci">void endEvent()</div><div class="ttdoc">Post-event action callback. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00362">Geant4TrackerWeightedSD.cpp:362</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_action_html_a9817394f45f311d2fb19f544e9a72e23"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_action.html#a9817394f45f311d2fb19f544e9a72e23">DD4hep::Simulation::Geant4Action::except</a></div><div class="ttdeci">void except(const char *fmt,...) const</div><div class="ttdoc">Support of exceptions: Print fatal message and throw runtime_error. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_action_8cpp_source.html#l00258">Geant4Action.cpp:258</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_action_html_a623119a9f20ff7f5a2fb78f4f76b9276"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_action.html#a623119a9f20ff7f5a2fb78f4f76b9276">DD4hep::Simulation::Geant4Action::print</a></div><div class="ttdeci">void print(const char *fmt,...) const</div><div class="ttdoc">Support for messages with variable output level using output level. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_action_8cpp_source.html#l00154">Geant4Action.cpp:154</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_aa132f6298c07600c95aa3a6f92f26985"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aa132f6298c07600c95aa3a6f92f26985">DD4hep::Simulation::Geant4StepHandler::solid</a></div><div class="ttdeci">G4VSolid * solid(const G4StepPoint *p) const</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00172">Geant4StepHandler.h:172</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_action_html_a1abdae5d2d2af327f406697322b0d821"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_action.html#a1abdae5d2d2af327f406697322b0d821">DD4hep::Simulation::Geant4Action::error</a></div><div class="ttdeci">void error(const char *fmt,...) const</div><div class="ttdoc">Support of error messages. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_action_8cpp_source.html#l00233">Geant4Action.cpp:233</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_aed9081f8334e95c40e321c14621c0a35"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aed9081f8334e95c40e321c14621c0a35">DD4hep::Simulation::Geant4StepHandler::post</a></div><div class="ttdeci">G4StepPoint * post</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00051">Geant4StepHandler.h:51</a></div></div>
<div class="ttc" id="_geant4_sens_det_action_8inl_html"><div class="ttname"><a href="_geant4_sens_det_action_8inl.html">Geant4SensDetAction.inl</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a99a4be34af7901b0aab7398894ba906a"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a99a4be34af7901b0aab7398894ba906a">DD4hep::Simulation::TrackerWeighted::HitCollection</a></div><div class="ttdeci">Geant4HitCollection HitCollection</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00071">Geant4TrackerWeightedSD.cpp:71</a></div></div>
<div class="ttc" id="namespace_geometry_html"><div class="ttname"><a href="namespace_geometry.html">Geometry</a></div><div class="ttdef"><b>Definition:</b> <a href="_x_m_l_detector_8cpp_source.html#l00023">XMLDetector.cpp:23</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_ab258cb542897a7bd369fd204eafbb245"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ab258cb542897a7bd369fd204eafbb245">DD4hep::Simulation::TrackerWeighted::process</a></div><div class="ttdeci">G4bool process(const G4Step *step, G4TouchableHistory *)</div><div class="ttdoc">Method for generating hit(s) using the information of G4Step object. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00253">Geant4TrackerWeightedSD.cpp:253</a></div></div>
<div class="ttc" id="namespacedd4hep_html_a2b928c9b9d50fa8a9d3f9840f3a5f258"><div class="ttname"><a href="namespacedd4hep.html#a2b928c9b9d50fa8a9d3f9840f3a5f258">dd4hep::keV</a></div><div class="ttdeci">static const double keV</div><div class="ttdef"><b>Definition:</b> <a href="_d_d4hep_units_8h_source.html#l00148">DD4hepUnits.h:148</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_aeebb8ecf7ce627d87e08d61b712e32b5"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#aeebb8ecf7ce627d87e08d61b712e32b5">DD4hep::Simulation::Geant4StepHandler::trkID</a></div><div class="ttdeci">int trkID() const</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00135">Geant4StepHandler.h:135</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit_html_a39d50debf1a95beaad59be2477877327"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a39d50debf1a95beaad59be2477877327">DD4hep::Simulation::Geant4Tracker::Hit::length</a></div><div class="ttdeci">double length</div><div class="ttdoc">Length of the track segment contributing to this hit. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00235">Geant4Data.h:235</a></div></div>
<div class="ttc" id="class_g4_v_sensitive_detector_html"><div class="ttname"><a href="class_g4_v_sensitive_detector.html">G4VSensitiveDetector</a></div><div class="ttdoc">Class of the Geant4 toolkit. See http://www-geant4.kek.jp/Reference. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_classes_8h_source.html#l00048">Geant4Classes.h:48</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit_html_abdd1f621f202ef83c2078a52cbb242b3"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#abdd1f621f202ef83c2078a52cbb242b3">DD4hep::Simulation::Geant4Tracker::Hit::momentum</a></div><div class="ttdeci">Direction momentum</div><div class="ttdoc">Hit direction. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00233">Geant4Data.h:233</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_html_a49d2a794d7824475b7bac71d7342306b"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html#a49d2a794d7824475b7bac71d7342306b">DD4hep::Simulation::Geant4Sensitive::collection</a></div><div class="ttdeci">HitCollection * collection(size_t which)</div><div class="ttdoc">Retrieve the hits collection associated with this detector by its serial number. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_sens_det_action_8cpp_source.html#l00175">Geant4SensDetAction.cpp:175</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a7059ba8b2d85cb67220b0184f038f9f9"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a7059ba8b2d85cb67220b0184f038f9f9">DD4hep::Simulation::TrackerWeighted::combined</a></div><div class="ttdeci">int combined</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00091">Geant4TrackerWeightedSD.cpp:91</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_ac40ec64fd69ed915b95fb79cdc20c741"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#ac40ec64fd69ed915b95fb79cdc20c741">DD4hep::Simulation::Geant4StepHandler::preVolume</a></div><div class="ttdeci">G4VPhysicalVolume * preVolume() const</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00199">Geant4StepHandler.h:199</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a75a27a45aa4197181191c68eb92f9863"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a75a27a45aa4197181191c68eb92f9863">DD4hep::Simulation::TrackerWeighted::thisSD</a></div><div class="ttdeci">G4VSensitiveDetector * thisSD</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00084">Geant4TrackerWeightedSD.cpp:84</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a1205a645db026a115eb182e439929818"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a1205a645db026a115eb182e439929818">DD4hep::Simulation::TrackerWeighted::g4ID</a></div><div class="ttdeci">int g4ID</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00094">Geant4TrackerWeightedSD.cpp:94</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html">DD4hep::Simulation::TrackerWeighted</a></div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00070">Geant4TrackerWeightedSD.cpp:70</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html">DD4hep::Simulation::Geant4StepHandler</a></div><div class="ttdoc">Helper class to ease the extraction of information from a G4Step object. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00047">Geant4StepHandler.h:47</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a82fd5f47ec95d179a132145c54a78873"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a82fd5f47ec95d179a132145c54a78873">DD4hep::Simulation::TrackerWeighted::step_length</a></div><div class="ttdeci">double step_length</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00088">Geant4TrackerWeightedSD.cpp:88</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_a087079e78925eeaedf2e20c394c5c820"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a087079e78925eeaedf2e20c394c5c820">DD4hep::Simulation::Geant4StepHandler::prePosG4</a></div><div class="ttdeci">const G4ThreeVector &amp; prePosG4() const</div><div class="ttdoc">Returns the pre-step position as a G4ThreeVector. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00086">Geant4StepHandler.h:86</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action_html"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html">DD4hep::Simulation::Geant4SensitiveAction</a></div><div class="ttdoc">Template class to ease the construction of sensitive detectors using particle template specialization...</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_sens_det_action_8h_source.html#l00469">Geant4SensDetAction.h:469</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a9ffa7f998b3a1f16864ecbb894ca2e54"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a9ffa7f998b3a1f16864ecbb894ca2e54">DD4hep::Simulation::TrackerWeighted::hit_flag</a></div><div class="ttdeci">int hit_flag</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00093">Geant4TrackerWeightedSD.cpp:93</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a8299b772daa5da7c49399a40c1de172d"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8299b772daa5da7c49399a40c1de172d">DD4hep::Simulation::TrackerWeighted::extractHit</a></div><div class="ttdeci">void extractHit(EInside ended)</div><div class="ttdoc">Extract hit information and add the created hit to the collection. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00167">Geant4TrackerWeightedSD.cpp:167</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit_html_ab786ed42d3c88d911b662e8a083bc54e"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#ab786ed42d3c88d911b662e8a083bc54e">DD4hep::Simulation::Geant4Tracker::Hit::truth</a></div><div class="ttdeci">Contribution truth</div><div class="ttdoc">Monte Carlo / Geant4 information. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00237">Geant4Data.h:237</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_html_a3ad003b720e4d7a1c6e66e0eabb58540"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data.html#a3ad003b720e4d7a1c6e66e0eabb58540">DD4hep::Simulation::Geant4HitData::cellID</a></div><div class="ttdeci">long long int cellID</div><div class="ttdoc">cellID </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00122">Geant4Data.h:122</a></div></div>
<div class="ttc" id="namespace_d_d4hep_1_1_simulation_html_aead01eb580dc503a5abba194d179c963"><div class="ttname"><a href="namespace_d_d4hep_1_1_simulation.html#aead01eb580dc503a5abba194d179c963">DD4hep::Simulation::Momentum</a></div><div class="ttdeci">Position Momentum</div><div class="ttdef"><b>Definition:</b> <a href="_defs_8h_source.html#l00036">Defs.h:36</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_a7b3384fa3ce4d4465a79aa286371b4bb"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a7b3384fa3ce4d4465a79aa286371b4bb">DD4hep::Simulation::Geant4StepHandler::preSD</a></div><div class="ttdeci">G4VSensitiveDetector * preSD() const</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00202">Geant4StepHandler.h:202</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib_html_a34177a48fce1f52d1b58d6ab47e1cacc"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a34177a48fce1f52d1b58d6ab47e1cacc">DD4hep::Simulation::Geant4HitData::MonteCarloContrib::deposit</a></div><div class="ttdeci">double deposit</div><div class="ttdoc">Total energy deposit in this hit. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00147">Geant4Data.h:147</a></div></div>
<div class="ttc" id="namespace_d_d4hep_html"><div class="ttname"><a href="namespace_d_d4hep.html">DD4hep</a></div><div class="ttdoc">Namespace for the AIDA detector description toolkit. </div><div class="ttdef"><b>Definition:</b> <a href="_alignments_8cpp_source.html#l00027">Alignments.cpp:27</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_html"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html">DD4hep::Simulation::Geant4Sensitive</a></div><div class="ttdoc">The base class for Geant4 sensitive detector actions implemented by users. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_sens_det_action_8h_source.html#l00110">Geant4SensDetAction.h:110</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit_html_aafcd9c0b786c16d9db3de2de661c9200"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#aafcd9c0b786c16d9db3de2de661c9200">DD4hep::Simulation::Geant4Tracker::Hit::clear</a></div><div class="ttdeci">Hit &amp; clear()</div><div class="ttdoc">Clear hit content. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8cpp_source.html#l00120">Geant4Data.cpp:120</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a8fcddaa426fa0d7a901991856f3f4d1a"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8fcddaa426fa0d7a901991856f3f4d1a">DD4hep::Simulation::TrackerWeighted::parent</a></div><div class="ttdeci">int parent</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00090">Geant4TrackerWeightedSD.cpp:90</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_a2f746a7669e0ab4e52f39e4fbc2cd742"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a2f746a7669e0ab4e52f39e4fbc2cd742">DD4hep::Simulation::Geant4StepHandler::globalToLocalG4</a></div><div class="ttdeci">G4ThreeVector globalToLocalG4(double x, double y, double z) const</div><div class="ttdoc">Coordinate transformation to local coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8cpp_source.html#l00104">Geant4StepHandler.cpp:104</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a8ffc0941260d20698a82015cd39cf744"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a8ffc0941260d20698a82015cd39cf744">DD4hep::Simulation::TrackerWeighted::update</a></div><div class="ttdeci">TrackerWeighted &amp; update(const G4Step *step)</div><div class="ttdoc">Update energy and track information during hit info accumulation. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00140">Geant4TrackerWeightedSD.cpp:140</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a5120f0b661148efb35b7432c8c58c7ce"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a5120f0b661148efb35b7432c8c58c7ce">DD4hep::Simulation::TrackerWeighted::hit_position_type</a></div><div class="ttdeci">int hit_position_type</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00092">Geant4TrackerWeightedSD.cpp:92</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit_html_a8f2563ce396b2d2f7f6c6534aed3cdb4"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a8f2563ce396b2d2f7f6c6534aed3cdb4">DD4hep::Simulation::Geant4Tracker::Hit::storePoint</a></div><div class="ttdeci">Hit &amp; storePoint(const G4Step *step, const G4StepPoint *point)</div><div class="ttdoc">Store Geant4 point and step information into tracker hit structure. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8cpp_source.html#l00129">Geant4Data.cpp:129</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_html_aec1bfe9ac838d359d9e3948118b5c42d"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html#aec1bfe9ac838d359d9e3948118b5c42d">DD4hep::Simulation::Geant4Sensitive::detector</a></div><div class="ttdeci">Geant4ActionSD &amp; detector() const</div><div class="ttdoc">Access to the sensitive detector object. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_sens_det_action_8cpp_source.html#l00155">Geant4SensDetAction.cpp:155</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit_html_a7f992369c5178cac0cc00ffc8a9c36a0"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_tracker_1_1_hit.html#a7f992369c5178cac0cc00ffc8a9c36a0">DD4hep::Simulation::Geant4Tracker::Hit::position</a></div><div class="ttdeci">Position position</div><div class="ttdoc">Hit position. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00231">Geant4Data.h:231</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_html_a9aa1270e3fb490a4ebe511343903d72f"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html#a9aa1270e3fb490a4ebe511343903d72f">DD4hep::Simulation::Geant4Sensitive::volumeID</a></div><div class="ttdeci">long long int volumeID(const G4Step *step)</div><div class="ttdoc">Returns the volumeID of the sensitive volume corresponding to the step. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_sens_det_action_8cpp_source.html#l00218">Geant4SensDetAction.cpp:218</a></div></div>
<div class="ttc" id="namespacedd4hep_html_a7ca6a7ec6a20ddb5678bd46c47996d26"><div class="ttname"><a href="namespacedd4hep.html#a7ca6a7ec6a20ddb5678bd46c47996d26">dd4hep::um</a></div><div class="ttdeci">static const double um</div><div class="ttdef"><b>Definition:</b> <a href="_d_d4hep_units_8h_source.html#l00067">DD4hepUnits.h:67</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a77ce382a300e188a9ed772615abfa4f2"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a77ce382a300e188a9ed772615abfa4f2">DD4hep::Simulation::TrackerWeighted::distance_to_inside</a></div><div class="ttdeci">double distance_to_inside</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00085">Geant4TrackerWeightedSD.cpp:85</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_html_a1e79173455ccff4d70cd1325b26ad3e9"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html#a1e79173455ccff4d70cd1325b26ad3e9">DD4hep::Simulation::Geant4Sensitive::cellID</a></div><div class="ttdeci">long long int cellID(const G4Step *step)</div><div class="ttdoc">Returns the cellID of the sensitive volume corresponding to the step. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_sens_det_action_8cpp_source.html#l00226">Geant4SensDetAction.cpp:226</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_a8724fb0d717e73716f12a30a851a6b3f"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a8724fb0d717e73716f12a30a851a6b3f">DD4hep::Simulation::Geant4StepHandler::postPosG4</a></div><div class="ttdeci">const G4ThreeVector &amp; postPosG4() const</div><div class="ttdoc">Returns the post-step position as a G4ThreeVector. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00095">Geant4StepHandler.h:95</a></div></div>
<div class="ttc" id="_d_d_g4_2include_2_d_d_g4_2_factories_8h_html"><div class="ttname"><a href="_d_d_g4_2include_2_d_d_g4_2_factories_8h.html">Factories.h</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection_html_aeb5ededae3913d70a3aeecfa8ba0b853"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection.html#aeb5ededae3913d70a3aeecfa8ba0b853">DD4hep::Simulation::Geant4HitCollection::add</a></div><div class="ttdeci">void add(TYPE *hit_pointer)</div><div class="ttdoc">Add a new hit with a check, that the hit is of the same type. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_hit_collection_8h_source.html#l00329">Geant4HitCollection.h:329</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a6c247f2290b5f072a9be93c75dacf631"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a6c247f2290b5f072a9be93c75dacf631">DD4hep::Simulation::TrackerWeighted::sensitive</a></div><div class="ttdeci">Geant4Sensitive * sensitive</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00083">Geant4TrackerWeightedSD.cpp:83</a></div></div>
<div class="ttc" id="_geant4_tracking_action_8h_html"><div class="ttname"><a href="_geant4_tracking_action_8h.html">Geant4TrackingAction.h</a></div></div>
<div class="ttc" id="namespace_d_d4hep_1_1_simulation_html"><div class="ttname"><a href="namespace_d_d4hep_1_1_simulation.html">DD4hep::Simulation</a></div><div class="ttdoc">Namespace for the Geant4 based simulation part of the AIDA detector description toolkit. </div><div class="ttdef"><b>Definition:</b> <a href="_d_d_g4_dict_8h_source.html#l00034">DDG4Dict.h:34</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a15fd630fa0e1ca7e3c0516952ad5f976"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a15fd630fa0e1ca7e3c0516952ad5f976">DD4hep::Simulation::TrackerWeighted::startEvent</a></div><div class="ttdeci">void startEvent()</div><div class="ttdoc">Pre event action callback. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00374">Geant4TrackerWeightedSD.cpp:374</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a222fd48188979006e286b3688452ff6d"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a222fd48188979006e286b3688452ff6d">DD4hep::Simulation::TrackerWeighted::mean_time</a></div><div class="ttdeci">double mean_time</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00087">Geant4TrackerWeightedSD.cpp:87</a></div></div>
<div class="ttc" id="namespace_d_d4hep_1_1_geometry_html_a55083902099d03506c6db01b80404900"><div class="ttname"><a href="namespace_d_d4hep_1_1_geometry.html#a55083902099d03506c6db01b80404900">DD4hep::Geometry::Position</a></div><div class="ttdeci">ROOT::Math::XYZVector Position</div><div class="ttdef"><b>Definition:</b> <a href="_objects_8h_source.html#l00075">Objects.h:75</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_aca48801717dfd735529eb3fda99e999a"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aca48801717dfd735529eb3fda99e999a">DD4hep::Simulation::TrackerWeighted::single_deposit_mode</a></div><div class="ttdeci">bool single_deposit_mode</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00097">Geant4TrackerWeightedSD.cpp:97</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection_html"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection.html">DD4hep::Simulation::Geant4HitCollection</a></div><div class="ttdoc">Generic hit container class using Geant4HitWrapper objects. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_hit_collection_8h_source.html#l00201">Geant4HitCollection.h:201</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_afee73068f429b8f9956acad5580493a9"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#afee73068f429b8f9956acad5580493a9">DD4hep::Simulation::Geant4StepHandler::postVolume</a></div><div class="ttdeci">G4VPhysicalVolume * postVolume() const</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00205">Geant4StepHandler.h:205</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_afc2a6289bb11f08b03d50e0b8e271083"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#afc2a6289bb11f08b03d50e0b8e271083">DD4hep::Simulation::TrackerWeighted::last_inside</a></div><div class="ttdeci">EInside last_inside</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00095">Geant4TrackerWeightedSD.cpp:95</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action_html_a36759982ed0876a5ce81c14973c18077"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html#a36759982ed0876a5ce81c14973c18077">DD4hep::Simulation::Geant4SensitiveAction::process</a></div><div class="ttdeci">virtual bool process(G4Step *step, G4TouchableHistory *history)</div><div class="ttdoc">G4VSensitiveDetector interface: Method for generating hit(s) using the G4Step object. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_sens_det_action_8inl_source.html#l00069">Geant4SensDetAction.inl:69</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_ab378f01fcca56a21b21f3d90c600c984"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ab378f01fcca56a21b21f3d90c600c984">DD4hep::Simulation::TrackerWeighted::mean_pos</a></div><div class="ttdeci">Position mean_pos</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00082">Geant4TrackerWeightedSD.cpp:82</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection_html_adccefc2f8a73f693d2b87b146db87d44"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_collection.html#adccefc2f8a73f693d2b87b146db87d44">DD4hep::Simulation::Geant4HitCollection::GetSize</a></div><div class="ttdeci">virtual size_t GetSize() const</div><div class="ttdoc">Access the collection size. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_hit_collection_8h_source.html#l00317">Geant4HitCollection.h:317</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a404e62198a8830c8e6b7c185873bb4d1"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a404e62198a8830c8e6b7c185873bb4d1">DD4hep::Simulation::TrackerWeighted::e_cut</a></div><div class="ttdeci">double e_cut</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00089">Geant4TrackerWeightedSD.cpp:89</a></div></div>
<div class="ttc" id="_geant4_stepping_action_8h_html"><div class="ttname"><a href="_geant4_stepping_action_8h.html">Geant4SteppingAction.h</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_abb50962377c010e8430400035d5e3dcf"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#abb50962377c010e8430400035d5e3dcf">DD4hep::Simulation::TrackerWeighted::start</a></div><div class="ttdeci">TrackerWeighted &amp; start(const G4Step *step, const G4StepPoint *point)</div><div class="ttdoc">Start a new hit. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00126">Geant4TrackerWeightedSD.cpp:126</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_html_a5dd1e49bfcc1937ad6dc302f969ee544"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive.html#a5dd1e49bfcc1937ad6dc302f969ee544">DD4hep::Simulation::Geant4Sensitive::mark</a></div><div class="ttdeci">void mark(const G4Track *track) const</div><div class="ttdoc">Mark the track to be kept for MC truth propagation during hit processing. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_sens_det_action_8cpp_source.html#l00206">Geant4SensDetAction.cpp:206</a></div></div>
<div class="ttc" id="_multi_view_8cpp_html_a8320ee13ac034dbf6d624fe8953dd337"><div class="ttname"><a href="_multi_view_8cpp.html#a8320ee13ac034dbf6d624fe8953dd337">v</a></div><div class="ttdeci">View * v</div><div class="ttdef"><b>Definition:</b> <a href="_multi_view_8cpp_source.html#l00030">MultiView.cpp:30</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a690b6f7fdcda6bbec2e7cb89f4fce9af"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a690b6f7fdcda6bbec2e7cb89f4fce9af">DD4hep::Simulation::TrackerWeighted::extractHit</a></div><div class="ttdeci">void extractHit(Geant4HitCollection *collection, EInside ended)</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00188">Geant4TrackerWeightedSD.cpp:188</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a0c6304d5c3a6b0964f7388c3440235db"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a0c6304d5c3a6b0964f7388c3440235db">DD4hep::Simulation::TrackerWeighted::clear</a></div><div class="ttdeci">TrackerWeighted &amp; clear()</div><div class="ttdoc">Clear collected information and restart for new hit. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00107">Geant4TrackerWeightedSD.cpp:107</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib_html_a7b755dfa6639f3cc02cd4696719d0580"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a7b755dfa6639f3cc02cd4696719d0580">DD4hep::Simulation::Geant4HitData::MonteCarloContrib::pdgID</a></div><div class="ttdeci">int pdgID</div><div class="ttdoc">Particle ID from the PDG table. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00145">Geant4Data.h:145</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_ae628c5cfae79d839a0640338ba31a6ad"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ae628c5cfae79d839a0640338ba31a6ad">DD4hep::Simulation::TrackerWeighted::TrackerWeighted</a></div><div class="ttdeci">TrackerWeighted()</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00098">Geant4TrackerWeightedSD.cpp:98</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_a3bb8dbd97551f655071ce36e357593ef"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#a3bb8dbd97551f655071ce36e357593ef">DD4hep::Simulation::TrackerWeighted::pre</a></div><div class="ttdeci">Geant4Tracker::Hit pre</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00081">Geant4TrackerWeightedSD.cpp:81</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_adb9d9942e898b61710985c58eda88972"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#adb9d9942e898b61710985c58eda88972">DD4hep::Simulation::Geant4StepHandler::postSD</a></div><div class="ttdeci">G4VSensitiveDetector * postSD() const</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00208">Geant4StepHandler.h:208</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_a37df3c141c8f16fbad4f17bf32a4538b"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a37df3c141c8f16fbad4f17bf32a4538b">DD4hep::Simulation::Geant4StepHandler::trkAlive</a></div><div class="ttdeci">bool trkAlive() const</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00153">Geant4StepHandler.h:153</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_ac7628c08fbf29a1dc2133ac7b30e1499"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ac7628c08fbf29a1dc2133ac7b30e1499">DD4hep::Simulation::TrackerWeighted::calc_dist_out</a></div><div class="ttdeci">TrackerWeighted &amp; calc_dist_out(const G4VSolid *solid)</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00172">Geant4TrackerWeightedSD.cpp:172</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_aecd97f73f71f722a320badfe3272e374"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aecd97f73f71f722a320badfe3272e374">DD4hep::Simulation::TrackerWeighted::mustSaveTrack</a></div><div class="ttdeci">bool mustSaveTrack(const G4Track *tr) const</div><div class="ttdoc">Helper function to decide if the hit has to be extracted and saved in the collection. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00162">Geant4TrackerWeightedSD.cpp:162</a></div></div>
<div class="ttc" id="_geant4_event_action_8h_html"><div class="ttname"><a href="_geant4_event_action_8h.html">Geant4EventAction.h</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_html_adaf354d937bc941aac70b2327aa1d1f3"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data.html#adaf354d937bc941aac70b2327aa1d1f3">DD4hep::Simulation::Geant4HitData::g4ID</a></div><div class="ttdeci">long g4ID</div><div class="ttdoc">Original Geant 4 track identifier of the creating track (debugging) </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00126">Geant4Data.h:126</a></div></div>
<div class="ttc" id="namespacedd4hep_html_a124f4e9c11400c971e1a829ba8d4a3d0"><div class="ttname"><a href="namespacedd4hep.html#a124f4e9c11400c971e1a829ba8d4a3d0">dd4hep::mm</a></div><div class="ttdeci">static const double mm</div><div class="ttdef"><b>Definition:</b> <a href="_d_d4hep_units_8h_source.html#l00069">DD4hepUnits.h:69</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib_html_a80a8546851d931b3b39e690a3bc1b3d8"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a80a8546851d931b3b39e690a3bc1b3d8">DD4hep::Simulation::Geant4HitData::MonteCarloContrib::trackID</a></div><div class="ttdeci">int trackID</div><div class="ttdoc">Geant 4 Track identifier. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00143">Geant4Data.h:143</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_html_aee4dddb74fa4230f4a450f5eb96416af"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data.html#aee4dddb74fa4230f4a450f5eb96416af">DD4hep::Simulation::Geant4HitData::flag</a></div><div class="ttdeci">long flag</div><div class="ttdoc">User flag to classify hits. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00124">Geant4Data.h:124</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib_html_a2d1cbbdb9da1af65acb58ef97fe10277"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_hit_data_1_1_monte_carlo_contrib.html#a2d1cbbdb9da1af65acb58ef97fe10277">DD4hep::Simulation::Geant4HitData::MonteCarloContrib::time</a></div><div class="ttdeci">double time</div><div class="ttdoc">Timestamp when this energy was deposited. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_data_8h_source.html#l00149">Geant4Data.h:149</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action_html_a52a9e46a54f3e1605637dc281a878b0d"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_sensitive_action.html#a52a9e46a54f3e1605637dc281a878b0d">DD4hep::Simulation::Geant4SensitiveAction::clear</a></div><div class="ttdeci">virtual void clear(G4HCofThisEvent *hce)</div><div class="ttdoc">G4VSensitiveDetector interface: Method invoked if the event was aborted. </div><div class="ttdef"><b>Definition:</b> <a href="_geant4_sens_det_action_8inl_source.html#l00074">Geant4SensDetAction.inl:74</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_aeced4bab28aa79ad7bab14ca9ce02c79"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aeced4bab28aa79ad7bab14ca9ce02c79">DD4hep::Simulation::TrackerWeighted::cell</a></div><div class="ttdeci">long long int cell</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00096">Geant4TrackerWeightedSD.cpp:96</a></div></div>
<div class="ttc" id="namespace_d_d4hep_1_1_simulation_html_a63833833f53787d1116da0c3bb635dc8"><div class="ttname"><a href="namespace_d_d4hep_1_1_simulation.html#a63833833f53787d1116da0c3bb635dc8">DD4hep::Simulation::Geant4TrackerWeightedAction</a></div><div class="ttdeci">Geant4SensitiveAction&lt; TrackerWeighted &gt; Geant4TrackerWeightedAction</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00413">Geant4TrackerWeightedSD.cpp:413</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_ad898a4f6ed0a4424a2bd8f7d52292c32"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#ad898a4f6ed0a4424a2bd8f7d52292c32">DD4hep::Simulation::TrackerWeighted::distance_to_outside</a></div><div class="ttdeci">double distance_to_outside</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00086">Geant4TrackerWeightedSD.cpp:86</a></div></div>
<div class="ttc" id="_d_d4hep_units_8h_html"><div class="ttname"><a href="_d_d4hep_units_8h.html">DD4hepUnits.h</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler_html_a7c18f2d6e46ecbb380fbe0995029accb"><div class="ttname"><a href="class_d_d4hep_1_1_simulation_1_1_geant4_step_handler.html#a7c18f2d6e46ecbb380fbe0995029accb">DD4hep::Simulation::Geant4StepHandler::pre</a></div><div class="ttdeci">G4StepPoint * pre</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_step_handler_8h_source.html#l00050">Geant4StepHandler.h:50</a></div></div>
<div class="ttc" id="_d_d_g4_2include_2_d_d_g4_2_factories_8h_html_a4b45b064ac34cecb1cf0a31c2edc346a"><div class="ttname"><a href="_d_d_g4_2include_2_d_d_g4_2_factories_8h.html#a4b45b064ac34cecb1cf0a31c2edc346a">DECLARE_GEANT4SENSITIVE</a></div><div class="ttdeci">#define DECLARE_GEANT4SENSITIVE(name)</div><div class="ttdef"><b>Definition:</b> <a href="_d_d_g4_2include_2_d_d_g4_2_factories_8h_source.html#l00160">Factories.h:160</a></div></div>
<div class="ttc" id="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted_html_aa9139da9ecb7c109b7108cc27a27c13d"><div class="ttname"><a href="struct_d_d4hep_1_1_simulation_1_1_tracker_weighted.html#aa9139da9ecb7c109b7108cc27a27c13d">DD4hep::Simulation::TrackerWeighted::calc_dist_in</a></div><div class="ttdeci">TrackerWeighted &amp; calc_dist_in(const G4VSolid *solid)</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_tracker_weighted_s_d_8cpp_source.html#l00180">Geant4TrackerWeightedSD.cpp:180</a></div></div>
<div class="ttc" id="namespace_geant4_tracker_weighted_action_html"><div class="ttname"><a href="namespace_geant4_tracker_weighted_action.html">Geant4TrackerWeightedAction</a></div><div class="ttdoc">Sensitive detector meant for tracking detectors with multiple ways to combine steps. </div></div>
</div><!-- fragment --></div><!-- contents -->

<hr class="footer"/><address class="footer"><small>
Generated on Mon Nov 14 2016 16:16:55 for DD4hep by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
