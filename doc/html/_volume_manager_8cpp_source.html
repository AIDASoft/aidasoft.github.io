<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>DD4hep: /afs/cern.ch/user/m/mpetric/nightly_cppcheck/dd4hep/DDCore/src/VolumeManager.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="DD4hep.css" rel="stylesheet" type="text/css" />
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 100px;">
  <td id="projectlogo"><img alt="Logo" src="../doc/LaTex/CERN-logo.png" height="72"/></td>
  <td id="projectlogo"><img alt="Logo" src="DD4hep-AIDA-logo.png" height="72"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectbrief">DD4hep - The AIDA detector description toolkit for high energy physics experiments</div>
   <div id="projectname">DD4hep
   &#160;<span id="projectnumber">Rev:exported</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_59ea4de7df9c433be16cad39d60a08e6.html">DDCore</a></li><li class="navelem"><a class="el" href="dir_fe1382c8e394c32df9b42bf3dfbdb2f9.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">VolumeManager.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_volume_manager_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// $Id:$</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//==========================================================================</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//  AIDA Detector description implementation for LCD</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Copyright (C) Organisation europeenne pour la Recherche nucleaire (CERN)</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// All rights reserved.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// For the licensing terms see $DD4hepINSTALL/LICENSE.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// For the list of contributors see $DD4hepINSTALL/doc/CREDITS.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// Author     : M.Frank</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//==========================================================================</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// Framework include files</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_l_c_d_d_8h.html">DD4hep/LCDD.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_printout_8h.html">DD4hep/Printout.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_detector_interna_8h.html">DD4hep/objects/DetectorInterna.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_volume_manager_interna_8h.html">DD4hep/objects/VolumeManagerInterna.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// C/C++ includes</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespace_d_d4hep.html">DD4hep</a>;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespace_d_d4hep_1_1_geometry.html">DD4hep::Geometry</a>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keyword">struct </span>Populator {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds.html">PlacedVolume::VolIDs</a> VolIDs;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">typedef</span> vector&lt;TGeoNode*&gt; Chain;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">typedef</span> pair&lt;VolumeID, VolumeID&gt; Encoding;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html">LCDD</a>&amp; m_lcdd;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a> m_volManager;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    set&lt;VolumeID&gt; m_entries;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    Populator(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html">LCDD</a>&amp; lcdd, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a> vm)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      : m_lcdd(lcdd), m_volManager(vm) {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">void</span> populate(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> <a class="code" href="_volumes_8cpp.html#a8a9a1f93e9b09afccaec215310e64142">e</a>) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="comment">//const char* typ = 0;//::getenv(&quot;VOLMGR_NEW&quot;);</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#afc41f63ac2a467f5077d1cca1292d580">DetElement::Children</a>&amp; c = e.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#ab32f6441336990dc9a44cb4420b01644">children</a>();</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html">SensitiveDetector</a> parent_sd;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">if</span> ( e-&gt;flag&amp;DetElement::Object::HAVE_SENSITIVE_DETECTOR )  {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        parent_sd = m_lcdd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#af476b8241b93e82350ec1e5cbf145941">sensitiveDetector</a>(e.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>());</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="comment">//printout(INFO, &quot;VolumeManager&quot;, &quot;++ Executing %s plugin manager version&quot;,typ ? &quot;***NEW***&quot; : &quot;***OLD***&quot;);</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">for</span> (DetElement::Children::const_iterator i = c.begin(); i != c.end(); ++i) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> de = (*i).second;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> pv = de.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a3afa8e83d1f71cfb13df316193218769">placement</a>();</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">if</span> (pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>()) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;          Chain chain;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html">SensitiveDetector</a> sd = parent_sd;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          m_entries.<a class="code" href="class_d_d4hep_1_1_handle.html#ad50d0ea67a1c9a4e87d232f96ebe52f1">clear</a>();</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;          <span class="keywordflow">if</span> ( typ )  {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            Encoding coding(0, 0);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            scanPhysicalVolume(de, de, pv, coding, sd, chain);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;          }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          VolIDs ids;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          scanPhysicalVolume(de, de, pv, ids, sd, chain);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          Encoding coding(0, 0);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;          scanPhysicalVolume(de, de, pv, coding, sd, chain);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        }</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42ac24ff9a0f663cd47b4e4e37a977dff02">WARNING</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>, <span class="stringliteral">&quot;++ Detector element %s of type %s has no placement.&quot;</span>, </div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                 de.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>(), de.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a47782470bbe890c880a2824de6d1b547">type</a>().c_str());</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> findElt(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> e, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> pv) {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#afc41f63ac2a467f5077d1cca1292d580">DetElement::Children</a>&amp; c = e.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#ab32f6441336990dc9a44cb4420b01644">children</a>();</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">if</span> (e.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a3afa8e83d1f71cfb13df316193218769">placement</a>().<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>() == pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>())</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">return</span> e;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">for</span> (DetElement::Children::const_iterator i = c.begin(); i != c.end(); ++i) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> de = (*i).second;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">if</span> (de.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a3afa8e83d1f71cfb13df316193218769">placement</a>().<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>() == pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>())</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          <span class="keywordflow">return</span> de;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">for</span> (DetElement::Children::const_iterator i = c.begin(); i != c.end(); ++i) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> de = findElt((*i).second, pv);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">if</span> (de.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>())</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          <span class="keywordflow">return</span> de;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespace_d_d4hep.html#a21dd977310ff183f61ca6ae14b59a989">DetElement</a>();</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">size_t</span> scanPhysicalVolume(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a>&amp; parent, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> e, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> pv, </div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                              Encoding parent_encoding,</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                              <a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html">SensitiveDetector</a>&amp; sd, Chain&amp; chain)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      TGeoNode* node = pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>();</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordtype">size_t</span> count = 0;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">if</span> (node) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html">Volume</a> vol = pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a13113feba33041cee2738730ab70a9fc">volume</a>();</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keyword">const</span> VolIDs&amp; pv_ids   = pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a302037d5e140c5b832ba8057466d8214">volIDs</a>();</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        Encoding vol_encoding  = parent_encoding;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordtype">bool</span>     is_sensitive  = vol.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aa324bff4bb7c4e5a4575f81819d78d48">isSensitive</a>();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordtype">bool</span>     have_encoding = pv_ids.empty();</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordtype">bool</span>     compound      = e.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a47782470bbe890c880a2824de6d1b547">type</a>() == <span class="stringliteral">&quot;compound&quot;</span>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">if</span> ( compound )  {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          sd = <a class="code" href="namespace_d_d4hep.html#ae77e9f3818be8d649b030c537e235efe">SensitiveDetector</a>(0);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          vol_encoding = Encoding();</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() )  {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          <span class="keywordflow">if</span> ( is_sensitive )</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            sd = vol.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a094839ee3155de449a36ca927ec17d2d">sensitiveDetector</a>();</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (parent-&gt;flag&amp;DetElement::Object::HAVE_SENSITIVE_DETECTOR) )</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            sd = m_lcdd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#af476b8241b93e82350ec1e5cbf145941">sensitiveDetector</a>(parent.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>());</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (e-&gt;flag&amp;DetElement::Object::HAVE_SENSITIVE_DETECTOR) )</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            sd = m_lcdd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#af476b8241b93e82350ec1e5cbf145941">sensitiveDetector</a>(e.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>());</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        chain.push_back(node);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> ( sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() &amp;&amp; !pv_ids.empty() )   {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html">Readout</a> ro = sd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html#ad79f39c5b360f7ecf2341de990131eb2">readout</a>();</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          <span class="keywordflow">if</span> ( ro.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() )   {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            vol_encoding = update_encoding(ro.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html#a3930f675f87469d26910268c3b7066ca">idSpec</a>(), pv_ids, parent_encoding);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            have_encoding = <span class="keyword">true</span>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <span class="keywordflow">else</span> {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42ac24ff9a0f663cd47b4e4e37a977dff02">WARNING</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>,</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                     <span class="stringliteral">&quot;%s: Strange constellation volume %s is sensitive, but has no readout! sd:%p&quot;</span>,</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                     parent.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>(), pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a13113feba33041cee2738730ab70a9fc">volume</a>().<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>(), sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>());</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">for</span> (Int_t idau = 0, ndau = node-&gt;GetNdaughters(); idau &lt; ndau; ++idau) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          TGeoNode* daughter = node-&gt;GetDaughter(idau);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> placement(daughter);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <span class="keywordflow">if</span> ( placement.data() ) {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> pv_dau(daughter);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a>   de_dau = findElt(e, daughter);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">if</span> ( de_dau.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() ) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;              Chain dau_chain;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;              count += scanPhysicalVolume(parent, de_dau, pv_dau, vol_encoding, sd, dau_chain);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;              count += scanPhysicalVolume(parent, e, pv_dau, vol_encoding, sd, chain);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="keywordflow">else</span>  {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <a class="code" href="namespace_d_d4hep.html#af8602b0b80e0c252cf28e5fbbc81abcc">except</a>(<span class="stringliteral">&quot;VolumeManager&quot;</span>,</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                   <span class="stringliteral">&quot;Invalid not instrumented placement:&quot;</span>+<span class="keywordtype">string</span>(daughter-&gt;GetName())+</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                   <span class="stringliteral">&quot; [Internal error -- bad detector constructor]&quot;</span>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <span class="keywordflow">if</span> ( compound )  {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            sd = <a class="code" href="namespace_d_d4hep.html#ae77e9f3818be8d649b030c537e235efe">SensitiveDetector</a>(0);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span> ( e.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a5f8b4268684a3cd4a5f613181a8bac83">path</a>().find(<span class="stringliteral">&quot;/world/EcalBarrel&quot;</span>) == 0 )  {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="_geant4_sensitive_detector_8cpp.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">if</span> ( sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() )   {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <span class="keywordflow">if</span> ( !have_encoding )   {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42a54d5c1b9254fdf017c456cb972d26f96">ERROR</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>,<span class="stringliteral">&quot;%s: Missing SD encoding. Volume manager won&#39;t work!&quot;</span>,</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                     e.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a5f8b4268684a3cd4a5f613181a8bac83">path</a>().c_str());</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          <span class="keywordtype">bool</span> add_det_vol_id = (is_sensitive || count &gt; 0) &amp;&amp; node == e.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a3afa8e83d1f71cfb13df316193218769">placement</a>().<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>();</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <span class="keywordflow">if</span> ( add_det_vol_id )   {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="comment">// 1) We recuperate volumes from lower levels by reusing the subdetector</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="comment">//    This only works if there is exactly one sensitive detector per subdetector!</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="comment">// 2) DetElements in the upper hierarchy of the sensitive also get al volume id,</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="comment">//    and the volume is registered. (to be discussed)</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="comment">// I hate this, but I could not talk Frank out of this!  M.F.</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42a2c12bf245b6095423f62644ab1f5eedf">VERBOSE</a>,<span class="stringliteral">&quot;VolumeManager&quot;</span>,<span class="stringliteral">&quot;++++ %-11s  SD:%s VolID=%p Mask=%p&quot;</span>,e.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a5f8b4268684a3cd4a5f613181a8bac83">path</a>().c_str(),</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                     have_encoding ? <span class="stringliteral">&quot;RECUPERATED&quot;</span> : <span class="stringliteral">&quot;REGULAR&quot;</span>, sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>(),</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                     (<span class="keywordtype">void</span>*)vol_encoding.first, (<span class="keywordtype">void</span>*)vol_encoding.second);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            e.<a class="code" href="class_d_d4hep_1_1_handle.html#abef3218a7399500084fc290a711bf048">object</a>&lt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element_object.html">DetElement::Object</a>&gt;().volumeID = vol_encoding.first;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          <span class="keywordflow">if</span> ( is_sensitive || add_det_vol_id )  {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            add_entry(sd, parent, e, node, vol_encoding, chain);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            ++count;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        chain.pop_back();</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">return</span> count;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">size_t</span> scanPhysicalVolume(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a>&amp; parent, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> e, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> pv, </div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                              VolIDs ids, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html">SensitiveDetector</a>&amp; sd, Chain&amp; chain)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      TGeoNode* node = pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>();</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordtype">size_t</span> count = 0;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">if</span> (node) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html">Volume</a> vol = pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a13113feba33041cee2738730ab70a9fc">volume</a>();</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        chain.push_back(node);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        VolIDs pv_ids = pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a302037d5e140c5b832ba8057466d8214">volIDs</a>();</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        ids.VolIDs::Base::insert(ids.end(), pv_ids.begin(), pv_ids.end());</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordtype">bool</span> got_readout = <span class="keyword">false</span>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span> ( vol.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aa324bff4bb7c4e5a4575f81819d78d48">isSensitive</a>() )  {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          sd = vol.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a094839ee3155de449a36ca927ec17d2d">sensitiveDetector</a>();</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html">Readout</a> ro = sd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html#ad79f39c5b360f7ecf2341de990131eb2">readout</a>();</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          <span class="keywordflow">if</span> ( sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() &amp;&amp; ro.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() )   {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            got_readout = <span class="keyword">true</span>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            add_entry(sd, parent, e, node, ids, chain);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            ++count;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          <span class="keywordflow">else</span> {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42ac24ff9a0f663cd47b4e4e37a977dff02">WARNING</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                     <span class="stringliteral">&quot;%s: Strange constellation volume %s is sensitive, but has no readout! sd:%p&quot;</span>,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                     parent.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>(), pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a13113feba33041cee2738730ab70a9fc">volume</a>().<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>(), sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>());</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">for</span> (Int_t idau = 0, ndau = node-&gt;GetNdaughters(); idau &lt; ndau; ++idau) {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          TGeoNode* daughter = node-&gt;GetDaughter(idau);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> placement(daughter);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          <span class="keywordflow">if</span> ( placement.data() ) {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordtype">size_t</span> cnt;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> pv_dau = <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga40af83be6718bb8828a3d83dc7f8c930">Ref_t</a>(daughter);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> de_dau = findElt(e, daughter);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">if</span> ( de_dau.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() ) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;              Chain dau_chain;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;              cnt = scanPhysicalVolume(parent, de_dau, pv_dau, ids, sd, dau_chain);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;              cnt = scanPhysicalVolume(parent, e, pv_dau, ids, sd, chain);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="comment">// There was a sensitive daughter volume, also add the parent entry.</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">if</span> ( count == 0 &amp;&amp; cnt &gt; 0 &amp;&amp; sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() &amp;&amp; !pv_ids.empty()) {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;              add_entry(sd, parent, e, node, ids, chain);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            count += cnt;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          <span class="keywordflow">else</span>  {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Invalid not instrumented placement:&quot;</span>+<span class="keywordtype">string</span>(daughter-&gt;GetName())+</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                <span class="stringliteral">&quot; [Internal error -- bad detector constructor]&quot;</span>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> ( count == 0 )   { </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          sd = <a class="code" href="namespace_d_d4hep.html#ae77e9f3818be8d649b030c537e235efe">SensitiveDetector</a>(0);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( count &gt; 0 &amp;&amp; sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() )   {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          <span class="comment">// We recuperate volumes from lower levels by reusing the subdetector</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          <span class="comment">// This only works if there is exactly one sensitive detector per subdetector!</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          <span class="comment">// I hate this, but I could not talk Frank out of this!  M.F.</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html">Readout</a> ro = sd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html#ad79f39c5b360f7ecf2341de990131eb2">readout</a>();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          <span class="keywordflow">if</span> ( ro.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() ) {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <a class="code" href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html">IDDescriptor</a> iddesc = ro.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html#a3930f675f87469d26910268c3b7066ca">idSpec</a>();</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            Encoding det_encoding = encoding(iddesc,ids);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42a2c12bf245b6095423f62644ab1f5eedf">VERBOSE</a>,<span class="stringliteral">&quot;VolumeManager&quot;</span>,<span class="stringliteral">&quot;++++ %-11s  SD:%s VolID=%p Mask=%p&quot;</span>,e.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a5f8b4268684a3cd4a5f613181a8bac83">path</a>().c_str(),</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                     got_readout ? <span class="stringliteral">&quot;RECUPERATED&quot;</span> : <span class="stringliteral">&quot;REGULAR&quot;</span>, sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>(),</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                     (<span class="keywordtype">void</span>*)det_encoding.first, (<span class="keywordtype">void</span>*)det_encoding.second);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            e.<a class="code" href="class_d_d4hep_1_1_handle.html#abef3218a7399500084fc290a711bf048">object</a>&lt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element_object.html">DetElement::Object</a>&gt;().volumeID = det_encoding.first;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        chain.pop_back();</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">return</span> count;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">static</span> Encoding update_encoding(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html">IDDescriptor</a> iddesc, <span class="keyword">const</span> VolIDs&amp; ids, <span class="keyword">const</span> Encoding&amp; initial)  {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <a class="code" href="namespace_d_d4hep_1_1_d_d_segmentation.html#a61a6833a18d1800bdef176595f83e3ba">VolumeID</a> volume_id = initial.first, mask = initial.second;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">for</span> (VolIDs::const_iterator i = ids.begin(); i != ids.end(); ++i) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#aaecde4f8feb863af7cd36c1213bfabe4">PlacedVolume::VolID</a>&amp; <span class="keywordtype">id</span> = (*i);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html">IDDescriptor::Field</a> f = iddesc.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html#a9179d503a536eab536eef71b20904116">field</a>(<span class="keywordtype">id</span>.first);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="namespace_d_d4hep_1_1_d_d_segmentation.html#a61a6833a18d1800bdef176595f83e3ba">VolumeID</a> msk = f-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a537266df448c372b64ea6c4f1185a4c5">mask</a>();</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordtype">int</span> offset   = f-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#ab8aa1a30c457ac06641276a2e10e647d">offset</a>();</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        volume_id   |= ((f-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a46fee9b58df6cfc614afdbf6e82e7e80">value</a>(<span class="keywordtype">id</span>.<a class="code" href="namespacedd4hep.html#ac03364576705a245265d8ed6ea26b871">second</a> &lt;&lt; offset) &lt;&lt; offset)&amp;msk);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        mask        |= msk;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordflow">return</span> make_pair(volume_id, mask);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keyword">static</span> Encoding encoding(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html">IDDescriptor</a> iddesc, <span class="keyword">const</span> VolIDs&amp; ids)  {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <a class="code" href="namespace_d_d4hep_1_1_d_d_segmentation.html#a61a6833a18d1800bdef176595f83e3ba">VolumeID</a> volume_id = 0, mask = 0;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">for</span> (VolIDs::const_iterator i = ids.begin(); i != ids.end(); ++i) {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#aaecde4f8feb863af7cd36c1213bfabe4">PlacedVolume::VolID</a>&amp; <span class="keywordtype">id</span> = (*i);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html">IDDescriptor::Field</a> f = iddesc.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html#a9179d503a536eab536eef71b20904116">field</a>(<span class="keywordtype">id</span>.first);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="namespace_d_d4hep_1_1_d_d_segmentation.html#a61a6833a18d1800bdef176595f83e3ba">VolumeID</a> msk = f-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a537266df448c372b64ea6c4f1185a4c5">mask</a>();</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordtype">int</span>      off = f-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#ab8aa1a30c457ac06641276a2e10e647d">offset</a>();</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        volume_id |= ((f-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a46fee9b58df6cfc614afdbf6e82e7e80">value</a>(<span class="keywordtype">id</span>.<a class="code" href="namespacedd4hep.html#ac03364576705a245265d8ed6ea26b871">second</a>&lt;&lt;off)&lt;&lt;off)&amp;msk);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        mask      |= msk;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">return</span> make_pair(volume_id, mask);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">void</span> add_entry(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html">SensitiveDetector</a> sd, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> parent, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> e, </div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                   <span class="keyword">const</span> TGeoNode* n, <span class="keyword">const</span> Encoding&amp; code, Chain&amp; nodes) </div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">if</span> ( sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() )   {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">if</span> (m_entries.find(code.first) == m_entries.end()) {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html">Readout</a>       ro           = sd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html#ad79f39c5b360f7ecf2341de990131eb2">readout</a>();</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          <span class="keywordtype">string</span>        sd_name      = sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>();</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a>    sub_detector = m_lcdd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#a0ed0c4e5d72a1e07ce11cf2592d6de3e">detector</a>(sd_name);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a> section      = m_volManager.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#a6a9318986cf6574d07eaa86ea4da5085">addSubdetector</a>(sub_detector, ro);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          <span class="comment">// This is the block, we effectively have to save for each physical volume with a VolID</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">VolumeManager::Context</a>* context = <span class="keyword">new</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">VolumeManager::Context</a>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a> = code.first;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a052bc7df447cef84eabe15a5751e772b">mask</a>       = code.second;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a4b637a36900149ff3490731f62ca1d52">detector</a>   = parent;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#aa6c87ac47a16aa5094ca87d5991ab91f">placement</a>  = <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a>(n);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a57c697291054cc0fa221f047dd32938f">element</a>    = <a class="code" href="_volumes_8cpp.html#a8a9a1f93e9b09afccaec215310e64142">e</a>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;          <span class="comment">//context-&gt;volID      = ids;</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#aa29bc3744ae4aff1e6a504c2b758a37c">path</a>       = nodes;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = nodes.size(); i &gt; 1; --i) {   <span class="comment">// Omit the placement of the parent DetElement</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            TGeoMatrix* <a class="code" href="_volumes_8cpp.html#a6fc379aaec47ce424b00d8ffda2a6c59">m</a> = nodes[i - 1]-&gt;GetMatrix();</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a724f7f6ffc6fc9e91dca0f07d5f14d1d">toWorld</a>.MultiplyLeft(m);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a0978a0bffd0e0669f14d0ddea43ea6bb">toDetector</a> = context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a724f7f6ffc6fc9e91dca0f07d5f14d1d">toWorld</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a0978a0bffd0e0669f14d0ddea43ea6bb">toDetector</a>.MultiplyLeft(nodes[0]-&gt;GetMatrix());</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a724f7f6ffc6fc9e91dca0f07d5f14d1d">toWorld</a>.MultiplyLeft(&amp;parent.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#acaf0a39faf4eeab43c30158c9a7169ec">worldTransformation</a>());</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          <span class="keywordflow">if</span> (!section.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#acfeddaf04beb69692702c453a9ad9933">adoptPlacement</a>(context)) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            print_node(sd, parent, e, n, code, nodes);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          m_entries.insert(code.first);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordtype">void</span> add_entry(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html">SensitiveDetector</a> sd, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> parent, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> e, </div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                   <span class="keyword">const</span> TGeoNode* n, <span class="keyword">const</span> VolIDs&amp; ids, Chain&amp; nodes) </div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">if</span> ( sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() )   {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html">Readout</a> ro = sd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html#ad79f39c5b360f7ecf2341de990131eb2">readout</a>();</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html">IDDescriptor</a> iddesc = ro.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html#a3930f675f87469d26910268c3b7066ca">idSpec</a>();</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        Encoding code = encoding(iddesc, ids);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">if</span> (m_entries.find(code.first) == m_entries.end()) {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;          <span class="keywordtype">string</span>        sd_name      = sd.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>();</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a>    sub_detector = m_lcdd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#a0ed0c4e5d72a1e07ce11cf2592d6de3e">detector</a>(sd_name);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a> section      = m_volManager.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#a6a9318986cf6574d07eaa86ea4da5085">addSubdetector</a>(sub_detector, ro);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;          <span class="comment">// This is the block, we effectively have to save for each physical volume with a VolID</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">VolumeManager::Context</a>* context = <span class="keyword">new</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">VolumeManager::Context</a>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a> = code.first;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a052bc7df447cef84eabe15a5751e772b">mask</a>       = code.second;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a4b637a36900149ff3490731f62ca1d52">detector</a>   = parent;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#aa6c87ac47a16aa5094ca87d5991ab91f">placement</a>  = <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a>(n);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a57c697291054cc0fa221f047dd32938f">element</a>    = <a class="code" href="_volumes_8cpp.html#a8a9a1f93e9b09afccaec215310e64142">e</a>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a3982d4e94fc483caa54382e719eb568c">volID</a>      = ids;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#aa29bc3744ae4aff1e6a504c2b758a37c">path</a>       = nodes;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = nodes.size(); i &gt; 1; --i) {   <span class="comment">// Omit the placement of the parent DetElement</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            TGeoMatrix* m = nodes[i - 1]-&gt;GetMatrix();</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a724f7f6ffc6fc9e91dca0f07d5f14d1d">toWorld</a>.MultiplyLeft(m);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a0978a0bffd0e0669f14d0ddea43ea6bb">toDetector</a> = context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a724f7f6ffc6fc9e91dca0f07d5f14d1d">toWorld</a>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a0978a0bffd0e0669f14d0ddea43ea6bb">toDetector</a>.MultiplyLeft(nodes[0]-&gt;GetMatrix());</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a724f7f6ffc6fc9e91dca0f07d5f14d1d">toWorld</a>.MultiplyLeft(&amp;parent.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#acaf0a39faf4eeab43c30158c9a7169ec">worldTransformation</a>());</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          <span class="keywordflow">if</span> (!section.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#acfeddaf04beb69692702c453a9ad9933">adoptPlacement</a>(context)) {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            print_node(sd, parent, e, n, ids, nodes);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;          }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          m_entries.insert(code.first);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">void</span> print_node(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html">SensitiveDetector</a> sd, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> parent, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> e,</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    <span class="keyword">const</span> TGeoNode* n, <span class="keyword">const</span> VolIDs&amp; ids, <span class="keyword">const</span> Chain&amp; <span class="comment">/* nodes */</span>)<span class="keyword"> const</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">int</span> s_count = 0;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html">Readout</a> ro = sd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html#ad79f39c5b360f7ecf2341de990131eb2">readout</a>();</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html">IDDescriptor</a>&amp; en = ro.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html#a3930f675f87469d26910268c3b7066ca">idSpec</a>();</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> pv = <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga40af83be6718bb8828a3d83dc7f8c930">Ref_t</a>(n);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordtype">bool</span> sensitive = pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a13113feba33041cee2738730ab70a9fc">volume</a>().<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aa324bff4bb7c4e5a4575f81819d78d48">isSensitive</a>();</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      Encoding code = encoding(en, ids);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="namespace_d_d4hep_1_1_d_d_segmentation.html#a61a6833a18d1800bdef176595f83e3ba">VolumeID</a> volume_id = code.first;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">//if ( !sensitive ) return;</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      ++s_count;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      stringstream log;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      log &lt;&lt; s_count &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; parent.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; e.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>() </div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; ro:&quot;</span> &lt;&lt; ro.<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>() &lt;&lt; <span class="stringliteral">&quot; pv:&quot;</span> &lt;&lt; n-&gt;GetName() &lt;&lt; <span class="stringliteral">&quot; id:&quot;</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          &lt;&lt; (<span class="keywordtype">void</span>*) volume_id &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">for</span> (VolIDs::const_iterator i = ids.begin(); i != ids.end(); ++i) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#aaecde4f8feb863af7cd36c1213bfabe4">PlacedVolume::VolID</a>&amp; <span class="keywordtype">id</span> = (*i);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html">IDDescriptor::Field</a> f = ro.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html#a3930f675f87469d26910268c3b7066ca">idSpec</a>().<a class="code" href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html#a9179d503a536eab536eef71b20904116">field</a>(<span class="keywordtype">id</span>.first);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <a class="code" href="namespace_d_d4hep_1_1_d_d_segmentation.html#a61a6833a18d1800bdef176595f83e3ba">VolumeID</a> value = f-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a46fee9b58df6cfc614afdbf6e82e7e80">value</a>(volume_id);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        log &lt;&lt; <span class="keywordtype">id</span>.first &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; <span class="keywordtype">id</span>.second &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; value </div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; [&quot;</span> &lt;&lt; f-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#ab8aa1a30c457ac06641276a2e10e647d">offset</a>() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; f-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a2a64900a949635b4d1bbefe5a61529c3">width</a>() &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      log &lt;&lt; <span class="stringliteral">&quot; Sensitive:&quot;</span> &lt;&lt; <a class="code" href="namespace_d_d4hep.html#a9b6e2c5ab00340e93017e18604b0cb85">yes_no</a>(sensitive);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="_geant4_sensitive_detector_8cpp.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>, log.str().c_str());</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      log.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      log &lt;&lt; s_count &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; e.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>() &lt;&lt; <span class="stringliteral">&quot; Detector GeoNodes:&quot;</span>;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">for</span>(vector&lt;const TGeoNode*&gt;::const_iterator j=nodes.begin(); j!=nodes.end();++j)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        log &lt;&lt; (<span class="keywordtype">void</span>*)(*j) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="_geant4_sensitive_detector_8cpp.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>,<span class="stringliteral">&quot;VolumeManager&quot;</span>,log.str().c_str());</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordtype">void</span> print_node(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html">SensitiveDetector</a> sd, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> parent, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> e,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                    <span class="keyword">const</span> TGeoNode* n, <span class="keyword">const</span> Encoding&amp; code, <span class="keyword">const</span> Chain&amp; <span class="comment">/* nodes */</span>)<span class="keyword"> const</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">int</span> s_count = 0;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html">Readout</a> ro = sd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html#ad79f39c5b360f7ecf2341de990131eb2">readout</a>();</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> pv = <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga40af83be6718bb8828a3d83dc7f8c930">Ref_t</a>(n);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordtype">bool</span> sensitive = pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a13113feba33041cee2738730ab70a9fc">volume</a>().<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aa324bff4bb7c4e5a4575f81819d78d48">isSensitive</a>();</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <a class="code" href="namespace_d_d4hep_1_1_d_d_segmentation.html#a61a6833a18d1800bdef176595f83e3ba">VolumeID</a> volume_id = code.first;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="comment">//if ( !sensitive ) return;</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      ++s_count;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      stringstream log;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      log &lt;&lt; s_count &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; parent.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; e.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>() </div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; ro:&quot;</span> &lt;&lt; ro.<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>() &lt;&lt; <span class="stringliteral">&quot; pv:&quot;</span> &lt;&lt; n-&gt;GetName() &lt;&lt; <span class="stringliteral">&quot; id:&quot;</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          &lt;&lt; (<span class="keywordtype">void</span>*) volume_id &lt;&lt; <span class="stringliteral">&quot; Sensitive:&quot;</span> &lt;&lt; <a class="code" href="namespace_d_d4hep.html#a9b6e2c5ab00340e93017e18604b0cb85">yes_no</a>(sensitive);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="_geant4_sensitive_detector_8cpp.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>, log.str().c_str());</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      log.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      log &lt;&lt; s_count &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; e.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>() &lt;&lt; <span class="stringliteral">&quot; Detector GeoNodes:&quot;</span>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">for</span>(vector&lt;const TGeoNode*&gt;::const_iterator j=nodes.begin(); j!=nodes.end();++j)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        log &lt;&lt; (<span class="keywordtype">void</span>*)(*j) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="_geant4_sensitive_detector_8cpp.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>,<span class="stringliteral">&quot;VolumeManager&quot;</span>,log.str().c_str());</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  };</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#a3d11859d5bd8a89d64108af31afa4e1d">  424</a></span>&#160;VolumeManager::VolumeManager(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html">LCDD</a>&amp; lcdd, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; nam, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> elt, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html">Readout</a> ro, <span class="keywordtype">int</span> flags) {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42aae10bc5a07787c36af0a4c9921b262d2">INFO</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>, <span class="stringliteral">&quot; - populating volume ids - be patient ...&quot;</span>  );</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>* obj_ptr = <span class="keyword">new</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>();</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  assign(obj_ptr, nam, <span class="stringliteral">&quot;VolumeManager&quot;</span>);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">if</span> (elt.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>()) {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    Populator p(lcdd, *<span class="keyword">this</span>);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    obj_ptr-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a998bff824dead1dfec1642f57eae9117">detector</a> = elt;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    obj_ptr-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a34cf251ba79ecddf50f9fdaf50265968">id</a> = ro.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() ? ro.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html#a3930f675f87469d26910268c3b7066ca">idSpec</a>() : <a class="code" href="namespace_d_d4hep_1_1_simulation.html#a5f50c11f1a261ca45bb2e86ea6621083">IDDescriptor</a>();</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    obj_ptr-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a2488dfe57afee14dd92f5f30a03f827f">top</a> = obj_ptr;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    obj_ptr-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#abe994d6c29e62e21c1fd2d2be21d041d">flags</a> = flags;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    p.populate(elt);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42aae10bc5a07787c36af0a4c9921b262d2">INFO</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>, <span class="stringliteral">&quot; - populating volume ids - done&quot;</span>  );</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ae1612218645bcd2734d83519d352aea9">  440</a></span>&#160;VolumeManager::VolumeManager(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> sub_detector, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html">Readout</a> ro)  {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>* obj_ptr = <span class="keyword">new</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>();</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  obj_ptr-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a998bff824dead1dfec1642f57eae9117">detector</a> = sub_detector;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  obj_ptr-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a34cf251ba79ecddf50f9fdaf50265968">id</a> = ro.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>() ? ro.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html#a3930f675f87469d26910268c3b7066ca">idSpec</a>() : <a class="code" href="namespace_d_d4hep_1_1_simulation.html#a5f50c11f1a261ca45bb2e86ea6621083">IDDescriptor</a>();</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  assign(obj_ptr, sub_detector.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>(), <span class="stringliteral">&quot;VolumeManager&quot;</span>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#a6a9318986cf6574d07eaa86ea4da5085">  448</a></span>&#160;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a> VolumeManager::addSubdetector(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> det, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html">Readout</a> ro) {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">if</span> (isValid()) {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>&amp; o = <a class="code" href="_volumes_8cpp.html#af67cc7a88abe7fe25fba4ef71c57782b">_data</a>();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (!det.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>()) {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: VolumeManager::addSubdetector: Only valid subdetectors &quot;</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                          <span class="stringliteral">&quot;are allowed. [Invalid DetElement]&quot;</span>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    Detectors::const_iterator i = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aaf80d4d14783bbcdc05eefe7d35519dc">subdetectors</a>.find(det);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> (i == o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aaf80d4d14783bbcdc05eefe7d35519dc">subdetectors</a>.end()) {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordtype">string</span> det_name = det.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>();</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="comment">// First check all pre-conditions</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">if</span> (!ro.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>()) {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: VolumeManager::addSubdetector: Only subdetectors with a &quot;</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                            <span class="stringliteral">&quot;valid readout descriptor are allowed. [Invalid DetElement:&quot;</span> + det_name + <span class="stringliteral">&quot;]&quot;</span>);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> pv = det.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a3afa8e83d1f71cfb13df316193218769">placement</a>();</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordflow">if</span> (!pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">isValid</a>()) {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: VolumeManager::addSubdetector: Only subdetectors with a &quot;</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                            <span class="stringliteral">&quot;valid placement are allowed. [Invalid DetElement:&quot;</span> + det_name + <span class="stringliteral">&quot;]&quot;</span>);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      VolIDs::Base::const_iterator vit = pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a302037d5e140c5b832ba8057466d8214">volIDs</a>().<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds.html#a858e0760f9968c77969014aa150c2933">find</a>(<span class="stringliteral">&quot;system&quot;</span>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="keywordflow">if</span> (vit == pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a302037d5e140c5b832ba8057466d8214">volIDs</a>().end()) {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: VolumeManager::addSubdetector: Only subdetectors with &quot;</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                            <span class="stringliteral">&quot;valid placement VolIDs are allowed. [Invalid DetElement:&quot;</span> + det_name + <span class="stringliteral">&quot;]&quot;</span>);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      i = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aaf80d4d14783bbcdc05eefe7d35519dc">subdetectors</a>.insert(make_pair(det, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a>(det,ro))).first;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#aaecde4f8feb863af7cd36c1213bfabe4">PlacedVolume::VolID</a>&amp; <span class="keywordtype">id</span> = (*vit);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a> m = (*i).second;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html">IDDescriptor::Field</a> field = ro.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_readout.html#a3930f675f87469d26910268c3b7066ca">idSpec</a>().<a class="code" href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html#a9179d503a536eab536eef71b20904116">field</a>(<span class="keywordtype">id</span>.first);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">if</span> (!field) {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: VolumeManager::addSubdetector: IdDescriptor of &quot;</span> + </div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                            <span class="keywordtype">string</span>(det.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>()) + <span class="stringliteral">&quot; has no field &quot;</span> + <span class="keywordtype">id</span>.first);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>&amp; mo = m.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ae553c9b75d52a6ed8d38867fca2cf9a0">_data</a>();</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      mo.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a2488dfe57afee14dd92f5f30a03f827f">top</a> = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a2488dfe57afee14dd92f5f30a03f827f">top</a>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      mo.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#abe994d6c29e62e21c1fd2d2be21d041d">flags</a> = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#abe994d6c29e62e21c1fd2d2be21d041d">flags</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      mo.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#ab53feb861c1eef621fbdb6350df70db0">system</a> = field;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      mo.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a52c95661de580da96a5585da48064e58">sysID</a> = <span class="keywordtype">id</span>.second;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      mo.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aee03c6af6623d5d678c7cb870021e974">detMask</a> = mo.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a52c95661de580da96a5585da48064e58">sysID</a>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aff0c698fcc27fa3778734a5c5bd6074f">managers</a>[mo.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a52c95661de580da96a5585da48064e58">sysID</a>] = <a class="code" href="_volumes_8cpp.html#a6fc379aaec47ce424b00d8ffda2a6c59">m</a>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      det.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html#ad54eb9f407346f0a5fdc84713df1e218">callAtUpdate</a>(DetElement::PLACEMENT_CHANGED|DetElement::PLACEMENT_DETECTOR,</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                       &amp;mo,&amp;Object::update);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> (*i).second;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: VolumeManager::addSubdetector: &quot;</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                      <span class="stringliteral">&quot;Failed to add subdetector section. [Invalid Manager Handle]&quot;</span>);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#a2205b56a64279e2cba6345f8f7aab7ff">  499</a></span>&#160;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a> VolumeManager::subdetector(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> <span class="keywordtype">id</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">if</span> (isValid()) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>&amp; o = <a class="code" href="_volumes_8cpp.html#af67cc7a88abe7fe25fba4ef71c57782b">_data</a>();</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">for</span> (Detectors::const_iterator j = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aaf80d4d14783bbcdc05eefe7d35519dc">subdetectors</a>.begin(); j != o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aaf80d4d14783bbcdc05eefe7d35519dc">subdetectors</a>.end(); ++j) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>&amp; mo = (*j).second._data();</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="comment">//VolumeID sys_id = mo.system.decode(id);</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> sys_id = mo.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#ab53feb861c1eef621fbdb6350df70db0">system</a>-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a46fee9b58df6cfc614afdbf6e82e7e80">value</a>(<span class="keywordtype">id</span> &lt;&lt; mo.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#ab53feb861c1eef621fbdb6350df70db0">system</a>-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#ab8aa1a30c457ac06641276a2e10e647d">offset</a>());</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">if</span> (sys_id == mo.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a52c95661de580da96a5585da48064e58">sysID</a>)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">return</span> (*j).second;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: VolumeManager::subdetector(VolID): &quot;</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                        <span class="stringliteral">&quot;Attempt to access unknown subdetector section.&quot;</span>);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: VolumeManager::subdetector(VolID): &quot;</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                      <span class="stringliteral">&quot;Cannot assign ID descriptor [Invalid Manager Handle]&quot;</span>);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#a0da5e3f504392edecef3b1f1f3c7b111">  518</a></span>&#160;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> VolumeManager::detector()<span class="keyword"> const </span>{</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">if</span> (isValid()) {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_volumes_8cpp.html#af67cc7a88abe7fe25fba4ef71c57782b">_data</a>().detector;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: VolumeManager::detector: Cannot access DetElement [Invalid Handle]&quot;</span>);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#aa114fa9663579ed3ca0f5d59ae8d32db">  526</a></span>&#160;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html">IDDescriptor</a> VolumeManager::idSpec()<span class="keyword"> const </span>{</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="_volumes_8cpp.html#af67cc7a88abe7fe25fba4ef71c57782b">_data</a>().id;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;}</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ac7ad07c472812b32144b3c2a8b4475b2">  531</a></span>&#160;<span class="keywordtype">bool</span> VolumeManager::adoptPlacement(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> <span class="comment">/* sys_id */</span>, <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">Context</a>* context) {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  stringstream err;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>&amp; o = <a class="code" href="_volumes_8cpp.html#af67cc7a88abe7fe25fba4ef71c57782b">_data</a>();</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> vid = context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a>;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> pv = context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#aa6c87ac47a16aa5094ca87d5991ab91f">placement</a>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  Volumes::iterator i = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a7ba195782a138b7e47a66389c5845ae6">volumes</a>.find(vid);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">if</span> ( (context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a>&amp;context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a052bc7df447cef84eabe15a5751e772b">mask</a>) != context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a> ) {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;Bad context mask:&quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*)context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a052bc7df447cef84eabe15a5751e772b">mask</a> &lt;&lt; <span class="stringliteral">&quot; id:&quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*)context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; pv:&quot;</span> &lt;&lt; pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>() &lt;&lt; <span class="stringliteral">&quot; Sensitive:&quot;</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        &lt;&lt; <a class="code" href="namespace_d_d4hep.html#a9b6e2c5ab00340e93017e18604b0cb85">yes_no</a>(pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a13113feba33041cee2738730ab70a9fc">volume</a>().<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aa324bff4bb7c4e5a4575f81819d78d48">isSensitive</a>()) &lt;&lt; endl;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">goto</span> Fail;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordflow">if</span> (i == o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a7ba195782a138b7e47a66389c5845ae6">volumes</a>.end()) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a7ba195782a138b7e47a66389c5845ae6">volumes</a>[vid] = context;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aee03c6af6623d5d678c7cb870021e974">detMask</a> |= context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a052bc7df447cef84eabe15a5751e772b">mask</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;Inserted new volume:&quot;</span> &lt;&lt; setw(6) &lt;&lt; left &lt;&lt; o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a7ba195782a138b7e47a66389c5845ae6">volumes</a>.size() &lt;&lt; <span class="stringliteral">&quot; Ptr:&quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*) pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>() &lt;&lt; <span class="stringliteral">&quot; [&quot;</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        &lt;&lt; pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>() &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; <span class="stringliteral">&quot; ID:&quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*) context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a> &lt;&lt; <span class="stringliteral">&quot; Mask:&quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*) context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a052bc7df447cef84eabe15a5751e772b">mask</a>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42a2c12bf245b6095423f62644ab1f5eedf">VERBOSE</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>, err.str().c_str());</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  err &lt;&lt; <span class="stringliteral">&quot;+++ Attempt to register duplicate volID &quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*) context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Mask:&quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*) context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a052bc7df447cef84eabe15a5751e772b">mask</a></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; to detector &quot;</span> &lt;&lt; o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a998bff824dead1dfec1642f57eae9117">detector</a>.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>()</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; ptr:&quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*) pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>()</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Name:&quot;</span> &lt;&lt; pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>()</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Sensitive:&quot;</span> &lt;&lt; <a class="code" href="namespace_d_d4hep.html#a9b6e2c5ab00340e93017e18604b0cb85">yes_no</a>(pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a13113feba33041cee2738730ab70a9fc">volume</a>().<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aa324bff4bb7c4e5a4575f81819d78d48">isSensitive</a>()) &lt;&lt; endl;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42a54d5c1b9254fdf017c456cb972d26f96">ERROR</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, err.str().c_str());</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  err.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  err &lt;&lt; <span class="stringliteral">&quot; !!!!!                      ++++ VolIDS &quot;</span>;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds.html#a9328d0964ef092fd108679b2ecafd5b7">VolIDs::Base</a>&amp; id_vector = context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a3982d4e94fc483caa54382e719eb568c">volID</a>;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keywordflow">for</span> (VolIDs::Base::const_iterator vit = id_vector.begin(); vit != id_vector.end(); ++vit)</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    err &lt;&lt; (*vit).first &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; (*vit).second &lt;&lt; <span class="stringliteral">&quot;; &quot;</span>;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42a54d5c1b9254fdf017c456cb972d26f96">ERROR</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, err.str().c_str());</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  err.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  context = (*i).second;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  pv = context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#aa6c87ac47a16aa5094ca87d5991ab91f">placement</a>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  err &lt;&lt; <span class="stringliteral">&quot; !!!!!               +++ Clashing volID &quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*) context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Mask:&quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*) context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a052bc7df447cef84eabe15a5751e772b">mask</a></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; to detector &quot;</span> &lt;&lt; o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a998bff824dead1dfec1642f57eae9117">detector</a>.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>()</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; ptr:&quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*) pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">ptr</a>()</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Name:&quot;</span> &lt;&lt; pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>()</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Sensitive:&quot;</span> &lt;&lt; <a class="code" href="namespace_d_d4hep.html#a9b6e2c5ab00340e93017e18604b0cb85">yes_no</a>(pv.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a13113feba33041cee2738730ab70a9fc">volume</a>().<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aa324bff4bb7c4e5a4575f81819d78d48">isSensitive</a>()) &lt;&lt; endl;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42a54d5c1b9254fdf017c456cb972d26f96">ERROR</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, err.str().c_str());</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  err.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">goto</span> Fail;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; Fail: {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot; !!!!!                      ++++ VolIDS &quot;</span>;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds.html#a9328d0964ef092fd108679b2ecafd5b7">VolIDs::Base</a>&amp; ids = context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a3982d4e94fc483caa54382e719eb568c">volID</a>;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">for</span> (VolIDs::Base::const_iterator vit = ids.begin(); vit != ids.end(); ++vit)</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      err &lt;&lt; (*vit).first &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; (*vit).second &lt;&lt; <span class="stringliteral">&quot;; &quot;</span>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42a54d5c1b9254fdf017c456cb972d26f96">ERROR</a>, <span class="stringliteral">&quot;VolumeManager&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, err.str().c_str());</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="comment">// throw runtime_error(err.str());</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;}</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#acfeddaf04beb69692702c453a9ad9933">  591</a></span>&#160;<span class="keywordtype">bool</span> VolumeManager::adoptPlacement(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">Context</a>* context) {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  stringstream err;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">if</span> (isValid()) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>&amp; o = <a class="code" href="_volumes_8cpp.html#af67cc7a88abe7fe25fba4ef71c57782b">_data</a>();</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">if</span> (context) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordflow">if</span> ((o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#abe994d6c29e62e21c1fd2d2be21d041d">flags</a> &amp; ONE) == ONE) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a> top(<a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga40af83be6718bb8828a3d83dc7f8c930">Ref_t</a>(o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a2488dfe57afee14dd92f5f30a03f827f">top</a>));</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">return</span> top.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#acfeddaf04beb69692702c453a9ad9933">adoptPlacement</a>(context);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">if</span> ((o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#abe994d6c29e62e21c1fd2d2be21d041d">flags</a> &amp; TREE) == TREE) {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordtype">bool</span> isTop = ptr() == o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a2488dfe57afee14dd92f5f30a03f827f">top</a>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordflow">if</span> (!isTop) {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> sys_id = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#ab53feb861c1eef621fbdb6350df70db0">system</a>-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a46fee9b58df6cfc614afdbf6e82e7e80">value</a>(context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a>);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;          <span class="keywordflow">if</span> (sys_id == o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a52c95661de580da96a5585da48064e58">sysID</a>) {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordflow">return</span> adoptPlacement(sys_id, context);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;          }</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a> top(<a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga40af83be6718bb8828a3d83dc7f8c930">Ref_t</a>(o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a2488dfe57afee14dd92f5f30a03f827f">top</a>));</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;          <span class="keywordflow">return</span> top.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#acfeddaf04beb69692702c453a9ad9933">adoptPlacement</a>(context);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">for</span> (Managers::iterator j = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aff0c698fcc27fa3778734a5c5bd6074f">managers</a>.begin(); j != o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aff0c698fcc27fa3778734a5c5bd6074f">managers</a>.end(); ++j) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>&amp; m = (*j).second._data();</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> sid = m.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#ab53feb861c1eef621fbdb6350df70db0">system</a>-&gt;<a class="code" href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a46fee9b58df6cfc614afdbf6e82e7e80">value</a>(context-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a>);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <span class="keywordflow">if</span> ((*j).first == sid) {</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <span class="keywordflow">return</span> (*j).second.adoptPlacement(sid, context);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;Failed to add new physical volume to detector:&quot;</span> &lt;&lt; o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a998bff824dead1dfec1642f57eae9117">detector</a>.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>() &lt;&lt; <span class="stringliteral">&quot; [Invalid Context]&quot;</span>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">goto</span> Fail;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  err &lt;&lt; <span class="stringliteral">&quot;Failed to add new physical volume [Invalid Manager Handle]&quot;</span>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">goto</span> Fail;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; Fail: <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: &quot;</span> + err.str());</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ac6e159608642efd4a62d81f793a01263">  630</a></span>&#160;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">VolumeManager::Context</a>* VolumeManager::lookupContext(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> volume_id)<span class="keyword"> const </span>{</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordflow">if</span> (isValid()) {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">Context</a>* c = 0;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">Object</a>&amp; o = <a class="code" href="_volumes_8cpp.html#af67cc7a88abe7fe25fba4ef71c57782b">_data</a>();</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordtype">bool</span> is_top = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a2488dfe57afee14dd92f5f30a03f827f">top</a> == ptr();</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">bool</span> one_tree = (o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#abe994d6c29e62e21c1fd2d2be21d041d">flags</a> &amp; ONE) == ONE;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">if</span> (!is_top &amp;&amp; one_tree) {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a>(<a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga40af83be6718bb8828a3d83dc7f8c930">Ref_t</a>(o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a2488dfe57afee14dd92f5f30a03f827f">top</a>)).<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ac6e159608642efd4a62d81f793a01263">lookupContext</a>(volume_id);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> <span class="keywordtype">id</span> = volume_id;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    c = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a05d84aae2102afcc7e22fcfffd5cde55">search</a>(<span class="keywordtype">id</span>);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">if</span> (c)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="keywordflow">return</span> c;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">if</span> (!one_tree) {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keywordflow">for</span> (Detectors::const_iterator j = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aaf80d4d14783bbcdc05eefe7d35519dc">subdetectors</a>.begin(); j != o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aaf80d4d14783bbcdc05eefe7d35519dc">subdetectors</a>.end(); ++j) {</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">if</span> ((c = (*j).second._data().search(<span class="keywordtype">id</span>)) != 0)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          <span class="keywordflow">return</span> c;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    stringstream err;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;VolumeManager::lookupContext: Failed to search Volume context [Unknown identifier]&quot;</span> </div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        &lt;&lt; (<span class="keywordtype">void</span>*) volume_id;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: &quot;</span> + err.str());</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;DD4hep: VolumeManager::lookupContext: &quot;</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                      <span class="stringliteral">&quot;Failed to search Volume context [Invalid Manager Handle]&quot;</span>);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;}</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#aff0f31cb3233b2ebf3d99e5769737e94">  661</a></span>&#160;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> VolumeManager::lookupPlacement(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> volume_id)<span class="keyword"> const </span>{</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">Context</a>* c = lookupContext(volume_id);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">return</span> c-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#aa6c87ac47a16aa5094ca87d5991ab91f">placement</a>;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;}</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#a1b674c835b5dc04d22ab1e4c2cd52775">  667</a></span>&#160;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> VolumeManager::lookupDetector(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> volume_id)<span class="keyword"> const </span>{</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">Context</a>* c = lookupContext(volume_id);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">return</span> c-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a4b637a36900149ff3490731f62ca1d52">detector</a>;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1be2614964d7ecc227ba03639e55894">  673</a></span>&#160;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DetElement</a> VolumeManager::lookupDetElement(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> volume_id)<span class="keyword"> const </span>{</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">Context</a>* c = lookupContext(volume_id);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keywordflow">return</span> c-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a57c697291054cc0fa221f047dd32938f">element</a>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;}</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno"><a class="line" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#a3d94720b4fe3f949fbfe9c3c332147dc">  679</a></span>&#160;<span class="keyword">const</span> TGeoMatrix&amp; VolumeManager::worldTransformation(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">VolumeID</a> volume_id)<span class="keyword"> const </span>{</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">Context</a>* c = lookupContext(volume_id);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">return</span> c-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a724f7f6ffc6fc9e91dca0f07d5f14d1d">toWorld</a>;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;}</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="namespace_d_d4hep_1_1_geometry.html#a3e162786678e79867327c71e9699ac71">  685</a></span>&#160;std::ostream&amp; <a class="code" href="namespace_d_d4hep_1_1_geometry.html#a3e162786678e79867327c71e9699ac71">DD4hep::Geometry::operator&lt;&lt;</a>(std::ostream&amp; os, <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">VolumeManager</a>&amp; m) {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">VolumeManager::Object</a>&amp; o = *m.<a class="code" href="class_d_d4hep_1_1_handle.html#accccca2cf7cab5a234ab59b8b9e060a2">data</a>&lt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">VolumeManager::Object</a>&gt;();</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">VolumeManager::Object</a>* top = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">VolumeManager::Object</a>*<span class="keyword">&gt;</span>(o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a2488dfe57afee14dd92f5f30a03f827f">top</a>);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keywordtype">bool</span> isTop = top == &amp;o;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="comment">//bool hasTop = (o.flags &amp; VolumeManager::ONE) == VolumeManager::ONE;</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">//bool isSdet = (o.flags &amp; VolumeManager::TREE) == VolumeManager::TREE &amp;&amp; top != &amp;o;</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordtype">string</span> prefix(isTop ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;++  &quot;</span>);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  os &lt;&lt; prefix &lt;&lt; (isTop ? <span class="stringliteral">&quot;TOP Level &quot;</span> : <span class="stringliteral">&quot;Secondary &quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Volume manager:&quot;</span> </div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;     &lt;&lt; &amp;o &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a998bff824dead1dfec1642f57eae9117">detector</a>.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>() &lt;&lt; <span class="stringliteral">&quot; IDD:&quot;</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;     &lt;&lt; o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a34cf251ba79ecddf50f9fdaf50265968">id</a>.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html#a0e4113ffe3560b7cef6da4e880d827f3">toString</a>() &lt;&lt; <span class="stringliteral">&quot; SysID:&quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*) o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a52c95661de580da96a5585da48064e58">sysID</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;     &lt;&lt; o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aff0c698fcc27fa3778734a5c5bd6074f">managers</a>.size() &lt;&lt; <span class="stringliteral">&quot; subsections &quot;</span> &lt;&lt; o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a7ba195782a138b7e47a66389c5845ae6">volumes</a>.size()</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; placements &quot;</span>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordflow">if</span> (!(o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aff0c698fcc27fa3778734a5c5bd6074f">managers</a>.empty() &amp;&amp; o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a7ba195782a138b7e47a66389c5845ae6">volumes</a>.empty()))</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    os &lt;&lt; endl;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordflow">for</span> (VolumeManager::Volumes::const_iterator i = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a7ba195782a138b7e47a66389c5845ae6">volumes</a>.begin(); i != o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a7ba195782a138b7e47a66389c5845ae6">volumes</a>.end(); ++i) {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">VolumeManager::Context</a>* c = (*i).second;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">PlacedVolume</a> pv = c-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#aa6c87ac47a16aa5094ca87d5991ab91f">placement</a>;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    os &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;PV:&quot;</span> &lt;&lt; setw(32) &lt;&lt; left &lt;&lt; pv.<a class="code" href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">name</a>() </div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;       &lt;&lt; <span class="stringliteral">&quot; id:&quot;</span> &lt;&lt; setw(18) &lt;&lt; left &lt;&lt; (<span class="keywordtype">void</span>*) c-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">identifier</a> &lt;&lt; <span class="stringliteral">&quot; mask:&quot;</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;       &lt;&lt; setw(18) &lt;&lt; left &lt;&lt; (<span class="keywordtype">void</span>*) c-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a052bc7df447cef84eabe15a5751e772b">mask</a> &lt;&lt; endl;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="keywordflow">for</span> (VolumeManager::Managers::const_iterator i = o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aff0c698fcc27fa3778734a5c5bd6074f">managers</a>.begin(); i != o.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aff0c698fcc27fa3778734a5c5bd6074f">managers</a>.end(); ++i)</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    os &lt;&lt; prefix &lt;&lt; (*i).second &lt;&lt; endl;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">return</span> os;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;}</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">// #if 0</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">// It was wishful thinking, the implementation of the reverse lookups would be as simple.</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">// Hence the folling calls are removed for the time being.</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">// Markus Frank</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">// /** This set of functions is required when reading/analyzing</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">//  *  already created hits which have a VolumeID attached.</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">//  */</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">// /// Lookup the context, which belongs to a registered physical volume.</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">// Context* lookupContext(PlacedVolume vol) const throw();</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">// /// Access the physical volume identifier from the placed volume</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">// VolumeID lookupID(PlacedVolume vol) const;</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">// /// Lookup a top level subdetector detector element according to a contained 64 bit hit ID</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">// DetElement lookupDetector(PlacedVolume vol) const;</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">// /// Lookup the closest subdetector detector element in the hierarchy according to a contained 64 bit hit ID</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">// DetElement lookupDetElement(PlacedVolume vol) const;</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">// /// Access the transformation of a physical volume to the world coordinate system</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">// const TGeoMatrix&amp; worldTransformation(PlacedVolume vol) const;</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">// /// Lookup the context, which belongs to a registered physical volume.</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">// VolumeManager::Context* VolumeManager::lookupContext(PlacedVolume pv) const throw() {</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">//   if ( isValid() ) {</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">//     Context* c = 0;</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">//     const Object&amp; o = _data();</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">//     if ( o.top != ptr() &amp;&amp; (o.flags&amp;ONE) == ONE ) {</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">//       return VolumeManager(Ref_t(o.top)).lookupContext(pv);</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">//     }</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">//     /// First look in our own volume cache if the entry is found.</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">//     c = o.search(pv);</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">//     if ( c ) return c;</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">//     /// Second: look in the subdetector volume cache if the entry is found.</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">//     for(Detectors::const_iterator j=o.subdetectors.begin(); j != o.subdetectors.end(); ++j) {</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">//       if ( (c=(*j).second._data().search(pv)) != 0 )</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">//       return c;</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">//     }</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">//     throw runtime_error(&quot;VolumeManager::lookupContext: Failed to search Volume context [Unknown identifier]&quot;);</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">//   }</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">//   throw runtime_error(&quot;VolumeManager::lookupContext: Failed to search Volume context [Invalid Manager Handle]&quot;);</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">// }</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">// /// Access the physical volume identifier from the placed volume</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">// VolumeManager::VolumeID VolumeManager::lookupID(PlacedVolume vol) const {</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">//   Context* c = lookupContext(vol);</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">//   return c-&gt;identifier;</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">// }</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">// /// Lookup a top level subdetector detector element according to a contained 64 bit hit ID</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">// DetElement VolumeManager::lookupDetector(PlacedVolume vol) const {</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">//   Context* c = lookupContext(vol);</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">//   return c-&gt;detector;</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">// }</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">// /// Lookup the closest subdetector detector element in the hierarchy according to a contained 64 bit hit ID</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">// DetElement VolumeManager::lookupDetElement(PlacedVolume vol) const {</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">//   Context* c = lookupContext(vol);</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">//   return c-&gt;element;</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">// }</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">// /// Access the transformation of a physical volume to the world coordinate system</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">// const TGeoMatrix&amp; VolumeManager::worldTransformation(PlacedVolume vol) const {</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">//   Context* c = lookupContext(vol);</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">//   return c-&gt;toWorld;</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">// }</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">// #endif</span></div><div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_sensitive_detector_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html">DD4hep::Geometry::SensitiveDetector</a></div><div class="ttdoc">Handle class to hold the information of a sensitive detector. </div><div class="ttdef"><b>Definition:</b> <a href="_detector_8h_source.html#l00047">Detector.h:47</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_handle_html_a27c7d467a609ab32c133e1f3c7d85ef5"><div class="ttname"><a href="class_d_d4hep_1_1_handle.html#a27c7d467a609ab32c133e1f3c7d85ef5">DD4hep::Handle::name</a></div><div class="ttdeci">const char * name() const</div><div class="ttdoc">Access the object name (or &quot;&quot; if not supported by the object) </div><div class="ttdef"><b>Definition:</b> <a href="_handle_8inl_source.html#l00036">Handle.inl:36</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_html_a6a9318986cf6574d07eaa86ea4da5085"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#a6a9318986cf6574d07eaa86ea4da5085">DD4hep::Geometry::VolumeManager::addSubdetector</a></div><div class="ttdeci">VolumeManager addSubdetector(DetElement detector, Readout ro)</div><div class="ttdoc">Add a new Volume manager section according to a new subdetector. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_8cpp_source.html#l00448">VolumeManager.cpp:448</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_det_element_html_a3afa8e83d1f71cfb13df316193218769"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a3afa8e83d1f71cfb13df316193218769">DD4hep::Geometry::DetElement::placement</a></div><div class="ttdeci">PlacedVolume placement() const</div><div class="ttdoc">Access to the physical volume of this detector element. </div><div class="ttdef"><b>Definition:</b> <a href="_detector_8cpp_source.html#l00271">Detector.cpp:271</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_html_acfeddaf04beb69692702c453a9ad9933"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#acfeddaf04beb69692702c453a9ad9933">DD4hep::Geometry::VolumeManager::adoptPlacement</a></div><div class="ttdeci">bool adoptPlacement(Context *context)</div><div class="ttdoc">Register physical volume with the manager (normally: section manager) </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_8cpp_source.html#l00591">VolumeManager.cpp:591</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_context_html_a3982d4e94fc483caa54382e719eb568c"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a3982d4e94fc483caa54382e719eb568c">DD4hep::Geometry::VolumeManagerContext::volID</a></div><div class="ttdeci">VolIDs volID</div><div class="ttdoc">Volume IDS corresponding to this element. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00072">VolumeManagerInterna.h:72</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_placed_volume_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html">DD4hep::Geometry::PlacedVolume</a></div><div class="ttdoc">Handle class holding a placed volume (also called physical volume) </div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8h_source.html#l00135">Volumes.h:135</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html_aaf80d4d14783bbcdc05eefe7d35519dc"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aaf80d4d14783bbcdc05eefe7d35519dc">DD4hep::Geometry::VolumeManagerObject::subdetectors</a></div><div class="ttdeci">Detectors subdetectors</div><div class="ttdoc">The container of subdetector elements. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00099">VolumeManagerInterna.h:99</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_context_html_a0978a0bffd0e0669f14d0ddea43ea6bb"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a0978a0bffd0e0669f14d0ddea43ea6bb">DD4hep::Geometry::VolumeManagerContext::toDetector</a></div><div class="ttdeci">TGeoHMatrix toDetector</div><div class="ttdoc">The transformation of space-points to the corrdinate system of the closests detector element...</div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00068">VolumeManagerInterna.h:68</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_context_html_a57c697291054cc0fa221f047dd32938f"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a57c697291054cc0fa221f047dd32938f">DD4hep::Geometry::VolumeManagerContext::element</a></div><div class="ttdeci">DetElement element</div><div class="ttdoc">Handle to the closest Detector element. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00066">VolumeManagerInterna.h:66</a></div></div>
<div class="ttc" id="_l_c_d_d_8h_html"><div class="ttname"><a href="_l_c_d_d_8h.html">LCDD.h</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html_a7ba195782a138b7e47a66389c5845ae6"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a7ba195782a138b7e47a66389c5845ae6">DD4hep::Geometry::VolumeManagerObject::volumes</a></div><div class="ttdeci">Volumes volumes</div><div class="ttdoc">The container of placements managed by this instance. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00103">VolumeManagerInterna.h:103</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html_a05d84aae2102afcc7e22fcfffd5cde55"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a05d84aae2102afcc7e22fcfffd5cde55">DD4hep::Geometry::VolumeManagerObject::search</a></div><div class="ttdeci">Context * search(const VolumeID &amp;id) const</div><div class="ttdoc">Search the locally cached volumes for a matching ID. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8cpp_source.html#l00064">VolumeManagerInterna.cpp:64</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_handle_html_ad50d0ea67a1c9a4e87d232f96ebe52f1"><div class="ttname"><a href="class_d_d4hep_1_1_handle.html#ad50d0ea67a1c9a4e87d232f96ebe52f1">DD4hep::Handle::clear</a></div><div class="ttdeci">Handle&lt; T &gt; &amp; clear()</div><div class="ttdoc">Release the object held by the handle. </div><div class="ttdef"><b>Definition:</b> <a href="_handle_8h_source.html#l00132">Handle.h:132</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html_a52c95661de580da96a5585da48064e58"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a52c95661de580da96a5585da48064e58">DD4hep::Geometry::VolumeManagerObject::sysID</a></div><div class="ttdeci">VolumeID sysID</div><div class="ttdoc">System identifier. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00113">VolumeManagerInterna.h:113</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_placed_volume_html_a302037d5e140c5b832ba8057466d8214"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a302037d5e140c5b832ba8057466d8214">DD4hep::Geometry::PlacedVolume::volIDs</a></div><div class="ttdeci">const VolIDs &amp; volIDs() const</div><div class="ttdoc">Access to the volume IDs. </div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8cpp_source.html#l00400">Volumes.cpp:400</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html_a2488dfe57afee14dd92f5f30a03f827f"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a2488dfe57afee14dd92f5f30a03f827f">DD4hep::Geometry::VolumeManagerObject::top</a></div><div class="ttdeci">VolumeManagerObject * top</div><div class="ttdoc">The reference to the TOP level VolumeManager. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00109">VolumeManagerInterna.h:109</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value_html_ab8aa1a30c457ac06641276a2e10e647d"><div class="ttname"><a href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#ab8aa1a30c457ac06641276a2e10e647d">DD4hep::DDSegmentation::BitFieldValue::offset</a></div><div class="ttdeci">unsigned offset() const</div><div class="ttdef"><b>Definition:</b> <a href="_d_d_segmentation_2include_2_d_d_segmentation_2_bit_field64_8h_source.html#l00266">BitField64.h:266</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_det_element_html_a5f8b4268684a3cd4a5f613181a8bac83"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a5f8b4268684a3cd4a5f613181a8bac83">DD4hep::Geometry::DetElement::path</a></div><div class="ttdeci">const std::string &amp; path() const</div><div class="ttdoc">Path of the detector element (not necessarily identical to placement path!) </div><div class="ttdef"><b>Definition:</b> <a href="_detector_8cpp_source.html#l00152">Detector.cpp:152</a></div></div>
<div class="ttc" id="_detector_interna_8h_html"><div class="ttname"><a href="_detector_interna_8h.html">DetectorInterna.h</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_context_html_aa6c87ac47a16aa5094ca87d5991ab91f"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#aa6c87ac47a16aa5094ca87d5991ab91f">DD4hep::Geometry::VolumeManagerContext::placement</a></div><div class="ttdeci">PlacedVolume placement</div><div class="ttdoc">The placement. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00062">VolumeManagerInterna.h:62</a></div></div>
<div class="ttc" id="namespace_d_d4hep_html_a9b6e2c5ab00340e93017e18604b0cb85"><div class="ttname"><a href="namespace_d_d4hep.html#a9b6e2c5ab00340e93017e18604b0cb85">DD4hep::yes_no</a></div><div class="ttdeci">const char * yes_no(bool value)</div><div class="ttdoc">Helper function to print booleans in format YES/NO. </div><div class="ttdef"><b>Definition:</b> <a href="_printout_8h_source.html#l00258">Printout.h:258</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_context_html_a724f7f6ffc6fc9e91dca0f07d5f14d1d"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a724f7f6ffc6fc9e91dca0f07d5f14d1d">DD4hep::Geometry::VolumeManagerContext::toWorld</a></div><div class="ttdeci">TGeoHMatrix toWorld</div><div class="ttdoc">The transformation of space-points to the world corrdinate system. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00070">VolumeManagerInterna.h:70</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_context_html_a052bc7df447cef84eabe15a5751e772b"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a052bc7df447cef84eabe15a5751e772b">DD4hep::Geometry::VolumeManagerContext::mask</a></div><div class="ttdeci">VolumeID mask</div><div class="ttdoc">Ignore mask of the placement identifier. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00060">VolumeManagerInterna.h:60</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_context_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html">DD4hep::Geometry::VolumeManagerContext</a></div><div class="ttdoc">This structure describes the cached data for one placement held by the volume manager. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00052">VolumeManagerInterna.h:52</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_det_element_html_acaf0a39faf4eeab43c30158c9a7169ec"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_det_element.html#acaf0a39faf4eeab43c30158c9a7169ec">DD4hep::Geometry::DetElement::worldTransformation</a></div><div class="ttdeci">const TGeoHMatrix &amp; worldTransformation() const</div><div class="ttdoc">Set detector element for reference transformations. Will delete existing reference trafo...</div><div class="ttdef"><b>Definition:</b> <a href="_detector_8cpp_source.html#l00367">Detector.cpp:367</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value_html"><div class="ttname"><a href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html">DD4hep::DDSegmentation::BitFieldValue</a></div><div class="ttdef"><b>Definition:</b> <a href="_d_d_segmentation_2include_2_d_d_segmentation_2_bit_field64_8h_source.html#l00225">BitField64.h:225</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_l_c_d_d_html_af476b8241b93e82350ec1e5cbf145941"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#af476b8241b93e82350ec1e5cbf145941">DD4hep::Geometry::LCDD::sensitiveDetector</a></div><div class="ttdeci">virtual SensitiveDetector sensitiveDetector(const std::string &amp;name) const =0</div><div class="ttdoc">Retrieve a sensitive detector by it&amp;#39;s name from the detector description. </div></div>
<div class="ttc" id="_volumes_8cpp_html_a8a9a1f93e9b09afccaec215310e64142"><div class="ttname"><a href="_volumes_8cpp.html#a8a9a1f93e9b09afccaec215310e64142">e</a></div><div class="ttdeci">return e</div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8cpp_source.html#l00298">Volumes.cpp:298</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html_a998bff824dead1dfec1642f57eae9117"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a998bff824dead1dfec1642f57eae9117">DD4hep::Geometry::VolumeManagerObject::detector</a></div><div class="ttdeci">DetElement detector</div><div class="ttdoc">The Detector element handle managed by this instance. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00105">VolumeManagerInterna.h:105</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_sensitive_detector_html_ad79f39c5b360f7ecf2341de990131eb2"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html#ad79f39c5b360f7ecf2341de990131eb2">DD4hep::Geometry::SensitiveDetector::readout</a></div><div class="ttdeci">Readout readout() const</div><div class="ttdoc">Access readout structure of the sensitive detector. </div><div class="ttdef"><b>Definition:</b> <a href="_detector_8cpp_source.html#l00443">Detector.cpp:443</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_handle_html_accccca2cf7cab5a234ab59b8b9e060a2"><div class="ttname"><a href="class_d_d4hep_1_1_handle.html#accccca2cf7cab5a234ab59b8b9e060a2">DD4hep::Handle::data</a></div><div class="ttdeci">Q * data() const</div><div class="ttdoc">Access to an unrelated object type. </div><div class="ttdef"><b>Definition:</b> <a href="_handle_8h_source.html#l00157">Handle.h:157</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_html_ac6e159608642efd4a62d81f793a01263"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ac6e159608642efd4a62d81f793a01263">DD4hep::Geometry::VolumeManager::lookupContext</a></div><div class="ttdeci">Context * lookupContext(VolumeID volume_id) const</div><div class="ttdoc">Lookup the context, which belongs to a registered physical volume. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_8cpp_source.html#l00630">VolumeManager.cpp:630</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_readout_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_readout.html">DD4hep::Geometry::Readout</a></div><div class="ttdoc">Handle to the implementation of the readout structure of a subdetector. </div><div class="ttdef"><b>Definition:</b> <a href="_readout_8h_source.html#l00046">Readout.h:46</a></div></div>
<div class="ttc" id="namespace_d_d4hep_1_1_geometry_html_a3e162786678e79867327c71e9699ac71"><div class="ttname"><a href="namespace_d_d4hep_1_1_geometry.html#a3e162786678e79867327c71e9699ac71">DD4hep::Geometry::operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;os, const VolumeManager &amp;m)</div><div class="ttdoc">Enable printouts for debugging. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_8cpp_source.html#l00685">VolumeManager.cpp:685</a></div></div>
<div class="ttc" id="namespace_d_d4hep_html_a21dd977310ff183f61ca6ae14b59a989"><div class="ttname"><a href="namespace_d_d4hep.html#a21dd977310ff183f61ca6ae14b59a989">DD4hep::DetElement</a></div><div class="ttdeci">DD4hep::Geometry::DetElement DetElement</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_x_m_l_setup_8cpp_source.html#l00032">Geant4XMLSetup.cpp:32</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html_ab53feb861c1eef621fbdb6350df70db0"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#ab53feb861c1eef621fbdb6350df70db0">DD4hep::Geometry::VolumeManagerObject::system</a></div><div class="ttdeci">Field system</div><div class="ttdoc">The system field descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00111">VolumeManagerInterna.h:111</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_det_element_html_ab32f6441336990dc9a44cb4420b01644"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_det_element.html#ab32f6441336990dc9a44cb4420b01644">DD4hep::Geometry::DetElement::children</a></div><div class="ttdeci">const Children &amp; children() const</div><div class="ttdoc">Access to the list of children. </div><div class="ttdef"><b>Definition:</b> <a href="_detector_8cpp_source.html#l00199">Detector.cpp:199</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume.html">DD4hep::Geometry::Volume</a></div><div class="ttdoc">Handle class holding a placed volume (also called physical volume) </div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8h_source.html#l00237">Volumes.h:237</a></div></div>
<div class="ttc" id="namespace_d_d4hep_1_1_geometry_html"><div class="ttname"><a href="namespace_d_d4hep_1_1_geometry.html">DD4hep::Geometry</a></div><div class="ttdoc">Namespace for the geometry part of the AIDA detector description toolkit. </div><div class="ttdef"><b>Definition:</b> <a href="_detector_tools_8cpp_source.html#l00033">DetectorTools.cpp:33</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_placed_volume_html_aaecde4f8feb863af7cd36c1213bfabe4"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#aaecde4f8feb863af7cd36c1213bfabe4">DD4hep::Geometry::PlacedVolume::VolID</a></div><div class="ttdeci">Object::VolID VolID</div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8h_source.html#l00139">Volumes.h:139</a></div></div>
<div class="ttc" id="namespace_d_d4hep_html"><div class="ttname"><a href="namespace_d_d4hep.html">DD4hep</a></div><div class="ttdoc">Namespace for the AIDA detector description toolkit. </div><div class="ttdef"><b>Definition:</b> <a href="_alignments_8cpp_source.html#l00027">Alignments.cpp:27</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds.html">DD4hep::Geometry::PlacedVolumeExtension::VolIDs</a></div><div class="ttdoc">Volume ID container. </div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8h_source.html#l00081">Volumes.h:81</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_l_c_d_d_html_a0ed0c4e5d72a1e07ce11cf2592d6de3e"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#a0ed0c4e5d72a1e07ce11cf2592d6de3e">DD4hep::Geometry::LCDD::detector</a></div><div class="ttdeci">virtual DetElement detector(const std::string &amp;name) const =0</div><div class="ttdoc">Retrieve a field component by it&amp;#39;s name from the detector description. </div></div>
<div class="ttc" id="_volumes_8cpp_html_af67cc7a88abe7fe25fba4ef71c57782b"><div class="ttname"><a href="_volumes_8cpp.html#af67cc7a88abe7fe25fba4ef71c57782b">_data</a></div><div class="ttdeci">Volume::Object * _data(const Volume &amp;v, bool throw_exception=true)</div><div class="ttdoc">Accessor to the data part of the Volume. </div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8cpp_source.html#l00465">Volumes.cpp:465</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor_html_a0e4113ffe3560b7cef6da4e880d827f3"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html#a0e4113ffe3560b7cef6da4e880d827f3">DD4hep::Geometry::IDDescriptor::toString</a></div><div class="ttdeci">std::string toString() const</div><div class="ttdoc">Access string representation. </div><div class="ttdef"><b>Definition:</b> <a href="_i_d_descriptor_8cpp_source.html#l00049">IDDescriptor.cpp:49</a></div></div>
<div class="ttc" id="namespace_d_d4hep_html_a5b5a64d56252469451f2020a27d57d42ac24ff9a0f663cd47b4e4e37a977dff02"><div class="ttname"><a href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42ac24ff9a0f663cd47b4e4e37a977dff02">DD4hep::WARNING</a></div><div class="ttdef"><b>Definition:</b> <a href="_printout_8h_source.html#l00048">Printout.h:48</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html_aee03c6af6623d5d678c7cb870021e974"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aee03c6af6623d5d678c7cb870021e974">DD4hep::Geometry::VolumeManagerObject::detMask</a></div><div class="ttdeci">VolumeID detMask</div><div class="ttdoc">Sub-detector mask. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00115">VolumeManagerInterna.h:115</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html">DD4hep::Geometry::VolumeManagerObject</a></div><div class="ttdoc">This structure describes the internal data of the volume manager object. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00089">VolumeManagerInterna.h:89</a></div></div>
<div class="ttc" id="_printout_8h_html"><div class="ttname"><a href="_printout_8h.html">Printout.h</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_context_html_a22e82a0219d1d0249ea2d1b034ef7264"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a22e82a0219d1d0249ea2d1b034ef7264">DD4hep::Geometry::VolumeManagerContext::identifier</a></div><div class="ttdeci">VolumeID identifier</div><div class="ttdoc">Placement identifier. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00058">VolumeManagerInterna.h:58</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value_html_a2a64900a949635b4d1bbefe5a61529c3"><div class="ttname"><a href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a2a64900a949635b4d1bbefe5a61529c3">DD4hep::DDSegmentation::BitFieldValue::width</a></div><div class="ttdeci">unsigned width() const</div><div class="ttdef"><b>Definition:</b> <a href="_d_d_segmentation_2include_2_d_d_segmentation_2_bit_field64_8h_source.html#l00269">BitField64.h:269</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value_html_a46fee9b58df6cfc614afdbf6e82e7e80"><div class="ttname"><a href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a46fee9b58df6cfc614afdbf6e82e7e80">DD4hep::DDSegmentation::BitFieldValue::value</a></div><div class="ttdeci">long64 value() const</div><div class="ttdef"><b>Definition:</b> <a href="_bit_field64_8cpp_source.html#l00056">BitField64.cpp:56</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_html_aa324bff4bb7c4e5a4575f81819d78d48"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume.html#aa324bff4bb7c4e5a4575f81819d78d48">DD4hep::Geometry::Volume::isSensitive</a></div><div class="ttdeci">bool isSensitive() const</div><div class="ttdoc">Accessor if volume is sensitive (ie. is attached to a sensitive detector) </div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8cpp_source.html#l00750">Volumes.cpp:750</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_readout_html_a3930f675f87469d26910268c3b7066ca"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_readout.html#a3930f675f87469d26910268c3b7066ca">DD4hep::Geometry::Readout::idSpec</a></div><div class="ttdeci">IDDescriptor idSpec() const</div><div class="ttdoc">Access IDDescription structure. </div><div class="ttdef"><b>Definition:</b> <a href="_readout_8cpp_source.html#l00110">Readout.cpp:110</a></div></div>
<div class="ttc" id="namespace_d_d4hep_html_a5b5a64d56252469451f2020a27d57d42aae10bc5a07787c36af0a4c9921b262d2"><div class="ttname"><a href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42aae10bc5a07787c36af0a4c9921b262d2">DD4hep::INFO</a></div><div class="ttdef"><b>Definition:</b> <a href="_printout_8h_source.html#l00048">Printout.h:48</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds_html_a858e0760f9968c77969014aa150c2933"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds.html#a858e0760f9968c77969014aa150c2933">DD4hep::Geometry::PlacedVolumeExtension::VolIDs::find</a></div><div class="ttdeci">std::vector&lt; VolID &gt;::const_iterator find(const std::string &amp;name) const</div><div class="ttdoc">Find entry. </div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8cpp_source.html#l00342">Volumes.cpp:342</a></div></div>
<div class="ttc" id="namespace_d_d4hep_html_ae77e9f3818be8d649b030c537e235efe"><div class="ttname"><a href="namespace_d_d4hep.html#ae77e9f3818be8d649b030c537e235efe">DD4hep::SensitiveDetector</a></div><div class="ttdeci">DD4hep::Geometry::SensitiveDetector SensitiveDetector</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_x_m_l_setup_8cpp_source.html#l00033">Geant4XMLSetup.cpp:33</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_handle_html_a6f165a9eec329d2d65172767b5f2777a"><div class="ttname"><a href="class_d_d4hep_1_1_handle.html#a6f165a9eec329d2d65172767b5f2777a">DD4hep::Handle::ptr</a></div><div class="ttdeci">T * ptr() const</div><div class="ttdoc">Access to the held object. </div><div class="ttdef"><b>Definition:</b> <a href="_handle_8h_source.html#l00149">Handle.h:149</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_det_element_html_a47782470bbe890c880a2824de6d1b547"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_det_element.html#a47782470bbe890c880a2824de6d1b547">DD4hep::Geometry::DetElement::type</a></div><div class="ttdeci">std::string type() const</div><div class="ttdoc">Access detector type (structure, tracker, calorimeter, etc.). </div><div class="ttdef"><b>Definition:</b> <a href="_detector_8cpp_source.html#l00090">Detector.cpp:90</a></div></div>
<div class="ttc" id="group___d_d4_h_e_p___g_e_o_m_e_t_r_y_html_ga40af83be6718bb8828a3d83dc7f8c930"><div class="ttname"><a href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga40af83be6718bb8828a3d83dc7f8c930">DD4hep::Ref_t</a></div><div class="ttdeci">Handle&lt; NamedObject &gt; Ref_t</div><div class="ttdoc">Default Ref_t definition describing named objects. </div><div class="ttdef"><b>Definition:</b> <a href="_handle_8h_source.html#l00176">Handle.h:176</a></div></div>
<div class="ttc" id="namespace_d_d4hep_html_a5b5a64d56252469451f2020a27d57d42a54d5c1b9254fdf017c456cb972d26f96"><div class="ttname"><a href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42a54d5c1b9254fdf017c456cb972d26f96">DD4hep::ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="_printout_8h_source.html#l00048">Printout.h:48</a></div></div>
<div class="ttc" id="_volume_manager_interna_8h_html"><div class="ttname"><a href="_volume_manager_interna_8h.html">VolumeManagerInterna.h</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_det_element_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_det_element.html">DD4hep::Geometry::DetElement</a></div><div class="ttdoc">Handle class describing a detector element. </div><div class="ttdef"><b>Definition:</b> <a href="_detector_8h_source.html#l00172">Detector.h:172</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html">DD4hep::Geometry::VolumeManager</a></div><div class="ttdoc">Class to support the retrieval of detector elements and volumes given a valid identifier. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_8h_source.html#l00070">VolumeManager.h:70</a></div></div>
<div class="ttc" id="_geant4_sensitive_detector_8cpp_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="_geant4_sensitive_detector_8cpp.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="_geant4_sensitive_detector_8cpp_source.html#l00030">Geant4SensitiveDetector.cpp:30</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds_html_a9328d0964ef092fd108679b2ecafd5b7"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds.html#a9328d0964ef092fd108679b2ecafd5b7">DD4hep::Geometry::PlacedVolumeExtension::VolIDs::Base</a></div><div class="ttdeci">std::vector&lt; VolID &gt; Base</div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8h_source.html#l00083">Volumes.h:83</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_context_html_aa29bc3744ae4aff1e6a504c2b758a37c"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#aa29bc3744ae4aff1e6a504c2b758a37c">DD4hep::Geometry::VolumeManagerContext::path</a></div><div class="ttdeci">Path path</div><div class="ttdoc">Path of placements to this sensitive volume. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00074">VolumeManagerInterna.h:74</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_handle_html_abef3218a7399500084fc290a711bf048"><div class="ttname"><a href="class_d_d4hep_1_1_handle.html#abef3218a7399500084fc290a711bf048">DD4hep::Handle::object</a></div><div class="ttdeci">Q &amp; object() const</div><div class="ttdoc">Access to an unrelated object type. </div><div class="ttdef"><b>Definition:</b> <a href="_handle_8h_source.html#l00161">Handle.h:161</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_context_html_a4b637a36900149ff3490731f62ca1d52"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_context.html#a4b637a36900149ff3490731f62ca1d52">DD4hep::Geometry::VolumeManagerContext::detector</a></div><div class="ttdeci">DetElement detector</div><div class="ttdoc">Handle to the subdetector element handle. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00064">VolumeManagerInterna.h:64</a></div></div>
<div class="ttc" id="namespace_d_d4hep_1_1_d_d_segmentation_html_a61a6833a18d1800bdef176595f83e3ba"><div class="ttname"><a href="namespace_d_d4hep_1_1_d_d_segmentation.html#a61a6833a18d1800bdef176595f83e3ba">DD4hep::DDSegmentation::VolumeID</a></div><div class="ttdeci">long long int VolumeID</div><div class="ttdef"><b>Definition:</b> <a href="_primitives_8h_source.html#l00035">Primitives.h:35</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_html_ab1f746b561c93be38bc7c6e66fc8ca8a"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ab1f746b561c93be38bc7c6e66fc8ca8a">DD4hep::Geometry::VolumeManager::VolumeID</a></div><div class="ttdeci">DD4hep::VolumeID VolumeID</div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_8h_source.html#l00072">VolumeManager.h:72</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_l_c_d_d_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html">DD4hep::Geometry::LCDD</a></div><div class="ttdoc">The main interface to the DD4hep detector description package. </div><div class="ttdef"><b>Definition:</b> <a href="_l_c_d_d_8h_source.html#l00091">LCDD.h:91</a></div></div>
<div class="ttc" id="namespacedd4hep_html_ac03364576705a245265d8ed6ea26b871"><div class="ttname"><a href="namespacedd4hep.html#ac03364576705a245265d8ed6ea26b871">dd4hep::second</a></div><div class="ttdeci">static const double second</div><div class="ttdef"><b>Definition:</b> <a href="_d_d4hep_units_8h_source.html#l00112">DD4hepUnits.h:112</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_det_element_html_afc41f63ac2a467f5077d1cca1292d580"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_det_element.html#afc41f63ac2a467f5077d1cca1292d580">DD4hep::Geometry::DetElement::Children</a></div><div class="ttdeci">std::map&lt; std::string, DetElement &gt; Children</div><div class="ttdef"><b>Definition:</b> <a href="_detector_8h_source.html#l00186">Detector.h:186</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_det_element_object_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_det_element_object.html">DD4hep::Geometry::DetElementObject</a></div><div class="ttdoc">Data class with properties of a detector element. </div><div class="ttdef"><b>Definition:</b> <a href="_detector_interna_8h_source.html#l00084">DetectorInterna.h:84</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_placed_volume_html_a13113feba33041cee2738730ab70a9fc"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a13113feba33041cee2738730ab70a9fc">DD4hep::Geometry::PlacedVolume::volume</a></div><div class="ttdeci">Volume volume() const</div><div class="ttdoc">Logical volume of this placement. </div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8cpp_source.html#l00390">Volumes.cpp:390</a></div></div>
<div class="ttc" id="namespace_d_d4hep_html_af8602b0b80e0c252cf28e5fbbc81abcc"><div class="ttname"><a href="namespace_d_d4hep.html#af8602b0b80e0c252cf28e5fbbc81abcc">DD4hep::except</a></div><div class="ttdeci">void except(const std::string &amp;src, const std::string &amp;fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="_printout_8cpp_source.html#l00197">Printout.cpp:197</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_handle_html_a7e69d51e089a24a1773603dfa3fe5eac"><div class="ttname"><a href="class_d_d4hep_1_1_handle.html#a7e69d51e089a24a1773603dfa3fe5eac">DD4hep::Handle::isValid</a></div><div class="ttdeci">bool isValid() const</div><div class="ttdoc">Check the validity of the object held by the handle. </div><div class="ttdef"><b>Definition:</b> <a href="_handle_8h_source.html#l00124">Handle.h:124</a></div></div>
<div class="ttc" id="namespace_d_d4hep_html_a6d434af620a49074f3d86d05a04b6073"><div class="ttname"><a href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">DD4hep::printout</a></div><div class="ttdeci">int printout(PrintLevel severity, const char *src, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="_printout_8cpp_source.html#l00091">Printout.cpp:91</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html_aff0c698fcc27fa3778734a5c5bd6074f"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#aff0c698fcc27fa3778734a5c5bd6074f">DD4hep::Geometry::VolumeManagerObject::managers</a></div><div class="ttdeci">Managers managers</div><div class="ttdoc">The volume managers for the individual subdetector elements. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00101">VolumeManagerInterna.h:101</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html_a34cf251ba79ecddf50f9fdaf50265968"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#a34cf251ba79ecddf50f9fdaf50265968">DD4hep::Geometry::VolumeManagerObject::id</a></div><div class="ttdeci">IDDescriptor id</div><div class="ttdoc">The ID descriptor object. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00107">VolumeManagerInterna.h:107</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_object_html_abe994d6c29e62e21c1fd2d2be21d041d"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager_object.html#abe994d6c29e62e21c1fd2d2be21d041d">DD4hep::Geometry::VolumeManagerObject::flags</a></div><div class="ttdeci">int flags</div><div class="ttdoc">Population flags. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_interna_8h_source.html#l00117">VolumeManagerInterna.h:117</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor_html"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html">DD4hep::Geometry::IDDescriptor</a></div><div class="ttdoc">Class implementing the ID encoding of detector response. </div><div class="ttdef"><b>Definition:</b> <a href="_i_d_descriptor_8h_source.html#l00040">IDDescriptor.h:40</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor_html_a9179d503a536eab536eef71b20904116"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_i_d_descriptor.html#a9179d503a536eab536eef71b20904116">DD4hep::Geometry::IDDescriptor::field</a></div><div class="ttdeci">Field field(const std::string &amp;field_name) const</div><div class="ttdoc">Get the field descriptor of one field by name. </div><div class="ttdef"><b>Definition:</b> <a href="_i_d_descriptor_8cpp_source.html#l00083">IDDescriptor.cpp:83</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value_html_a537266df448c372b64ea6c4f1185a4c5"><div class="ttname"><a href="class_d_d4hep_1_1_d_d_segmentation_1_1_bit_field_value.html#a537266df448c372b64ea6c4f1185a4c5">DD4hep::DDSegmentation::BitFieldValue::mask</a></div><div class="ttdeci">ulong64 mask() const</div><div class="ttdef"><b>Definition:</b> <a href="_d_d_segmentation_2include_2_d_d_segmentation_2_bit_field64_8h_source.html#l00275">BitField64.h:275</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_html_a094839ee3155de449a36ca927ec17d2d"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume.html#a094839ee3155de449a36ca927ec17d2d">DD4hep::Geometry::Volume::sensitiveDetector</a></div><div class="ttdeci">Ref_t sensitiveDetector() const</div><div class="ttdoc">Access to the handle to the sensitive detector. </div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8cpp_source.html#l00744">Volumes.cpp:744</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_det_element_html_ad54eb9f407346f0a5fdc84713df1e218"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_det_element.html#ad54eb9f407346f0a5fdc84713df1e218">DD4hep::Geometry::DetElement::callAtUpdate</a></div><div class="ttdeci">void callAtUpdate(unsigned int typ, Q *pointer, void(T::*pmf)(unsigned long typ, DetElement &amp;det, void *opt_par)) const</div><div class="ttdoc">Extend the detector element with an arbitrary callback. </div><div class="ttdef"><b>Definition:</b> <a href="_detector_8h_source.html#l00291">Detector.h:291</a></div></div>
<div class="ttc" id="_volumes_8cpp_html_a6fc379aaec47ce424b00d8ffda2a6c59"><div class="ttname"><a href="_volumes_8cpp.html#a6fc379aaec47ce424b00d8ffda2a6c59">m</a></div><div class="ttdeci">TGeoShape TGeoMedium * m</div><div class="ttdef"><b>Definition:</b> <a href="_volumes_8cpp_source.html#l00295">Volumes.cpp:295</a></div></div>
<div class="ttc" id="namespace_d_d4hep_1_1_simulation_html_a5f50c11f1a261ca45bb2e86ea6621083"><div class="ttname"><a href="namespace_d_d4hep_1_1_simulation.html#a5f50c11f1a261ca45bb2e86ea6621083">DD4hep::Simulation::IDDescriptor</a></div><div class="ttdeci">Geometry::IDDescriptor IDDescriptor</div><div class="ttdef"><b>Definition:</b> <a href="_l_c_i_o_conversions_8cpp_source.html#l00070">LCIOConversions.cpp:70</a></div></div>
<div class="ttc" id="class_d_d4hep_1_1_geometry_1_1_volume_manager_html_ae553c9b75d52a6ed8d38867fca2cf9a0"><div class="ttname"><a href="class_d_d4hep_1_1_geometry_1_1_volume_manager.html#ae553c9b75d52a6ed8d38867fca2cf9a0">DD4hep::Geometry::VolumeManager::_data</a></div><div class="ttdeci">Object &amp; _data() const</div><div class="ttdoc">Additional data accessor. </div><div class="ttdef"><b>Definition:</b> <a href="_volume_manager_8h_source.html#l00094">VolumeManager.h:94</a></div></div>
<div class="ttc" id="namespace_d_d4hep_html_a5b5a64d56252469451f2020a27d57d42a2c12bf245b6095423f62644ab1f5eedf"><div class="ttname"><a href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42a2c12bf245b6095423f62644ab1f5eedf">DD4hep::VERBOSE</a></div><div class="ttdef"><b>Definition:</b> <a href="_printout_8h_source.html#l00048">Printout.h:48</a></div></div>
</div><!-- fragment --></div><!-- contents -->

<hr class="footer"/><address class="footer"><small>
Generated on Mon Nov 14 2016 16:09:23 for DD4hep by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
