<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<!--BEGIN PROJECT_NAME--><title>DD4hep: DD4hep: /afs/cern.ch/user/m/mpetric/nightly_cppcheck/dd4hep/DDCore/src/Volumes.cpp Source File</title><!--END PROJECT_NAME-->
<!--BEGIN !PROJECT_NAME--><title>DD4hep: /afs/cern.ch/user/m/mpetric/nightly_cppcheck/dd4hep/DDCore/src/Volumes.cpp Source File</title><!--END !PROJECT_NAME-->
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="DD4hep.css" rel="stylesheet" type="text/css" />
$treeview
$search
$mathjax
</head>
<body>
<div id="top"><!-- do not remove this div! -->

<!--BEGIN TITLEAREA-->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 100px;">
  <!--BEGIN PROJECT_LOGO-->
  <td id="projectlogo"><img alt="Logo" src="../doc/LaTex/CERN-logo.png" height="72"/></td>
  <td id="projectlogo"><img alt="Logo" src="$projectlogo" height="72"/></td>
  <!--END PROJECT_LOGO-->
  <!--BEGIN PROJECT_NAME-->
  <td style="padding-left: 0.5em;">
   <!--BEGIN PROJECT_BRIEF--><div id="projectbrief">$projectbrief</div><!--END PROJECT_BRIEF-->
   <div id="projectname">DD4hep
   <!--BEGIN PROJECT_NUMBER-->&#160;<span id="projectnumber">Rev:exported</span><!--END PROJECT_NUMBER-->
   </div>
  </td>
  <!--END PROJECT_NAME-->
  <!--BEGIN !PROJECT_NAME-->
   <!--BEGIN PROJECT_BRIEF-->
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">$projectbrief</div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
  <!--BEGIN DISABLE_INDEX-->
   <!--BEGIN SEARCHENGINE-->
   <td>$searchbox</td>
   <!--END SEARCHENGINE-->
  <!--END DISABLE_INDEX-->
 </tr>
 </tbody>
</table>
</div>
<!--END TITLEAREA-->
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>/afs/cern.ch/user/m/mpetric/nightly_cppcheck/dd4hep/DDCore/src/Volumes.cpp</h1><a href="_volumes_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// $Id$</span>
<a name="l00002"></a>00002 <span class="comment">//==========================================================================</span>
<a name="l00003"></a>00003 <span class="comment">//  AIDA Detector description implementation for LCD</span>
<a name="l00004"></a>00004 <span class="comment">//--------------------------------------------------------------------------</span>
<a name="l00005"></a>00005 <span class="comment">// Copyright (C) Organisation europeenne pour la Recherche nucleaire (CERN)</span>
<a name="l00006"></a>00006 <span class="comment">// All rights reserved.</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">// For the licensing terms see $DD4hepINSTALL/LICENSE.</span>
<a name="l00009"></a>00009 <span class="comment">// For the list of contributors see $DD4hepINSTALL/doc/CREDITS.</span>
<a name="l00010"></a>00010 <span class="comment">//</span>
<a name="l00011"></a>00011 <span class="comment">// Author     : M.Frank</span>
<a name="l00012"></a>00012 <span class="comment">//</span>
<a name="l00013"></a>00013 <span class="comment">//==========================================================================</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="comment">// Framework include files</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="_l_c_d_d_8h.html">DD4hep/LCDD.h</a>&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;<a class="code" href="_printout_8h.html">DD4hep/Printout.h</a>&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;<a class="code" href="_instance_count_8h.html">DD4hep/InstanceCount.h</a>&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="_matrix_helpers_8h.html">DD4hep/MatrixHelpers.h</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="_objects_interna_8h.html">DD4hep/objects/ObjectsInterna.h</a>&quot;</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="comment">// ROOT include files</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;TColor.h&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;TGeoShape.h&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;TGeoVolume.h&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;TGeoNode.h&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;TGeoMatrix.h&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;TGeoMedium.h&quot;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;TGeoVoxelFinder.h&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;TGeoShapeAssembly.h&quot;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="comment">// C/C++ include files</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;climits&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;stdexcept&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="keyword">using namespace </span>std;
<a name="l00040"></a>00040 <span class="keyword">using namespace </span>DD4hep::Geometry;
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="preprocessor">#ifdef DD4HEP_EMULATE_TGEOEXTENSIONS</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="keyword">namespace </span>DD4hep {
<a name="l00044"></a>00044   <span class="keyword">namespace </span>Geometry {
<a name="l00045"></a>00045 
<a name="l00046"></a>00046     <span class="keyword">struct </span>DDExtension  {
<a name="l00047"></a>00047       <a class="code" href="class_t_geo_extension.html" title="Class of the ROOT toolkit. See http://root.cern.ch/root/htmldoc/ClassIndex.html.">TGeoExtension</a>* m_extension;
<a name="l00048"></a>00048       DDExtension() : m_extension(0) {}
<a name="l00049"></a>00049       DDExtension(<span class="keyword">const</span> DDExtension&amp; c) : m_extension(0) {
<a name="l00050"></a>00050         <span class="keywordflow">if</span> ( c.m_extension ) m_extension = c.m_extension-&gt;Grab();
<a name="l00051"></a>00051       }
<a name="l00052"></a>00052       <span class="keyword">virtual</span> ~DDExtension() {
<a name="l00053"></a>00053         <span class="keywordflow">if</span> ( m_extension ) m_extension-&gt;Release();
<a name="l00054"></a>00054       }
<a name="l00055"></a>00055       DDExtension&amp; operator=(<span class="keyword">const</span> DDExtension&amp; c) {
<a name="l00056"></a>00056         <span class="keywordflow">if</span> ( <span class="keyword">this</span> != &amp;c ) SetUserExtension(c.GetUserExtension());
<a name="l00057"></a>00057         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00058"></a>00058       }
<a name="l00059"></a>00059       <span class="keywordtype">void</span> SetUserExtension(<a class="code" href="class_t_geo_extension.html" title="Class of the ROOT toolkit. See http://root.cern.ch/root/htmldoc/ClassIndex.html.">TGeoExtension</a> *ext)  {
<a name="l00060"></a>00060         <span class="keywordflow">if</span> (m_extension) m_extension-&gt;Release();
<a name="l00061"></a>00061         m_extension = 0;
<a name="l00062"></a>00062         <span class="keywordflow">if</span> (ext) m_extension = ext-&gt;<a class="code" href="class_t_geo_extension.html#addd8a323d93527519b94e2db3acbf9d5" title="TGeoExtension overload: Method called whenever requiring a pointer to the extension...">Grab</a>();
<a name="l00063"></a>00063       }
<a name="l00064"></a>00064       <a class="code" href="class_t_geo_extension.html" title="Class of the ROOT toolkit. See http://root.cern.ch/root/htmldoc/ClassIndex.html.">TGeoExtension</a>* GetUserExtension()<span class="keyword"> const  </span>{
<a name="l00065"></a>00065         <span class="keywordflow">return</span> m_extension;
<a name="l00066"></a>00066       }
<a name="l00067"></a>00067     };
<a name="l00068"></a>00068     <span class="keyword">struct </span>DD_TGeoNodeMatrix : <span class="keyword">public</span> TGeoNodeMatrix, <span class="keyword">public</span> DDExtension  {
<a name="l00069"></a>00069     <span class="keyword">private</span>:
<a name="l00070"></a>00070       DD_TGeoNodeMatrix&amp; operator=(<span class="keyword">const</span> DD_TGeoNodeMatrix&amp;) { <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00071"></a>00071     <span class="keyword">public</span>:
<a name="l00072"></a>00072       DD_TGeoNodeMatrix(<span class="keyword">const</span> TGeoVolume* <a class="code" href="_multi_view_8cpp.html#a8320ee13ac034dbf6d624fe8953dd337">v</a>, <span class="keyword">const</span> TGeoMatrix* <a class="code" href="namespacedd4hep.html#a443d1517e365c8f0c3a498bff0f09088">m</a>)
<a name="l00073"></a>00073         : TGeoNodeMatrix(v, m), DDExtension() {
<a name="l00074"></a>00074         <a class="code" href="_d_d4hep_2config_8h.html#a75d64779ae4a2116dcda0a332bcb5f9e">INCREMENT_COUNTER</a>;
<a name="l00075"></a>00075       }
<a name="l00076"></a>00076       DD_TGeoNodeMatrix(<span class="keyword">const</span> DD_TGeoNodeMatrix&amp; c)
<a name="l00077"></a>00077         : TGeoNodeMatrix(c.GetVolume(), c.GetMatrix()), DDExtension(c) {
<a name="l00078"></a>00078         <a class="code" href="_d_d4hep_2config_8h.html#a75d64779ae4a2116dcda0a332bcb5f9e">INCREMENT_COUNTER</a>;
<a name="l00079"></a>00079       }
<a name="l00080"></a>00080       <span class="keyword">virtual</span> ~DD_TGeoNodeMatrix() {
<a name="l00081"></a>00081         <a class="code" href="_d_d4hep_2config_8h.html#ab1be71398be7aa3d9544068de11384c3">DECREMENT_COUNTER</a>;
<a name="l00082"></a>00082       }
<a name="l00083"></a>00083       <span class="keyword">virtual</span> TGeoNode *MakeCopyNode()<span class="keyword"> const </span>{
<a name="l00084"></a>00084         TGeoNodeMatrix *node = <span class="keyword">new</span> DD_TGeoNodeMatrix(*<span class="keyword">this</span>);
<a name="l00085"></a>00085         node-&gt;SetName(this-&gt;<a class="code" href="namespace_d_d4hep_1_1_utilities.html#a966a7057d7655c50273dc41d229ae315">TGeoNodeMatrix::GetName</a>());
<a name="l00086"></a>00086         <span class="comment">// set the mother</span>
<a name="l00087"></a>00087         node-&gt;SetMotherVolume(fMother);
<a name="l00088"></a>00088         <span class="comment">// set the copy number</span>
<a name="l00089"></a>00089         node-&gt;SetNumber(fNumber);
<a name="l00090"></a>00090         <span class="comment">// copy overlaps</span>
<a name="l00091"></a>00091         <span class="keywordflow">if</span> (fNovlp &gt; 0) {
<a name="l00092"></a>00092           <span class="keywordflow">if</span> (fOverlaps) {
<a name="l00093"></a>00093             Int_t *ovlps = <span class="keyword">new</span> Int_t[fNovlp];
<a name="l00094"></a>00094             memcpy(ovlps, fOverlaps, fNovlp * <span class="keyword">sizeof</span>(Int_t));
<a name="l00095"></a>00095             node-&gt;SetOverlaps(ovlps, fNovlp);
<a name="l00096"></a>00096           }
<a name="l00097"></a>00097           <span class="keywordflow">else</span> {
<a name="l00098"></a>00098             node-&gt;SetOverlaps(fOverlaps, fNovlp);
<a name="l00099"></a>00099           }
<a name="l00100"></a>00100         }
<a name="l00101"></a>00101         <span class="comment">// copy VC</span>
<a name="l00102"></a>00102         <span class="keywordflow">if</span> (IsVirtual())
<a name="l00103"></a>00103           node-&gt;SetVirtual();
<a name="l00104"></a>00104         <span class="keywordflow">return</span> node;
<a name="l00105"></a>00105       }
<a name="l00106"></a>00106     };
<a name="l00107"></a>00107 
<a name="l00108"></a>00108     <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">struct </span>_VolWrap: <span class="keyword">public</span> <a class="code" href="class_t.html">T</a>, <span class="keyword">public</span> DDExtension {
<a name="l00109"></a>00109     <span class="keyword">public</span>:
<a name="l00110"></a>00110       _VolWrap(<span class="keyword">const</span> <span class="keywordtype">char</span>* name) : <a class="code" href="class_t.html">T</a>(name), DDExtension() {
<a name="l00111"></a>00111         <a class="code" href="_d_d4hep_2config_8h.html#a75d64779ae4a2116dcda0a332bcb5f9e">INCREMENT_COUNTER</a>;
<a name="l00112"></a>00112       }
<a name="l00113"></a>00113       <span class="keyword">virtual</span> ~_VolWrap() {
<a name="l00114"></a>00114         <a class="code" href="_d_d4hep_2config_8h.html#ab1be71398be7aa3d9544068de11384c3">DECREMENT_COUNTER</a>;
<a name="l00115"></a>00115       }
<a name="l00116"></a>00116       <span class="keyword">virtual</span> <span class="keywordtype">void</span> AddNode(<span class="keyword">const</span> TGeoVolume *vol, Int_t copy_no, TGeoMatrix *mat, Option_t* = <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00117"></a>00117         TGeoMatrix *matrix = mat;
<a name="l00118"></a>00118         <span class="keywordflow">if</span> (matrix == 0)
<a name="l00119"></a>00119           matrix = gGeoIdentity;
<a name="l00120"></a>00120         <span class="keywordflow">else</span>
<a name="l00121"></a>00121           matrix-&gt;RegisterYourself();
<a name="l00122"></a>00122         <span class="keywordflow">if</span> (!vol) {
<a name="l00123"></a>00123           this-&gt;T::Error(<span class="stringliteral">&quot;AddNode&quot;</span>, <span class="stringliteral">&quot;Volume is NULL&quot;</span>);
<a name="l00124"></a>00124           <span class="keywordflow">return</span>;
<a name="l00125"></a>00125         }
<a name="l00126"></a>00126         <span class="keywordflow">if</span> (!vol-&gt;IsValid()) {
<a name="l00127"></a>00127           this-&gt;T::Error(<span class="stringliteral">&quot;AddNode&quot;</span>, <span class="stringliteral">&quot;Won&apos;t add node with invalid shape&quot;</span>);
<a name="l00128"></a>00128           printf(<span class="stringliteral">&quot;### invalid volume was : %s\n&quot;</span>, vol-&gt;GetName());
<a name="l00129"></a>00129           <span class="keywordflow">return</span>;
<a name="l00130"></a>00130         }
<a name="l00131"></a>00131         <span class="keywordflow">if</span> (!this-&gt;T::fNodes)
<a name="l00132"></a>00132           this-&gt;T::fNodes = <span class="keyword">new</span> TObjArray();
<a name="l00133"></a>00133 
<a name="l00134"></a>00134         <span class="keywordflow">if</span> (this-&gt;T::fFinder) {
<a name="l00135"></a>00135           <span class="comment">// volume already divided.</span>
<a name="l00136"></a>00136           this-&gt;T::Error(<span class="stringliteral">&quot;AddNode&quot;</span>, <span class="stringliteral">&quot;Cannot add node %s_%i into divided volume %s&quot;</span>, vol-&gt;GetName(), copy_no,
<a name="l00137"></a>00137                          this-&gt;<a class="code" href="namespace_d_d4hep_1_1_utilities.html#a966a7057d7655c50273dc41d229ae315">T::GetName</a>());
<a name="l00138"></a>00138           <span class="keywordflow">return</span>;
<a name="l00139"></a>00139         }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141         TGeoNodeMatrix *node = <span class="keyword">new</span> DD_TGeoNodeMatrix(vol, matrix);
<a name="l00142"></a>00142         <span class="comment">//node = new TGeoNodeMatrix(vol, matrix);</span>
<a name="l00143"></a>00143         node-&gt;SetMotherVolume(<span class="keyword">this</span>);
<a name="l00144"></a>00144         this-&gt;T::fNodes-&gt;Add(node);
<a name="l00145"></a>00145         TString name = TString::Format(<span class="stringliteral">&quot;%s_%d&quot;</span>, vol-&gt;GetName(), copy_no);
<a name="l00146"></a>00146         <span class="keywordflow">if</span> (this-&gt;T::fNodes-&gt;FindObject(name))
<a name="l00147"></a>00147           this-&gt;T::Warning(<span class="stringliteral">&quot;AddNode&quot;</span>, <span class="stringliteral">&quot;Volume %s : added node %s with same name&quot;</span>, this-&gt;<a class="code" href="namespace_d_d4hep_1_1_utilities.html#a966a7057d7655c50273dc41d229ae315">T::GetName</a>(), name.Data());
<a name="l00148"></a>00148         node-&gt;SetName(name);
<a name="l00149"></a>00149         node-&gt;SetNumber(copy_no);
<a name="l00150"></a>00150       }
<a name="l00151"></a>00151     };
<a name="l00152"></a>00152 
<a name="l00153"></a>00153     <span class="keyword">template</span> &lt;&gt; _VolWrap&lt;TGeoVolume&gt;::_VolWrap(<span class="keyword">const</span> <span class="keywordtype">char</span>* name) : TGeoVolume(name,0,0), DDExtension() {
<a name="l00154"></a>00154       <a class="code" href="_d_d4hep_2config_8h.html#a75d64779ae4a2116dcda0a332bcb5f9e">INCREMENT_COUNTER</a>;
<a name="l00155"></a>00155     }
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <span class="keyword">struct </span>TGeoVolumeValue : <span class="keyword">public</span> _VolWrap&lt;TGeoVolume&gt; {
<a name="l00158"></a>00158       TGeoVolumeValue(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, TGeoShape* <a class="code" href="_volumes_8cpp.html#a17ca6bfc8040d695d3cada22a4763d40">s</a>, TGeoMedium* <a class="code" href="namespacedd4hep.html#a443d1517e365c8f0c3a498bff0f09088">m</a>) : _VolWrap&lt;TGeoVolume&gt;(name) {
<a name="l00159"></a>00159         SetShape(s);
<a name="l00160"></a>00160         SetMedium(m);
<a name="l00161"></a>00161       }
<a name="l00162"></a>00162       <span class="keyword">virtual</span> ~TGeoVolumeValue() {      }
<a name="l00163"></a>00163       TGeoVolume *_copyVol(TGeoShape *newshape)<span class="keyword"> const </span>{
<a name="l00164"></a>00164         TGeoVolumeValue *vol = <span class="keyword">new</span> TGeoVolumeValue(this-&gt;<a class="code" href="namespace_d_d4hep_1_1_utilities.html#a966a7057d7655c50273dc41d229ae315">TGeoVolume::GetName</a>(),newshape,fMedium);
<a name="l00165"></a>00165         <span class="keywordflow">if</span> ( m_extension ) vol-&gt;m_extension = m_extension-&gt;Grab();
<a name="l00166"></a>00166         <span class="comment">//vol-&gt;copy(*this);</span>
<a name="l00167"></a>00167         <span class="keywordflow">return</span> vol;
<a name="l00168"></a>00168       }
<a name="l00169"></a>00169       <span class="keyword">virtual</span> TGeoVolume* MakeCopyVolume(TGeoShape *newshape) {
<a name="l00170"></a>00170         <span class="comment">// make a copy of this volume. build a volume with same name, shape and medium</span>
<a name="l00171"></a>00171         TGeoVolume *vol = _copyVol(newshape);
<a name="l00172"></a>00172         vol-&gt;SetVisibility(IsVisible());
<a name="l00173"></a>00173         vol-&gt;SetLineColor(GetLineColor());
<a name="l00174"></a>00174         vol-&gt;SetLineStyle(GetLineStyle());
<a name="l00175"></a>00175         vol-&gt;SetLineWidth(GetLineWidth());
<a name="l00176"></a>00176         vol-&gt;SetFillColor(GetFillColor());
<a name="l00177"></a>00177         vol-&gt;SetFillStyle(GetFillStyle());
<a name="l00178"></a>00178         vol-&gt;SetField(fField);
<a name="l00179"></a>00179         <span class="keywordflow">if</span> (fFinder)
<a name="l00180"></a>00180           vol-&gt;SetFinder(fFinder);
<a name="l00181"></a>00181         CloneNodesAndConnect(vol);
<a name="l00182"></a>00182         ((<a class="code" href="class_t_object.html" title="Class of the ROOT toolkit. See http://root.cern.ch/root/htmldoc/ClassIndex.html.">TObject</a>*) vol)-&gt;SetBit(kVolumeClone);
<a name="l00183"></a>00183         <span class="keywordflow">return</span> vol;
<a name="l00184"></a>00184       }
<a name="l00185"></a>00185       <span class="keyword">virtual</span> TGeoVolume* CloneVolume()<span class="keyword"> const </span>{
<a name="l00186"></a>00186         TGeoVolume *vol = _copyVol(fShape);
<a name="l00187"></a>00187         Int_t i;
<a name="l00188"></a>00188         <span class="comment">// copy volume attributes</span>
<a name="l00189"></a>00189         vol-&gt;SetLineColor(GetLineColor());
<a name="l00190"></a>00190         vol-&gt;SetLineStyle(GetLineStyle());
<a name="l00191"></a>00191         vol-&gt;SetLineWidth(GetLineWidth());
<a name="l00192"></a>00192         vol-&gt;SetFillColor(GetFillColor());
<a name="l00193"></a>00193         vol-&gt;SetFillStyle(GetFillStyle());
<a name="l00194"></a>00194         <span class="comment">// copy other attributes</span>
<a name="l00195"></a>00195         Int_t nbits = 8 * <span class="keyword">sizeof</span>(UInt_t);
<a name="l00196"></a>00196         <span class="keywordflow">for</span> (i = 0; i &lt; nbits; i++)
<a name="l00197"></a>00197           vol-&gt;SetAttBit(1 &lt;&lt; i, TGeoAtt::TestAttBit(1 &lt;&lt; i));
<a name="l00198"></a>00198         <span class="keywordflow">for</span> (i = 14; i &lt; 24; i++)
<a name="l00199"></a>00199           vol-&gt;SetBit(1 &lt;&lt; i, this-&gt;TGeoVolume::TestBit(1 &lt;&lt; i));
<a name="l00200"></a>00200 
<a name="l00201"></a>00201         <span class="comment">// copy field</span>
<a name="l00202"></a>00202         vol-&gt;SetField(fField);
<a name="l00203"></a>00203         <span class="comment">// Set bits</span>
<a name="l00204"></a>00204         <span class="keywordflow">for</span> (i = 0; i &lt; nbits; i++)
<a name="l00205"></a>00205           vol-&gt;SetBit(1 &lt;&lt; i, this-&gt;TGeoVolume::TestBit(1 &lt;&lt; i));
<a name="l00206"></a>00206         vol-&gt;SetBit(kVolumeClone);
<a name="l00207"></a>00207         <span class="comment">// copy nodes</span>
<a name="l00208"></a>00208         <span class="comment">//   CloneNodesAndConnect(vol);</span>
<a name="l00209"></a>00209         vol-&gt;MakeCopyNodes(<span class="keyword">this</span>);
<a name="l00210"></a>00210         <span class="comment">// if volume is divided, copy finder</span>
<a name="l00211"></a>00211         vol-&gt;SetFinder(fFinder);
<a name="l00212"></a>00212         <span class="comment">// copy voxels</span>
<a name="l00213"></a>00213         <span class="keywordflow">if</span> (fVoxels) {
<a name="l00214"></a>00214           TGeoVoxelFinder *voxels = <span class="keyword">new</span> TGeoVoxelFinder(vol);
<a name="l00215"></a>00215           vol-&gt;SetVoxelFinder(voxels);
<a name="l00216"></a>00216         }
<a name="l00217"></a>00217         <span class="comment">// copy option, uid</span>
<a name="l00218"></a>00218         vol-&gt;SetOption(fOption);
<a name="l00219"></a>00219         vol-&gt;SetNumber(fNumber);
<a name="l00220"></a>00220         vol-&gt;SetNtotal(fNtotal);
<a name="l00221"></a>00221         <span class="keywordflow">return</span> vol;
<a name="l00222"></a>00222       }
<a name="l00223"></a>00223     };
<a name="l00224"></a>00224 
<a name="l00225"></a>00225     <span class="keyword">struct </span>TGeoVolumeAssemblyValue : <span class="keyword">public</span> _VolWrap&lt;TGeoVolumeAssembly&gt;  {
<a name="l00226"></a>00226       TGeoVolumeAssemblyValue(<span class="keyword">const</span> <span class="keywordtype">char</span>* name) : _VolWrap&lt;TGeoVolumeAssembly&gt;(name) {
<a name="l00227"></a>00227       }
<a name="l00228"></a>00228       <span class="keyword">virtual</span> ~TGeoVolumeAssemblyValue() {
<a name="l00229"></a>00229       }
<a name="l00230"></a>00230       TGeoVolume *CloneVolume()<span class="keyword"> const </span>{
<a name="l00231"></a>00231         TGeoVolumeAssemblyValue *vol = <span class="keyword">new</span> TGeoVolumeAssemblyValue(this-&gt;<a class="code" href="namespace_d_d4hep_1_1_utilities.html#a966a7057d7655c50273dc41d229ae315">TGeoVolume::GetName</a>());
<a name="l00232"></a>00232         <span class="keywordflow">if</span> ( m_extension ) vol-&gt;m_extension = m_extension-&gt;Grab();
<a name="l00233"></a>00233         Int_t i;
<a name="l00234"></a>00234         <span class="comment">// copy other attributes</span>
<a name="l00235"></a>00235         Int_t nbits = 8 * <span class="keyword">sizeof</span>(UInt_t);
<a name="l00236"></a>00236         <span class="keywordflow">for</span> (i = 0; i &lt; nbits; i++)
<a name="l00237"></a>00237           vol-&gt;SetAttBit(1 &lt;&lt; i, TGeoAtt::TestAttBit(1 &lt;&lt; i));
<a name="l00238"></a>00238         <span class="keywordflow">for</span> (i = 14; i &lt; 24; i++)
<a name="l00239"></a>00239           vol-&gt;SetBit(1 &lt;&lt; i, this-&gt;TGeoVolumeAssembly::TestBit(1 &lt;&lt; i));
<a name="l00240"></a>00240 
<a name="l00241"></a>00241         <span class="comment">// copy field</span>
<a name="l00242"></a>00242         vol-&gt;SetField(fField);
<a name="l00243"></a>00243         <span class="comment">// Set bits</span>
<a name="l00244"></a>00244         <span class="keywordflow">for</span> (i = 0; i &lt; nbits; i++)
<a name="l00245"></a>00245           vol-&gt;SetBit(1 &lt;&lt; i, this-&gt;TGeoVolumeAssembly::TestBit(1 &lt;&lt; i));
<a name="l00246"></a>00246         vol-&gt;SetBit(kVolumeClone);
<a name="l00247"></a>00247         <span class="comment">// make copy nodes</span>
<a name="l00248"></a>00248         vol-&gt;MakeCopyNodes(<span class="keyword">this</span>);
<a name="l00249"></a>00249         ((TGeoShapeAssembly*) vol-&gt;GetShape())-&gt;NeedsBBoxRecompute();
<a name="l00250"></a>00250         <span class="comment">// copy voxels</span>
<a name="l00251"></a>00251         <span class="keywordflow">if</span> (fVoxels) {
<a name="l00252"></a>00252           TGeoVoxelFinder *voxels = <span class="keyword">new</span> TGeoVoxelFinder(vol);
<a name="l00253"></a>00253           vol-&gt;SetVoxelFinder(voxels);
<a name="l00254"></a>00254         }
<a name="l00255"></a>00255         <span class="comment">// copy option, uid</span>
<a name="l00256"></a>00256         vol-&gt;SetOption(fOption);
<a name="l00257"></a>00257         vol-&gt;SetNumber(fNumber);
<a name="l00258"></a>00258         vol-&gt;SetNtotal(fNtotal);
<a name="l00259"></a>00259         <span class="keywordflow">return</span> vol;
<a name="l00260"></a>00260       }
<a name="l00261"></a>00261     };
<a name="l00262"></a>00262 
<a name="l00263"></a>00263   }
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 <span class="keyword">typedef</span> DD_TGeoNodeMatrix       <a class="code" href="_volumes_8cpp.html#a83f3b66b11096c206d134e70c9103a8e">geo_node_t</a>;
<a name="l00266"></a>00266 <span class="keyword">typedef</span> TGeoVolumeValue         <a class="code" href="_volumes_8cpp.html#a6369702c0bd3a63eeb1ccda4c5fd2885">geo_volume_t</a>;
<a name="l00267"></a>00267 <span class="keyword">typedef</span> TGeoVolumeAssemblyValue <a class="code" href="_volumes_8cpp.html#afd56328e7bf39593ed2be452748b766a">geo_assembly_t</a>;
<a name="l00268"></a>00268 
<a name="l00269"></a>00269 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">static</span> <span class="keyword">typename</span> T::Object* <a class="code" href="_volumes_8cpp.html#a1c1cde892e7b9b8d7ff4c77fb2b7aa34">_userExtension</a>(<span class="keyword">const</span> <a class="code" href="class_t.html">T</a>&amp; <a class="code" href="_multi_view_8cpp.html#a8320ee13ac034dbf6d624fe8953dd337">v</a>)  {
<a name="l00270"></a>00270   <span class="keyword">typedef</span> <span class="keyword">typename</span> T::Object O;
<a name="l00271"></a>00271   <span class="keyword">const</span> DDExtension* p = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>DDExtension*<span class="keyword">&gt;</span>(v.ptr());
<a name="l00272"></a>00272   O* o = (O*)(p ? p-&gt;GetUserExtension() : 0);
<a name="l00273"></a>00273   <span class="keywordflow">return</span> o;
<a name="l00274"></a>00274 }
<a name="l00275"></a>00275 <span class="preprocessor">#else</span>
<a name="l00276"></a>00276 <span class="preprocessor"></span>
<a name="l00277"></a>00277 <span class="comment">/*</span>
<a name="l00278"></a>00278 <span class="comment"> *  The section below uses the new ROOT features using user extensions to volumes</span>
<a name="l00279"></a>00279 <span class="comment"> *  and placements. Once this is common, the above mechanism should be thrown away....</span>
<a name="l00280"></a>00280 <span class="comment"> *</span>
<a name="l00281"></a>00281 <span class="comment"> *  M.Frank</span>
<a name="l00282"></a>00282 <span class="comment"> */</span>
<a name="l00283"></a>00283 
<a name="l00284"></a><a class="code" href="_volumes_8cpp.html#a83f3b66b11096c206d134e70c9103a8e">00284</a> <span class="keyword">typedef</span> TGeoNode                geo_node_t;
<a name="l00285"></a><a class="code" href="_volumes_8cpp.html#a6369702c0bd3a63eeb1ccda4c5fd2885">00285</a> <span class="keyword">typedef</span> TGeoVolume              geo_volume_t;
<a name="l00286"></a><a class="code" href="_volumes_8cpp.html#afd56328e7bf39593ed2be452748b766a">00286</a> <span class="keyword">typedef</span> TGeoVolumeAssembly      geo_assembly_t;
<a name="l00287"></a><a class="code" href="_volumes_8cpp.html#a1c1cde892e7b9b8d7ff4c77fb2b7aa34">00287</a> <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">static</span> <span class="keyword">typename</span> T::Object* <a class="code" href="_volumes_8cpp.html#a1c1cde892e7b9b8d7ff4c77fb2b7aa34">_userExtension</a>(<span class="keyword">const</span> <a class="code" href="class_t.html">T</a>&amp; v)  {
<a name="l00288"></a>00288   <span class="keyword">typedef</span> <span class="keyword">typename</span> T::Object O;
<a name="l00289"></a>00289   O* o = (O*)(v.ptr()-&gt;GetUserExtension());
<a name="l00290"></a>00290   <span class="keywordflow">return</span> o;
<a name="l00291"></a>00291 }
<a name="l00292"></a>00292 <span class="preprocessor">#endif</span>
<a name="l00293"></a>00293 <span class="preprocessor"></span><a class="code" href="_volumes_8cpp.html#ae43a2b26233111b60dfa2908b387adbb">ClassImp</a>(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html" title="Implementation class extending the ROOT placed volume.">PlacedVolumeExtension</a>)
<a name="l00294"></a>00294 
<a name="l00295"></a><a class="code" href="_volumes_8cpp.html#a17ca6bfc8040d695d3cada22a4763d40">00295</a> static TGeoVolume* _createTGeoVolume(const <span class="keywordtype">string</span>&amp; name, TGeoShape* <a class="code" href="_volumes_8cpp.html#a17ca6bfc8040d695d3cada22a4763d40">s</a>, TGeoMedium* <a class="code" href="namespacedd4hep.html#a443d1517e365c8f0c3a498bff0f09088">m</a>)  {
<a name="l00296"></a>00296   geo_volume_t* e = <span class="keyword">new</span> <a class="code" href="_volumes_8cpp.html#a6369702c0bd3a63eeb1ccda4c5fd2885">geo_volume_t</a>(name.c_str(),s,m);
<a name="l00297"></a>00297   e-&gt;SetUserExtension(<span class="keyword">new</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">Volume::Object</a>());
<a name="l00298"></a>00298   <span class="keywordflow">return</span> e;
<a name="l00299"></a>00299 }
<a name="l00300"></a>00300 <span class="keyword">static</span> TGeoVolume* _createTGeoVolumeAssembly(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name)  {
<a name="l00301"></a>00301   geo_assembly_t* e = <span class="keyword">new</span> <a class="code" href="_volumes_8cpp.html#afd56328e7bf39593ed2be452748b766a">geo_assembly_t</a>(name.c_str()); <span class="comment">// It is important to use the correct constructor!!</span>
<a name="l00302"></a>00302   e-&gt;SetUserExtension(<span class="keyword">new</span> Assembly::Object());
<a name="l00303"></a>00303   <span class="keywordflow">return</span> e;
<a name="l00304"></a>00304 }
<a name="l00305"></a>00305 
<a name="l00307"></a>00307 PlacedVolumeExtension::PlacedVolumeExtension()
<a name="l00308"></a><a class="code" href="_volumes_8cpp.html#a51575e459f2c9dab072bf1246119db2a">00308</a>   : <a class="code" href="class_t_geo_extension.html" title="Class of the ROOT toolkit. See http://root.cern.ch/root/htmldoc/ClassIndex.html.">TGeoExtension</a>(), <a class="code" href="_volumes_8cpp.html#ace6d22343ef2267c6169252783997419">magic</a>(0), <a class="code" href="_volumes_8cpp.html#a196c28143d6edfa2a06de0e72638dde5">refCount</a>(0), <a class="code" href="_volumes_8cpp.html#a51575e459f2c9dab072bf1246119db2a">volIDs</a>() {
<a name="l00309"></a>00309   <a class="code" href="_volumes_8cpp.html#ace6d22343ef2267c6169252783997419">magic</a> = <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga2410a636084da38b545f3774a04705be" title="Access to the magic word, which is protecting some objects against memory corruptions...">magic_word</a>();
<a name="l00310"></a>00310   <a class="code" href="_d_d4hep_2config_8h.html#a75d64779ae4a2116dcda0a332bcb5f9e">INCREMENT_COUNTER</a>;
<a name="l00311"></a>00311 }
<a name="l00312"></a>00312 
<a name="l00314"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#ae6ed2e13f9d86072e773573b7d710e1b">00314</a> PlacedVolumeExtension::PlacedVolumeExtension(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html" title="Implementation class extending the ROOT placed volume.">PlacedVolumeExtension</a>&amp; c)
<a name="l00315"></a>00315   : <a class="code" href="class_t_geo_extension.html" title="Class of the ROOT toolkit. See http://root.cern.ch/root/htmldoc/ClassIndex.html.">TGeoExtension</a>(), <a class="code" href="_volumes_8cpp.html#ace6d22343ef2267c6169252783997419">magic</a>(c.<a class="code" href="_volumes_8cpp.html#ace6d22343ef2267c6169252783997419">magic</a>), <a class="code" href="_volumes_8cpp.html#a196c28143d6edfa2a06de0e72638dde5">refCount</a>(0), <a class="code" href="_volumes_8cpp.html#a51575e459f2c9dab072bf1246119db2a">volIDs</a>(c.<a class="code" href="_volumes_8cpp.html#a51575e459f2c9dab072bf1246119db2a">volIDs</a>) {
<a name="l00316"></a>00316   <a class="code" href="_d_d4hep_2config_8h.html#a75d64779ae4a2116dcda0a332bcb5f9e">INCREMENT_COUNTER</a>;
<a name="l00317"></a>00317 }
<a name="l00318"></a>00318 
<a name="l00320"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#a99c666d418ebb75722ab794442169d72">00320</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#a99c666d418ebb75722ab794442169d72" title="Default destructor.">PlacedVolumeExtension::~PlacedVolumeExtension</a>() {
<a name="l00321"></a>00321   <a class="code" href="_d_d4hep_2config_8h.html#ab1be71398be7aa3d9544068de11384c3">DECREMENT_COUNTER</a>;
<a name="l00322"></a>00322 }
<a name="l00323"></a>00323 
<a name="l00325"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#aa5261b49a18fba980e00d96161db3855">00325</a> <a class="code" href="class_t_geo_extension.html" title="Class of the ROOT toolkit. See http://root.cern.ch/root/htmldoc/ClassIndex.html.">TGeoExtension</a>* <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#aa5261b49a18fba980e00d96161db3855" title="TGeoExtension overload: Method called whenever requiring a pointer to the extension...">PlacedVolumeExtension::Grab</a>()   {
<a name="l00326"></a>00326   ++this-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#a4feb981d8c7a9cfdd75e525ee0cfd527" title="Reference count on object (used to implement Grab/Release).">refCount</a>;
<a name="l00327"></a>00327 <span class="preprocessor">#ifdef ___print_vols</span>
<a name="l00328"></a>00328 <span class="preprocessor"></span>  <span class="keywordflow">else</span>  cout &lt;&lt; <span class="stringliteral">&quot;Placement grabbed.....&quot;</span> &lt;&lt; endl;
<a name="l00329"></a>00329 <span class="preprocessor">#endif</span>
<a name="l00330"></a>00330 <span class="preprocessor"></span>  <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00331"></a>00331 }
<a name="l00332"></a>00332 
<a name="l00334"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#a92e8b1e394a8aa6dd5ccb94f30c58318">00334</a> <span class="keywordtype">void</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#a92e8b1e394a8aa6dd5ccb94f30c58318" title="TGeoExtension overload: Method called always when the pointer to the extension is...">PlacedVolumeExtension::Release</a>()<span class="keyword"> const  </span>{
<a name="l00335"></a>00335   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html" title="Implementation class extending the ROOT placed volume.">PlacedVolumeExtension</a>* ext = <span class="keyword">const_cast&lt;</span><a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html" title="Implementation class extending the ROOT placed volume.">PlacedVolumeExtension</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);
<a name="l00336"></a>00336   --ext-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#a4feb981d8c7a9cfdd75e525ee0cfd527" title="Reference count on object (used to implement Grab/Release).">refCount</a>;
<a name="l00337"></a>00337   <span class="keywordflow">if</span> ( 0 == ext-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#a4feb981d8c7a9cfdd75e525ee0cfd527" title="Reference count on object (used to implement Grab/Release).">refCount</a> ) <span class="keyword">delete</span> ext;
<a name="l00338"></a>00338 }
<a name="l00339"></a>00339 
<a name="l00341"></a>00341 <a class="code" href="classstd_1_1vector.html">vector&lt;PlacedVolumeExtension::VolID&gt;::const_iterator</a>
<a name="l00342"></a>00342 <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds.html#ab81a867b54e328f612c96d4b92edeb50" title="Find entry.">PlacedVolumeExtension::VolIDs::find</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name)<span class="keyword"> const </span>{
<a name="l00343"></a>00343   <span class="keywordflow">for</span> (Base::const_iterator i = this-&gt;Base::begin(); i != this-&gt;Base::end(); ++i)
<a name="l00344"></a>00344     <span class="keywordflow">if</span> (name == (*i).first)
<a name="l00345"></a>00345       <span class="keywordflow">return</span> i;
<a name="l00346"></a>00346   <span class="keywordflow">return</span> this-&gt;end();
<a name="l00347"></a>00347 }
<a name="l00348"></a>00348 
<a name="l00350"></a>00350 std::pair&lt;vector&lt;PlacedVolumeExtension::VolID&gt;::iterator, <span class="keywordtype">bool</span>&gt;
<a name="l00351"></a>00351 <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds.html#a2902573e21128ccbe7ca2ec2b51c89d5" title="Inert new entry.">PlacedVolumeExtension::VolIDs::insert</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name, <span class="keywordtype">int</span> value) {
<a name="l00352"></a>00352   Base::iterator i = this-&gt;Base::begin();
<a name="l00353"></a>00353   <span class="keywordflow">for</span> (; i != this-&gt;Base::end(); ++i)
<a name="l00354"></a>00354     <span class="keywordflow">if</span> (name == (*i).first)
<a name="l00355"></a>00355       <span class="keywordflow">break</span>;
<a name="l00356"></a>00356   <span class="comment">//</span>
<a name="l00357"></a>00357   <span class="keywordflow">if</span> (i != this-&gt;Base::end()) {
<a name="l00358"></a>00358     <span class="keywordflow">return</span> make_pair(i, <span class="keyword">false</span>);
<a name="l00359"></a>00359   }
<a name="l00360"></a>00360   i = this-&gt;Base::insert(this-&gt;Base::end(), make_pair(name, value));
<a name="l00361"></a>00361   <span class="keywordflow">return</span> make_pair(i, <span class="keyword">true</span>);
<a name="l00362"></a>00362 }
<a name="l00363"></a>00363 
<a name="l00364"></a><a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">00364</a> <span class="keyword">static</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html" title="Implementation class extending the ROOT placed volume.">PlacedVolume::Object</a>* <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html" title="Handle class holding a placed volume (also called physical volume).">PlacedVolume</a>&amp; v) {
<a name="l00365"></a>00365   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html" title="Implementation class extending the ROOT placed volume.">PlacedVolume::Object</a>* o = <a class="code" href="_volumes_8cpp.html#a1c1cde892e7b9b8d7ff4c77fb2b7aa34">_userExtension</a>(v);
<a name="l00366"></a>00366   <span class="keywordflow">if</span> (o)
<a name="l00367"></a>00367     <span class="keywordflow">return</span> o;
<a name="l00368"></a>00368   <span class="keywordflow">throw</span> <a class="code" href="classstd_1_1runtime__error.html">runtime_error</a>(<span class="stringliteral">&quot;DD4hep: Attempt to access invalid handle of type: PlacedVolume&quot;</span>);
<a name="l00369"></a>00369 }
<a name="l00370"></a>00370 
<a name="l00372"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#ac13225b8f8408419cc0dd096f59cc934">00372</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html" title="Implementation class extending the ROOT placed volume.">PlacedVolume::Object</a>* <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#ac13225b8f8408419cc0dd096f59cc934" title="Check if placement is properly instrumented.">PlacedVolume::data</a>()<span class="keyword"> const   </span>{
<a name="l00373"></a>00373   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html" title="Implementation class extending the ROOT placed volume.">PlacedVolume::Object</a>* o = <a class="code" href="_volumes_8cpp.html#a1c1cde892e7b9b8d7ff4c77fb2b7aa34">_userExtension</a>(*<span class="keyword">this</span>);
<a name="l00374"></a>00374   <span class="keywordflow">return</span> o;
<a name="l00375"></a>00375 }
<a name="l00376"></a>00376 
<a name="l00378"></a>00378 <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html" title="Handle class holding a placed volume (also called physical volume).">PlacedVolume</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a461228a5c2a8347d0445d64a351e117a" title="Add identifier.">PlacedVolume::addPhysVolID</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; nam, <span class="keywordtype">int</span> value) {
<a name="l00379"></a>00379   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a9ae505098ca6976164b959e1d8b4bbb0">Object</a>* obj = <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(*<span class="keyword">this</span>);
<a name="l00380"></a>00380   obj-&gt;volIDs.push_back(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#aaecde4f8feb863af7cd36c1213bfabe4">VolID</a>(nam, value));
<a name="l00381"></a>00381   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00382"></a>00382 }
<a name="l00383"></a>00383 
<a name="l00385"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a15e211be65f8a1eacb9c2abcb21d27f7">00385</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_material.html" title="Handle class describing a material.">Material</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a15e211be65f8a1eacb9c2abcb21d27f7" title="Volume material.">PlacedVolume::material</a>()<span class="keyword"> const </span>{
<a name="l00386"></a>00386   <span class="keywordflow">return</span> <a class="code" href="class_d_d4hep_1_1_handle.html#a3d9df9d5b334e984b288ffbabcacb564" title="Declaration of &amp;#39;self&amp;#39;.">Material::handle_t</a>(<a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a> ? <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;GetMedium() : 0);
<a name="l00387"></a>00387 }
<a name="l00388"></a>00388 
<a name="l00390"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a7896af4481e228014289900a8943a7da">00390</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a7896af4481e228014289900a8943a7da" title="Logical volume of this placement.">PlacedVolume::volume</a>()<span class="keyword"> const </span>{
<a name="l00391"></a>00391   <span class="keywordflow">return</span> <a class="code" href="class_d_d4hep_1_1_handle.html#a3d9df9d5b334e984b288ffbabcacb564" title="Declaration of &amp;#39;self&amp;#39;.">Volume::handle_t</a>(<a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a> ? <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;GetVolume() : 0);
<a name="l00392"></a>00392 }
<a name="l00393"></a>00393 
<a name="l00395"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#add53ed67151813db86d2a26a8184d14d">00395</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#add53ed67151813db86d2a26a8184d14d" title="Parent volume (envelope).">PlacedVolume::motherVol</a>()<span class="keyword"> const </span>{
<a name="l00396"></a>00396   <span class="keywordflow">return</span> <a class="code" href="class_d_d4hep_1_1_handle.html#a3d9df9d5b334e984b288ffbabcacb564" title="Declaration of &amp;#39;self&amp;#39;.">Volume::handle_t</a>(<a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a> ? <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;GetMotherVolume() : 0);
<a name="l00397"></a>00397 }
<a name="l00398"></a>00398 
<a name="l00400"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#af7478d475c0719d37ebadc8d18ba12ba">00400</a> <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension_1_1_vol_i_ds.html" title="Volume ID container.">PlacedVolume::VolIDs</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#af7478d475c0719d37ebadc8d18ba12ba" title="Access to the volume IDs.">PlacedVolume::volIDs</a>()<span class="keyword"> const </span>{
<a name="l00401"></a>00401   <span class="keywordflow">return</span> <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(*this)-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#ad5f78671de81a717b16fdefd5483b153" title="ID container.">volIDs</a>;
<a name="l00402"></a>00402 }
<a name="l00403"></a>00403 
<a name="l00405"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a0eb030432fb329dcae65b2996c09324b">00405</a> <span class="keywordtype">string</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html#a0eb030432fb329dcae65b2996c09324b" title="String dump.">PlacedVolume::toString</a>()<span class="keyword"> const </span>{
<a name="l00406"></a>00406   stringstream <a class="code" href="_volumes_8cpp.html#a17ca6bfc8040d695d3cada22a4763d40">s</a>;
<a name="l00407"></a>00407   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html" title="Implementation class extending the ROOT placed volume.">Object</a>* obj = <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(*<span class="keyword">this</span>);
<a name="l00408"></a>00408   s &lt;&lt; <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;GetName() &lt;&lt; <span class="stringliteral">&quot;:  vol=&apos;&quot;</span> &lt;&lt; <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;GetVolume()-&gt;GetName() &lt;&lt; <span class="stringliteral">&quot;&apos; mat:&apos;&quot;</span> &lt;&lt; <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;GetMatrix()-&gt;GetName()
<a name="l00409"></a>00409     &lt;&lt; <span class="stringliteral">&quot;&apos; volID[&quot;</span> &lt;&lt; obj-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#ad5f78671de81a717b16fdefd5483b153" title="ID container.">volIDs</a>.size() &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;
<a name="l00410"></a>00410   <span class="keywordflow">for</span> (VolIDs::const_iterator i = obj-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#ad5f78671de81a717b16fdefd5483b153" title="ID container.">volIDs</a>.begin(); i != obj-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html#ad5f78671de81a717b16fdefd5483b153" title="ID container.">volIDs</a>.end(); ++i)
<a name="l00411"></a>00411     s &lt;&lt; (*i).first &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; (*i).second &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;
<a name="l00412"></a>00412   s &lt;&lt; ends;
<a name="l00413"></a>00413   <span class="keywordflow">return</span> s.str();
<a name="l00414"></a>00414 }
<a name="l00415"></a>00415 
<a name="l00417"></a><a class="code" href="_volumes_8cpp.html#a35bfc969417fc823e2baec3e10bdcdfd">00417</a> <a class="code" href="_volumes_8cpp.html#ae43a2b26233111b60dfa2908b387adbb">ClassImp</a>(<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">VolumeExtension</a>)
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 
<a name="l00420"></a>00420 <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">VolumeExtension</a>::<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">VolumeExtension</a>()
<a name="l00421"></a>00421 : <a class="code" href="class_t_geo_extension.html" title="Class of the ROOT toolkit. See http://root.cern.ch/root/htmldoc/ClassIndex.html.">TGeoExtension</a>(), <a class="code" href="_volumes_8cpp.html#ace6d22343ef2267c6169252783997419">magic</a>(0), <a class="code" href="_volumes_8cpp.html#a196c28143d6edfa2a06de0e72638dde5">refCount</a>(0), region(), limits(), vis(), sens_det(), referenced(0) {
<a name="l00422"></a>00422   <a class="code" href="_d_d4hep_2config_8h.html#a75d64779ae4a2116dcda0a332bcb5f9e">INCREMENT_COUNTER</a>;
<a name="l00423"></a>00423 }
<a name="l00424"></a>00424 
<a name="l00426"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#a86b8adbb7fefd161d386f958db8b9be4">00426</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#a86b8adbb7fefd161d386f958db8b9be4" title="Default destructor.">VolumeExtension::~VolumeExtension</a>() {
<a name="l00427"></a>00427   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#ac4303caba2a748fd25e8c986c8001096" title="Region reference.">region</a>.<a class="code" href="class_d_d4hep_1_1_handle.html#ad50d0ea67a1c9a4e87d232f96ebe52f1" title="Release the object held by the handle.">clear</a>();
<a name="l00428"></a>00428   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#a2197ef0277ad4fdebc1a285ec311d019" title="Limit sets used for simulation.">limits</a>.<a class="code" href="class_d_d4hep_1_1_handle.html#ad50d0ea67a1c9a4e87d232f96ebe52f1" title="Release the object held by the handle.">clear</a>();
<a name="l00429"></a>00429   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#ae4a19cb963f258f84a6fa871e8b6f4c1" title="Reference to visualization attributes.">vis</a>.<a class="code" href="class_d_d4hep_1_1_handle.html#ad50d0ea67a1c9a4e87d232f96ebe52f1" title="Release the object held by the handle.">clear</a>();
<a name="l00430"></a>00430   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#a3b0ac7f31e5c962f0eb479c24d4c72ea" title="Reference to the sensitive detector.">sens_det</a>.clear();
<a name="l00431"></a>00431   <a class="code" href="_d_d4hep_2config_8h.html#ab1be71398be7aa3d9544068de11384c3">DECREMENT_COUNTER</a>;
<a name="l00432"></a>00432 }
<a name="l00433"></a>00433 
<a name="l00435"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#adc072e1c3a4be273940579938c6be398">00435</a> <a class="code" href="class_t_geo_extension.html" title="Class of the ROOT toolkit. See http://root.cern.ch/root/htmldoc/ClassIndex.html.">TGeoExtension</a>* <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#adc072e1c3a4be273940579938c6be398" title="TGeoExtension overload: Method called whenever requiring a pointer to the extension...">VolumeExtension::Grab</a>()  {
<a name="l00436"></a>00436   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">VolumeExtension</a>* ext = <span class="keyword">const_cast&lt;</span><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">VolumeExtension</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);
<a name="l00437"></a>00437   ++ext-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#a604559432eb0145b52013c5105a2566b" title="Reference count on object (used to implement Grab/Release).">refCount</a>;
<a name="l00438"></a>00438 <span class="preprocessor">#ifdef ___print_vols</span>
<a name="l00439"></a>00439 <span class="preprocessor"></span>  <span class="keywordflow">if</span> ( ext-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#a3b0ac7f31e5c962f0eb479c24d4c72ea" title="Reference to the sensitive detector.">sens_det</a>.isValid() )
<a name="l00440"></a>00440     cout &lt;&lt; <span class="stringliteral">&quot;Volume grabbed with valid sensitive detector.....&quot;</span> &lt;&lt; endl;
<a name="l00441"></a>00441   <span class="keywordflow">else</span>
<a name="l00442"></a>00442     cout &lt;&lt; <span class="stringliteral">&quot;Volume grabbed.....&quot;</span> &lt;&lt; endl;
<a name="l00443"></a>00443 <span class="preprocessor">#endif</span>
<a name="l00444"></a>00444 <span class="preprocessor"></span>  <span class="keywordflow">return</span> ext;
<a name="l00445"></a>00445 }
<a name="l00446"></a>00446 
<a name="l00448"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#ad61d398432c27ba62103ba5daa1d431d">00448</a> <span class="keywordtype">void</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#ad61d398432c27ba62103ba5daa1d431d" title="TGeoExtension overload: Method called always when the pointer to the extension is...">VolumeExtension::Release</a>()<span class="keyword"> const  </span>{
<a name="l00449"></a>00449   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">VolumeExtension</a>* ext = <span class="keyword">const_cast&lt;</span><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">VolumeExtension</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);
<a name="l00450"></a>00450   --ext-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#a604559432eb0145b52013c5105a2566b" title="Reference count on object (used to implement Grab/Release).">refCount</a>;
<a name="l00451"></a>00451   <span class="keywordflow">if</span> ( 0 == ext-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#a604559432eb0145b52013c5105a2566b" title="Reference count on object (used to implement Grab/Release).">refCount</a> )   {
<a name="l00452"></a>00452 <span class="preprocessor">#ifdef ___print_vols</span>
<a name="l00453"></a>00453 <span class="preprocessor"></span>    cout &lt;&lt; <span class="stringliteral">&quot;Volume deleted.....&quot;</span> &lt;&lt; endl;
<a name="l00454"></a>00454 <span class="preprocessor">#endif</span>
<a name="l00455"></a>00455 <span class="preprocessor"></span>    <span class="keyword">delete</span> ext;
<a name="l00456"></a>00456   }
<a name="l00457"></a>00457   <span class="keywordflow">else</span>  {
<a name="l00458"></a>00458 <span class="preprocessor">#ifdef ___print_vols</span>
<a name="l00459"></a>00459 <span class="preprocessor"></span>    cout &lt;&lt; <span class="stringliteral">&quot;VolumeExtension::Release::refCount:&quot;</span> &lt;&lt; ext-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#a604559432eb0145b52013c5105a2566b" title="Reference count on object (used to implement Grab/Release).">refCount</a> &lt;&lt; endl;
<a name="l00460"></a>00460 <span class="preprocessor">#endif</span>
<a name="l00461"></a>00461 <span class="preprocessor"></span>  }
<a name="l00462"></a>00462 }
<a name="l00463"></a>00463 
<a name="l00465"></a><a class="code" href="_volumes_8cpp.html#af67cc7a88abe7fe25fba4ef71c57782b">00465</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">Volume::Object</a>* <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; v, <span class="keywordtype">bool</span> throw_exception = <span class="keyword">true</span>) {
<a name="l00466"></a>00466   <span class="comment">//if ( v.ptr() &amp;&amp; v.ptr()-&gt;IsA() == TGeoVolume::Class() ) return v.data&lt;Volume::Object&gt;();</span>
<a name="l00467"></a>00467   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">Volume::Object</a>* o = <a class="code" href="_volumes_8cpp.html#a1c1cde892e7b9b8d7ff4c77fb2b7aa34">_userExtension</a>(v);
<a name="l00468"></a>00468   <span class="keywordflow">if</span> (o)
<a name="l00469"></a>00469     <span class="keywordflow">return</span> o;
<a name="l00470"></a>00470   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!throw_exception)
<a name="l00471"></a>00471     <span class="keywordflow">return</span> 0;
<a name="l00472"></a>00472   <span class="keywordflow">throw</span> <a class="code" href="classstd_1_1runtime__error.html">runtime_error</a>(<span class="stringliteral">&quot;DD4hep: Attempt to access invalid handle of type: PlacedVolume&quot;</span>);
<a name="l00473"></a>00473 }
<a name="l00474"></a>00474 
<a name="l00476"></a>00476 <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5e8cfa8694162b1e3be9401e64667370" title="Default constructor.">Volume::Volume</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; nam) {
<a name="l00477"></a>00477   <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a> = _createTGeoVolume(nam,0,0);
<a name="l00478"></a>00478 }
<a name="l00479"></a>00479 
<a name="l00481"></a>00481 <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5e8cfa8694162b1e3be9401e64667370" title="Default constructor.">Volume::Volume</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; nam, <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_solid__type.html" title="Base class for Solid (shape) objects.">Solid</a>&amp; <a class="code" href="_volumes_8cpp.html#a17ca6bfc8040d695d3cada22a4763d40">s</a>, <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_material.html" title="Handle class describing a material.">Material</a>&amp; <a class="code" href="namespacedd4hep.html#a443d1517e365c8f0c3a498bff0f09088">m</a>) {
<a name="l00482"></a>00482   <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a> = _createTGeoVolume(nam,s.<a class="code" href="class_d_d4hep_1_1_handle.html#a51a7d12a15a2a18977a0036bc6435cc8" title="Access to the held object.">ptr</a>(),m.<a class="code" href="class_d_d4hep_1_1_handle.html#a51a7d12a15a2a18977a0036bc6435cc8" title="Access to the held object.">ptr</a>());
<a name="l00483"></a>00483 }
<a name="l00484"></a>00484 
<a name="l00486"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aca15c04f667b12b142a300070c9b99ca">00486</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">Volume::Object</a>* <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aca15c04f667b12b142a300070c9b99ca" title="Check if placement is properly instrumented.">Volume::data</a>()<span class="keyword"> const   </span>{
<a name="l00487"></a>00487   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">Volume::Object</a>* o = <a class="code" href="_volumes_8cpp.html#a1c1cde892e7b9b8d7ff4c77fb2b7aa34">_userExtension</a>(*<span class="keyword">this</span>);
<a name="l00488"></a>00488   <span class="keywordflow">return</span> o;
<a name="l00489"></a>00489 }
<a name="l00490"></a>00490 
<a name="l00491"></a><a class="code" href="_volumes_8cpp.html#a17c6076661d5cf9623f4754f19fae1eb">00491</a> <span class="keyword">static</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html" title="Handle class holding a placed volume (also called physical volume).">PlacedVolume</a> <a class="code" href="_volumes_8cpp.html#a17c6076661d5cf9623f4754f19fae1eb">_addNode</a>(TGeoVolume* par, TGeoVolume* daughter, TGeoMatrix* transform) {
<a name="l00492"></a>00492   <span class="keywordflow">if</span> ( !daughter )   {
<a name="l00493"></a>00493     <span class="keywordflow">throw</span> <a class="code" href="classstd_1_1runtime__error.html">runtime_error</a>(<span class="stringliteral">&quot;DD4hep: Volume: Attempt to assign an invalid physical daughter volume.&quot;</span>);
<a name="l00494"></a>00494   }
<a name="l00495"></a>00495   TGeoVolume* parent = par;
<a name="l00496"></a>00496   TObjArray* a = parent-&gt;GetNodes();
<a name="l00497"></a>00497   Int_t <span class="keywordtype">id</span> = a ? a-&gt;GetEntries() : 0;
<a name="l00498"></a>00498   <span class="keywordflow">if</span> (transform &amp;&amp; transform != <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#gacb7266110e19d4dda6cc6b2ebc57bd39" title="Access the TGeo identity transformation \.">identityTransform</a>()) {
<a name="l00499"></a>00499     <span class="keywordtype">string</span> nam = <a class="code" href="classstd_1_1string.html">string</a>(daughter-&gt;GetName()) + <span class="stringliteral">&quot;_placement&quot;</span>;
<a name="l00500"></a>00500     transform-&gt;SetName(nam.c_str());
<a name="l00501"></a>00501   }
<a name="l00502"></a>00502   TGeoShape* shape = daughter-&gt;GetShape();
<a name="l00503"></a>00503   <span class="comment">// Need to fix the daughter&apos;s BBox of assemblies, if the BBox was not calculated....</span>
<a name="l00504"></a>00504   <span class="keywordflow">if</span> ( shape-&gt;IsA() == TGeoShapeAssembly::Class() )  {
<a name="l00505"></a>00505     TGeoShapeAssembly* as = (TGeoShapeAssembly*)shape;
<a name="l00506"></a>00506     <span class="keywordflow">if</span> ( std::fabs(as-&gt;GetDX()) &lt; numeric_limits&lt;double&gt;::epsilon() &amp;&amp;
<a name="l00507"></a>00507          std::fabs(as-&gt;GetDY()) &lt; numeric_limits&lt;double&gt;::epsilon() &amp;&amp;
<a name="l00508"></a>00508          std::fabs(as-&gt;GetDZ()) &lt; numeric_limits&lt;double&gt;::epsilon() )  {
<a name="l00509"></a>00509       as-&gt;NeedsBBoxRecompute();
<a name="l00510"></a>00510       as-&gt;ComputeBBox();
<a name="l00511"></a>00511     }
<a name="l00512"></a>00512   }
<a name="l00513"></a>00513   parent-&gt;AddNode(daughter, <span class="keywordtype">id</span>, transform);
<a name="l00514"></a>00514   geo_node_t* n = <span class="keyword">static_cast&lt;</span>geo_node_t*<span class="keyword">&gt;</span>(parent-&gt;GetNode(<span class="keywordtype">id</span>));
<a name="l00515"></a>00515   n-&gt;geo_node_t::SetUserExtension(<span class="keyword">new</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume_extension.html" title="Implementation class extending the ROOT placed volume.">PlacedVolume::Object</a>());
<a name="l00516"></a>00516   <span class="keywordflow">return</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html" title="Handle class holding a placed volume (also called physical volume).">PlacedVolume</a>(n);
<a name="l00517"></a>00517 }
<a name="l00518"></a>00518 
<a name="l00520"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a6dc8c06bdc867360d95e4db2ce71a471">00520</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html" title="Handle class holding a placed volume (also called physical volume).">PlacedVolume</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a61a47d1aa7dfeb411f663d7425aad1e6" title="Place daughter volume. The position and rotation are the identity.">Volume::placeVolume</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; volume, <span class="keyword">const</span> <a class="code" href="namespace_d_d4hep_1_1_geometry.html#aeb4c0356d12fd7be49a0aae50514e64b">Transform3D</a>&amp; trans)<span class="keyword"> const </span>{
<a name="l00521"></a>00521   <span class="keywordflow">return</span> <a class="code" href="_volumes_8cpp.html#a17c6076661d5cf9623f4754f19fae1eb">_addNode</a>(<a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>, volume, <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga01d65a905944a17404358ea0116d4dd3" title="Convert a Transform3D object to a TGeoHMatrix \.">_transform</a>(trans));
<a name="l00522"></a>00522 }
<a name="l00523"></a>00523 
<a name="l00525"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a61a47d1aa7dfeb411f663d7425aad1e6">00525</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html" title="Handle class holding a placed volume (also called physical volume).">PlacedVolume</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a61a47d1aa7dfeb411f663d7425aad1e6" title="Place daughter volume. The position and rotation are the identity.">Volume::placeVolume</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; volume)<span class="keyword"> const </span>{
<a name="l00526"></a>00526   <span class="keywordflow">return</span> <a class="code" href="_volumes_8cpp.html#a17c6076661d5cf9623f4754f19fae1eb">_addNode</a>(<a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>, volume, <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#gacb7266110e19d4dda6cc6b2ebc57bd39" title="Access the TGeo identity transformation \.">identityTransform</a>());
<a name="l00527"></a>00527 }
<a name="l00528"></a>00528 
<a name="l00530"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aeee43002378b1a0332d6b0ccdf4969b9">00530</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html" title="Handle class holding a placed volume (also called physical volume).">PlacedVolume</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a61a47d1aa7dfeb411f663d7425aad1e6" title="Place daughter volume. The position and rotation are the identity.">Volume::placeVolume</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; volume, <span class="keyword">const</span> <a class="code" href="namespace_d_d4hep_1_1_geometry.html#a55083902099d03506c6db01b80404900">Position</a>&amp; pos)<span class="keyword"> const </span>{
<a name="l00531"></a>00531   <span class="keywordflow">return</span> <a class="code" href="_volumes_8cpp.html#a17c6076661d5cf9623f4754f19fae1eb">_addNode</a>(<a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>, volume, <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga2a9c214ef0a2444cccf194669fe81771" title="Convert a Position object to a TGeoTranslation \.">_translation</a>(pos));
<a name="l00532"></a>00532 }
<a name="l00533"></a>00533 
<a name="l00535"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a26ca4b9a6bebdb8d6f8245ac64296f28">00535</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html" title="Handle class holding a placed volume (also called physical volume).">PlacedVolume</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a61a47d1aa7dfeb411f663d7425aad1e6" title="Place daughter volume. The position and rotation are the identity.">Volume::placeVolume</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; volume, <span class="keyword">const</span> <a class="code" href="namespace_d_d4hep_1_1_geometry.html#a24667b2b9c3cec3d5239828db4d52189">RotationZYX</a>&amp; rot)<span class="keyword"> const </span>{
<a name="l00536"></a>00536   <span class="keywordflow">return</span> <a class="code" href="_volumes_8cpp.html#a17c6076661d5cf9623f4754f19fae1eb">_addNode</a>(<a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>, volume, <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#gac468c0a81631e0a1c052094131f9d680" title="Convert a RotationZYX object to a TGeoRotation \.">_rotationZYX</a>(rot));
<a name="l00537"></a>00537 }
<a name="l00538"></a>00538 
<a name="l00540"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5087814789bfdbf06b46b2569191a9c6">00540</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_placed_volume.html" title="Handle class holding a placed volume (also called physical volume).">PlacedVolume</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a61a47d1aa7dfeb411f663d7425aad1e6" title="Place daughter volume. The position and rotation are the identity.">Volume::placeVolume</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; volume, <span class="keyword">const</span> <a class="code" href="namespace_d_d4hep_1_1_geometry.html#a022fecb763315fa2bf39cbb648944a0e">Rotation3D</a>&amp; rot)<span class="keyword"> const </span>{
<a name="l00541"></a>00541   <span class="keywordflow">return</span> <a class="code" href="_volumes_8cpp.html#a17c6076661d5cf9623f4754f19fae1eb">_addNode</a>(<a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>, volume, <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga1dc4cc8b92d11d2fc874ed142c7b1bbc" title="Convert a Rotation3D object to a TGeoRotation \.">_rotation3D</a>(rot));
<a name="l00542"></a>00542 }
<a name="l00543"></a>00543 
<a name="l00545"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a65caa62ff7fbf16f38cb85af994944c7">00545</a> <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a65caa62ff7fbf16f38cb85af994944c7" title="Set the volume&amp;#39;s material.">Volume::setMaterial</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_material.html" title="Handle class describing a material.">Material</a>&amp; m)<span class="keyword"> const </span>{
<a name="l00546"></a>00546   <span class="keywordflow">if</span> (m.<a class="code" href="class_d_d4hep_1_1_handle.html#a4c5293aecb11989a708ec7615d0f0842" title="Check the validity of the object held by the handle.">isValid</a>()) {
<a name="l00547"></a>00547     TGeoMedium* medium = m.<a class="code" href="class_d_d4hep_1_1_handle.html#a72866c3c06a9e008cc390b7a1ef859e7" title="Access to an unrelated object type.">_ptr</a>&lt;TGeoMedium&gt;();
<a name="l00548"></a>00548     <span class="keywordflow">if</span> (medium) {
<a name="l00549"></a>00549       <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetMedium(medium);
<a name="l00550"></a>00550       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00551"></a>00551     }
<a name="l00552"></a>00552     <span class="keywordflow">throw</span> <a class="code" href="classstd_1_1runtime__error.html">runtime_error</a>(<span class="stringliteral">&quot;DD4hep: Volume: Medium &quot;</span> + <span class="keywordtype">string</span>(m.<a class="code" href="class_d_d4hep_1_1_handle.html#a9c62b8d37e0f2354bae0093498dc15a1" title="Access the object name (or &amp;quot;&amp;quot; if not supported by the object).">name</a>()) + <span class="stringliteral">&quot; is not registered with geometry manager.&quot;</span>);
<a name="l00553"></a>00553   }
<a name="l00554"></a>00554   <span class="keywordflow">throw</span> <a class="code" href="classstd_1_1runtime__error.html">runtime_error</a>(<span class="stringliteral">&quot;DD4hep: Volume: Attempt to assign invalid material.&quot;</span>);
<a name="l00555"></a>00555 }
<a name="l00556"></a>00556 
<a name="l00558"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#ab27715df3e7b1b8f36ca802e6d894005">00558</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_material.html" title="Handle class describing a material.">Material</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#ab27715df3e7b1b8f36ca802e6d894005" title="Access to the Volume material.">Volume::material</a>()<span class="keyword"> const </span>{
<a name="l00559"></a>00559   <span class="keywordflow">return</span> <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga40af83be6718bb8828a3d83dc7f8c930" title="Default Ref_t definition describing named objects.">Ref_t</a>(<a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;GetMedium());
<a name="l00560"></a>00560 }
<a name="l00561"></a>00561 
<a name="l00562"></a>00562 <span class="preprocessor">#include &quot;TROOT.h&quot;</span>
<a name="l00563"></a>00563 
<a name="l00565"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5db10a2a883d77b2654fe1875d5d7bb5">00565</a> <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5db10a2a883d77b2654fe1875d5d7bb5" title="Set Visualization attributes to the volume.">Volume::setVisAttributes</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr.html" title="Handle class describing visualization attributes.">VisAttr</a>&amp; attr)<span class="keyword"> const </span>{
<a name="l00566"></a>00566   <span class="keywordflow">if</span> (attr.<a class="code" href="class_d_d4hep_1_1_handle.html#a4c5293aecb11989a708ec7615d0f0842" title="Check the validity of the object held by the handle.">isValid</a>()) {
<a name="l00567"></a>00567     <a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html" title="Concrete object implementation of the VisAttr Handle.">VisAttr::Object</a>* vis = attr.<a class="code" href="class_d_d4hep_1_1_handle.html#a821fe41f46aa5ce97cfb04a6a60e5cd5" title="Access to an unrelated object type.">data</a>&lt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html" title="Concrete object implementation of the VisAttr Handle.">VisAttr::Object</a>&gt;();
<a name="l00568"></a>00568     Color_t bright = vis-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html#a1bff0c73a37bb6791006a4f0761d9f3a">color</a>;<span class="comment">//kBlue;//TColor::GetColorBright(vis-&gt;color);</span>
<a name="l00569"></a>00569     Color_t dark = vis-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html#a1bff0c73a37bb6791006a4f0761d9f3a">color</a>;<span class="comment">//kRed;//TColor::GetColorDark(vis-&gt;color);</span>
<a name="l00570"></a>00570     TColor* c = vis-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html#a5ac12c903f90e8cf16eb04ba55568f38">col</a>;<span class="comment">//gROOT-&gt;GetColor(dark);</span>
<a name="l00571"></a>00571     <span class="keywordtype">int</span> draw_style = vis-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html#ac6a253b99e112880c1ef727f9b9f9e73">drawingStyle</a>;
<a name="l00572"></a>00572     <span class="keywordtype">int</span> line_style = vis-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html#aaede923ed352bb5f43a809f6943f2061">lineStyle</a>;
<a name="l00573"></a>00573 
<a name="l00574"></a>00574     <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetVisibility(vis-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html#a316d66f51e43f6601839b271072a4765">visible</a> ? kTRUE : kFALSE);
<a name="l00575"></a>00575     <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetVisContainers(kTRUE);
<a name="l00576"></a>00576     <span class="comment">//m_element-&gt;SetAttBit(TGeoAtt::kVisContainers, kTRUE);</span>
<a name="l00577"></a>00577     <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetVisDaughters(vis-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html#a7fc2c6d4195f0c8524315272a81436e6">showDaughters</a> ? kTRUE : kFALSE);
<a name="l00578"></a>00578     <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42ad22cda76fc1b3a55bc359945db9c811c">DEBUG</a>,<span class="stringliteral">&quot;setVisAttributes&quot;</span>,
<a name="l00579"></a>00579              <span class="stringliteral">&quot;Set color %3d [%02X,%02X,%02X] DrawingStyle:%9s LineStyle:%6s for volume %s&quot;</span>,
<a name="l00580"></a>00580              <span class="keywordtype">int</span>(vis-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html#a1bff0c73a37bb6791006a4f0761d9f3a">color</a>),
<a name="l00581"></a>00581              c ? <span class="keywordtype">int</span>(255*c-&gt;GetRed()) : 0xFF,
<a name="l00582"></a>00582              c ? <span class="keywordtype">int</span>(255*c-&gt;GetGreen()) : 0xFF,
<a name="l00583"></a>00583              c ? <span class="keywordtype">int</span>(255*c-&gt;GetBlue()) : 0xFF,
<a name="l00584"></a>00584              draw_style == <a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr.html#a6b393ca7e14c69cf689ce7274f8a7630abb85e6313ec27720fcbae236740dd4c9">VisAttr::SOLID</a> ? <span class="stringliteral">&quot;Solid&quot;</span> : <span class="stringliteral">&quot;Wireframe&quot;</span>,
<a name="l00585"></a>00585              line_style == <a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr.html#a6b393ca7e14c69cf689ce7274f8a7630abb85e6313ec27720fcbae236740dd4c9">VisAttr::SOLID</a> ? <span class="stringliteral">&quot;Solid&quot;</span> : <span class="stringliteral">&quot;Dashed&quot;</span>,
<a name="l00586"></a>00586              <a class="code" href="class_d_d4hep_1_1_handle.html#a9c62b8d37e0f2354bae0093498dc15a1" title="Access the object name (or &amp;quot;&amp;quot; if not supported by the object).">name</a>()
<a name="l00587"></a>00587              );
<a name="l00588"></a>00588     <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetLineWidth(10);
<a name="l00589"></a>00589     <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetLineColor(dark);
<a name="l00590"></a>00590     <span class="keywordflow">if</span> (draw_style == <a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr.html#a6b393ca7e14c69cf689ce7274f8a7630abb85e6313ec27720fcbae236740dd4c9">VisAttr::SOLID</a>) {
<a name="l00591"></a>00591       <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetLineColor(bright);
<a name="l00592"></a>00592 <span class="preprocessor">#if ROOT_VERSION_CODE &gt;= ROOT_VERSION(5,34,25)</span>
<a name="l00593"></a>00593 <span class="preprocessor"></span>      <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetFillColorAlpha(bright,vis-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html#a9a5d2ab42c03b32cb5f69294881ac756">alpha</a>);
<a name="l00594"></a>00594 <span class="preprocessor">#else</span>
<a name="l00595"></a>00595 <span class="preprocessor"></span>      <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetFillColor(bright);
<a name="l00596"></a>00596 <span class="preprocessor">#endif</span>
<a name="l00597"></a>00597 <span class="preprocessor"></span>      <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetFillStyle(1001);   <span class="comment">// Root: solid</span>
<a name="l00598"></a>00598       <span class="comment">// Suggested by Nikiforos. Not optimal.</span>
<a name="l00599"></a>00599       <span class="comment">//m_element-&gt;GetMedium()-&gt;GetMaterial()-&gt;SetTransparency((1-vis-&gt;alpha)*100);</span>
<a name="l00600"></a>00600 
<a name="l00601"></a>00601 <span class="preprocessor">#if ROOT_VERSION_CODE &gt;= ROOT_VERSION(6,0,0)</span>
<a name="l00602"></a>00602 <span class="preprocessor"></span>      <span class="comment">// As suggested by Valentin Volkl https://sft.its.cern.ch/jira/browse/DDFORHEP-20</span>
<a name="l00603"></a>00603       <span class="comment">//</span>
<a name="l00604"></a>00604       <span class="comment">// According to https://root.cern.ch/phpBB3/viewtopic.php?t=2309#p66013</span>
<a name="l00605"></a>00605       <span class="comment">// a transparency&gt;50 will make a volume invisible in the normal pad.</span>
<a name="l00606"></a>00606       <span class="comment">// Hence: possibly restrict transparency to a maximum of 50.</span>
<a name="l00607"></a>00607       <span class="comment">//        but let&apos;s see first how this behaves.</span>
<a name="l00608"></a>00608       <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetTransparency((1-vis-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr_object.html#a9a5d2ab42c03b32cb5f69294881ac756">alpha</a>)*100);
<a name="l00609"></a>00609 <span class="preprocessor">#endif</span>
<a name="l00610"></a>00610 <span class="preprocessor"></span>    }
<a name="l00611"></a>00611     <span class="keywordflow">else</span> {
<a name="l00612"></a>00612       <a class="code" href="namespace_d_d4hep.html#a6d434af620a49074f3d86d05a04b6073">printout</a>(<a class="code" href="namespace_d_d4hep.html#a5b5a64d56252469451f2020a27d57d42ad22cda76fc1b3a55bc359945db9c811c">DEBUG</a>,<span class="stringliteral">&quot;setVisAttributes&quot;</span>,<span class="stringliteral">&quot;Set to wireframe vis:%s&quot;</span>,<a class="code" href="class_d_d4hep_1_1_handle.html#a9c62b8d37e0f2354bae0093498dc15a1" title="Access the object name (or &amp;quot;&amp;quot; if not supported by the object).">name</a>());
<a name="l00613"></a>00613       <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetLineColor(kBlack);
<a name="l00614"></a>00614       <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetFillColor(0);
<a name="l00615"></a>00615       <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetFillStyle(0);      <span class="comment">// Root: hollow</span>
<a name="l00616"></a>00616     }
<a name="l00617"></a>00617     <span class="keywordflow">if</span> (line_style == <a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr.html#a6b393ca7e14c69cf689ce7274f8a7630abb85e6313ec27720fcbae236740dd4c9">VisAttr::SOLID</a>)  <span class="comment">// Root line style: 1=solid, 2=dash, 3=dot, 4=dash-dot.</span>
<a name="l00618"></a>00618       <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetLineStyle(1);
<a name="l00619"></a>00619     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line_style == <a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr.html#a6b393ca7e14c69cf689ce7274f8a7630af20eddb2bef47dfd54509f51e7d8459a">VisAttr::DASHED</a>)
<a name="l00620"></a>00620       <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetLineStyle(2);
<a name="l00621"></a>00621     <span class="keywordflow">else</span>
<a name="l00622"></a>00622       <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetLineStyle(line_style);
<a name="l00623"></a>00623 
<a name="l00624"></a>00624 
<a name="l00625"></a>00625     <span class="comment">/*</span>
<a name="l00626"></a>00626 <span class="comment">      m_element-&gt;SetVisibility(kTRUE);</span>
<a name="l00627"></a>00627 <span class="comment">      m_element-&gt;SetAttBit(TGeoAtt::kVisContainers, kTRUE);</span>
<a name="l00628"></a>00628 <span class="comment">      m_element-&gt;SetVisDaughters(kTRUE);</span>
<a name="l00629"></a>00629 <span class="comment">      printout(INFO,&quot;setVisAttributes&quot;,&quot;Set Line color for volume %s&quot;,name());</span>
<a name="l00630"></a>00630 <span class="comment">      m_element-&gt;SetLineColor(bright);</span>
<a name="l00631"></a>00631 <span class="comment">      m_element-&gt;SetFillColor(bright);</span>
<a name="l00632"></a>00632 <span class="comment">      m_element-&gt;SetFillStyle(1001);   // Root: solid</span>
<a name="l00633"></a>00633 <span class="comment">      if (line_style == VisAttr::SOLID)</span>
<a name="l00634"></a>00634 <span class="comment">      m_element-&gt;SetFillStyle(1);</span>
<a name="l00635"></a>00635 <span class="comment">      else if (line_style == VisAttr::DASHED)</span>
<a name="l00636"></a>00636 <span class="comment">      m_element-&gt;SetFillStyle(2);</span>
<a name="l00637"></a>00637 <span class="comment">      else</span>
<a name="l00638"></a>00638 <span class="comment">      m_element-&gt;SetFillStyle(line_style);</span>
<a name="l00639"></a>00639 <span class="comment">      m_element-&gt;SetLineWidth(10);</span>
<a name="l00640"></a>00640 <span class="comment">    */</span>
<a name="l00641"></a>00641   }
<a name="l00642"></a>00642   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">Volume::Object</a>* o = <a class="code" href="_volumes_8cpp.html#a1c1cde892e7b9b8d7ff4c77fb2b7aa34">_userExtension</a>(*<span class="keyword">this</span>);
<a name="l00643"></a>00643   <span class="keywordflow">if</span> ( o ) o-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#ae4a19cb963f258f84a6fa871e8b6f4c1" title="Reference to visualization attributes.">vis</a> = attr;
<a name="l00644"></a>00644   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00645"></a>00645 }
<a name="l00646"></a>00646 
<a name="l00648"></a>00648 <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5db10a2a883d77b2654fe1875d5d7bb5" title="Set Visualization attributes to the volume.">Volume::setVisAttributes</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html" title="The main interface to the DD4hep detector description package.">LCDD</a>&amp; lcdd, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; nam)<span class="keyword"> const </span>{
<a name="l00649"></a>00649   <span class="keywordflow">if</span> (!nam.empty()) {
<a name="l00650"></a>00650     <a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr.html" title="Handle class describing visualization attributes.">VisAttr</a> attr = lcdd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#abb60505e37d62147725d126cb21d171b" title="Accessor to the map of visualisation attributes.">visAttributes</a>(nam);
<a name="l00651"></a>00651     <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5db10a2a883d77b2654fe1875d5d7bb5" title="Set Visualization attributes to the volume.">setVisAttributes</a>(attr);
<a name="l00652"></a>00652   }
<a name="l00653"></a>00653   <span class="keywordflow">else</span> {
<a name="l00654"></a>00654     <span class="comment">/*</span>
<a name="l00655"></a>00655 <span class="comment">      string tag = this-&gt;name();</span>
<a name="l00656"></a>00656 <span class="comment">      if ( ::strstr(tag.c_str(),&quot;_slice&quot;) )       // Slices turned off by default</span>
<a name="l00657"></a>00657 <span class="comment">      setVisAttributes(lcdd.visAttributes(&quot;InvisibleNoDaughters&quot;));</span>
<a name="l00658"></a>00658 <span class="comment">      else if ( ::strstr(tag.c_str(),&quot;_layer&quot;) )  // Layers turned off, but daughters possibly visible</span>
<a name="l00659"></a>00659 <span class="comment">      setVisAttributes(lcdd.visAttributes(&quot;InvisibleWithDaughters&quot;));</span>
<a name="l00660"></a>00660 <span class="comment">      else if ( ::strstr(tag.c_str(),&quot;_module&quot;) ) // Tracker modules similar to layers</span>
<a name="l00661"></a>00661 <span class="comment">      setVisAttributes(lcdd.visAttributes(&quot;InvisibleWithDaughters&quot;));</span>
<a name="l00662"></a>00662 <span class="comment">      else if ( ::strstr(tag.c_str(),&quot;_module_component&quot;) ) // Tracker modules similar to layers</span>
<a name="l00663"></a>00663 <span class="comment">      setVisAttributes(lcdd.visAttributes(&quot;InvisibleNoDaughters&quot;));</span>
<a name="l00664"></a>00664 <span class="comment">    */</span>
<a name="l00665"></a>00665   }
<a name="l00666"></a>00666   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00667"></a>00667 }
<a name="l00668"></a>00668 
<a name="l00670"></a>00670 <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#add08120b9db1393b5db41b5cf2cd3e01" title="Attach attributes to the volume.">Volume::setAttributes</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html" title="The main interface to the DD4hep detector description package.">LCDD</a>&amp; lcdd, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; rg, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; ls, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; vis)<span class="keyword"> const </span>{
<a name="l00671"></a>00671   <span class="keywordflow">if</span> (!rg.empty())
<a name="l00672"></a>00672     <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a4070385330a1c5200adaaa13ef4e6547" title="Set the regional attributes to the volume. Note: If the name string is empty, the...">setRegion</a>(lcdd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#adbe06759881707fe995472c03810c0ff" title="Retrieve a region object by it&amp;#39;s name from the detector description.">region</a>(rg));
<a name="l00673"></a>00673   <span class="keywordflow">if</span> (!ls.empty())
<a name="l00674"></a>00674     <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5c4e1991240829fbf7de49a281984550" title="Set the limits to the volume. Note: If the name string is empty, the action is ignored...">setLimitSet</a>(lcdd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#a7e98996675e9c00d6b64010415511813" title="Retrieve a limitset by it&amp;#39;s name from the detector description.">limitSet</a>(ls));
<a name="l00675"></a>00675   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5db10a2a883d77b2654fe1875d5d7bb5" title="Set Visualization attributes to the volume.">setVisAttributes</a>(lcdd, vis);
<a name="l00676"></a>00676   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00677"></a>00677 }
<a name="l00678"></a>00678 
<a name="l00680"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a53c50a053aebaff28bb27a36c824db50">00680</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr.html" title="Handle class describing visualization attributes.">VisAttr</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a53c50a053aebaff28bb27a36c824db50" title="Access the visualisation attributes.">Volume::visAttributes</a>()<span class="keyword"> const </span>{
<a name="l00681"></a>00681   <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">Object</a>* o = <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(*<span class="keyword">this</span>, <span class="keyword">false</span>);
<a name="l00682"></a>00682   <span class="keywordflow">if</span> (o)
<a name="l00683"></a>00683     <span class="keywordflow">return</span> o-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#ae4a19cb963f258f84a6fa871e8b6f4c1" title="Reference to visualization attributes.">vis</a>;
<a name="l00684"></a>00684   <span class="keywordflow">return</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_vis_attr.html" title="Handle class describing visualization attributes.">VisAttr</a>();
<a name="l00685"></a>00685 }
<a name="l00686"></a>00686 
<a name="l00688"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#ab620d3dc2b453442d9b806e338b661f7">00688</a> <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#ab620d3dc2b453442d9b806e338b661f7" title="Set the volume&amp;#39;s solid shape.">Volume::setSolid</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_solid__type.html">Solid</a>&amp; s)<span class="keyword"> const </span>{
<a name="l00689"></a>00689   <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a>-&gt;SetShape(s);
<a name="l00690"></a>00690   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00691"></a>00691 }
<a name="l00692"></a>00692 
<a name="l00694"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a35ba3ff621375ca5fb8e5c9474e4e179">00694</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_solid__type.html">Solid</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a35ba3ff621375ca5fb8e5c9474e4e179" title="Access to Solid (Shape).">Volume::solid</a>()<span class="keyword"> const </span>{
<a name="l00695"></a>00695   <span class="keywordflow">return</span> <a class="code" href="namespace_d_d4hep_1_1_geometry.html#a83de90a8dcc7378ba47d54ef9a6a687b">Solid</a>((*this)-&gt;GetShape());
<a name="l00696"></a>00696 }
<a name="l00697"></a>00697 
<a name="l00699"></a>00699 <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a4070385330a1c5200adaaa13ef4e6547" title="Set the regional attributes to the volume. Note: If the name string is empty, the...">Volume::setRegion</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html" title="The main interface to the DD4hep detector description package.">LCDD</a>&amp; lcdd, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; nam)<span class="keyword"> const </span>{
<a name="l00700"></a>00700   <span class="keywordflow">if</span> (!nam.empty()) {
<a name="l00701"></a>00701     <span class="keywordflow">return</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a4070385330a1c5200adaaa13ef4e6547" title="Set the regional attributes to the volume. Note: If the name string is empty, the...">setRegion</a>(lcdd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#adbe06759881707fe995472c03810c0ff" title="Retrieve a region object by it&amp;#39;s name from the detector description.">region</a>(nam));
<a name="l00702"></a>00702   }
<a name="l00703"></a>00703   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00704"></a>00704 }
<a name="l00705"></a>00705 
<a name="l00707"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a9078b71f780beef0718462d48c0fda0f">00707</a> <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a4070385330a1c5200adaaa13ef4e6547" title="Set the regional attributes to the volume. Note: If the name string is empty, the...">Volume::setRegion</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_region.html" title="Handle class describing a region as used in simulation.">Region</a>&amp; obj)<span class="keyword"> const </span>{
<a name="l00708"></a>00708   <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(*this)-&gt;region = obj;
<a name="l00709"></a>00709   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00710"></a>00710 }
<a name="l00711"></a>00711 
<a name="l00713"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a849db64ccfd2670fd485593f67ae2bb3">00713</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_region.html" title="Handle class describing a region as used in simulation.">Region</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a849db64ccfd2670fd485593f67ae2bb3" title="Access to the handle to the region structure.">Volume::region</a>()<span class="keyword"> const </span>{
<a name="l00714"></a>00714   <span class="keywordflow">return</span> <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(*this)-&gt;region;
<a name="l00715"></a>00715 }
<a name="l00716"></a>00716 
<a name="l00718"></a>00718 <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5c4e1991240829fbf7de49a281984550" title="Set the limits to the volume. Note: If the name string is empty, the action is ignored...">Volume::setLimitSet</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html" title="The main interface to the DD4hep detector description package.">LCDD</a>&amp; lcdd, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; nam)<span class="keyword"> const </span>{
<a name="l00719"></a>00719   <span class="keywordflow">if</span> (!nam.empty()) {
<a name="l00720"></a>00720     <span class="keywordflow">return</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5c4e1991240829fbf7de49a281984550" title="Set the limits to the volume. Note: If the name string is empty, the action is ignored...">setLimitSet</a>(lcdd.<a class="code" href="class_d_d4hep_1_1_geometry_1_1_l_c_d_d.html#a7e98996675e9c00d6b64010415511813" title="Retrieve a limitset by it&amp;#39;s name from the detector description.">limitSet</a>(nam));
<a name="l00721"></a>00721   }
<a name="l00722"></a>00722   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00723"></a>00723 }
<a name="l00724"></a>00724 
<a name="l00726"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a9d569026c41f483a7f54a9a6947c96cd">00726</a> <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a5c4e1991240829fbf7de49a281984550" title="Set the limits to the volume. Note: If the name string is empty, the action is ignored...">Volume::setLimitSet</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_limit_set.html" title="Handle class describing a set of limits as they are used for simulation.">LimitSet</a>&amp; obj)<span class="keyword"> const </span>{
<a name="l00727"></a>00727   <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(*this)-&gt;limits = obj;
<a name="l00728"></a>00728   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00729"></a>00729 }
<a name="l00730"></a>00730 
<a name="l00732"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aeadd5c51ef8dc4c601e191beea40edbc">00732</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_limit_set.html" title="Handle class describing a set of limits as they are used for simulation.">LimitSet</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#aeadd5c51ef8dc4c601e191beea40edbc" title="Access to the limit set.">Volume::limitSet</a>()<span class="keyword"> const </span>{
<a name="l00733"></a>00733   <span class="keywordflow">return</span> <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(*this)-&gt;limits;
<a name="l00734"></a>00734 }
<a name="l00735"></a>00735 
<a name="l00737"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a0aab37c2e9c3d24ebbc6642f0951e217">00737</a> <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html" title="Handle class holding a placed volume (also called physical volume).">Volume</a>&amp; <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a0aab37c2e9c3d24ebbc6642f0951e217" title="Assign the sensitive detector structure.">Volume::setSensitiveDetector</a>(<span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_sensitive_detector.html" title="Handle class to hold the information of a sensitive detector.">SensitiveDetector</a>&amp; obj)<span class="keyword"> const </span>{
<a name="l00738"></a>00738   <span class="comment">//cout &lt;&lt; &quot;Setting sensitive detector &apos;&quot; &lt;&lt; obj.name() &lt;&lt; &quot;&apos; to volume:&quot; &lt;&lt; ptr() &lt;&lt; &quot; &quot; &lt;&lt; name() &lt;&lt; endl;</span>
<a name="l00739"></a>00739   <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(*this)-&gt;sens_det = obj;
<a name="l00740"></a>00740   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00741"></a>00741 }
<a name="l00742"></a>00742 
<a name="l00744"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a8dcf0ca9c159ed116f3f85fd67efa336">00744</a> <a class="code" href="group___d_d4_h_e_p___g_e_o_m_e_t_r_y.html#ga40af83be6718bb8828a3d83dc7f8c930" title="Default Ref_t definition describing named objects.">Ref_t</a> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a8dcf0ca9c159ed116f3f85fd67efa336" title="Access to the handle to the sensitive detector.">Volume::sensitiveDetector</a>()<span class="keyword"> const </span>{
<a name="l00745"></a>00745   <span class="keyword">const</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html" title="Implementation class extending the ROOT volume (TGeoVolume).">Object</a>* o = <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(*<span class="keyword">this</span>);
<a name="l00746"></a>00746   <span class="keywordflow">return</span> o-&gt;<a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume_extension.html#a3b0ac7f31e5c962f0eb479c24d4c72ea" title="Reference to the sensitive detector.">sens_det</a>;
<a name="l00747"></a>00747 }
<a name="l00748"></a>00748 
<a name="l00750"></a><a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a7b4a6460ec44a12b59fc1a00556c21cf">00750</a> <span class="keywordtype">bool</span> <a class="code" href="class_d_d4hep_1_1_geometry_1_1_volume.html#a7b4a6460ec44a12b59fc1a00556c21cf" title="Accessor if volume is sensitive (ie. is attached to a sensitive detector).">Volume::isSensitive</a>()<span class="keyword"> const </span>{
<a name="l00751"></a>00751   <span class="keywordflow">return</span> <a class="code" href="_volumes_8cpp.html#a1fed71b283145beb621afd55ac0d795a">_data</a>(*this)-&gt;sens_det.isValid();
<a name="l00752"></a>00752 }
<a name="l00753"></a>00753 
<a name="l00755"></a>00755 <a class="code" href="class_d_d4hep_1_1_geometry_1_1_assembly.html#a18347f291bd562b3ef99fe05f043b03c" title="Default constructor.">Assembly::Assembly</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; nam) {
<a name="l00756"></a>00756   <a class="code" href="class_d_d4hep_1_1_handle.html#a207411705e86b0f4053357c7a8b5532e" title="Single and only data member: Reference to the actual element.">m_element</a> = _createTGeoVolumeAssembly(nam);
<a name="l00757"></a>00757 }
<a name="l00758"></a>00758 
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<!--BEGIN GENERATE_TREEVIEW-->
    <li class="footer">$generatedby
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </li>
   </ul>
 </div>
<!--END GENERATE_TREEVIEW-->
<!--BEGIN !GENERATE_TREEVIEW-->
<hr class="footer"/><address class="footer"><small>
$generatedby &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.6.1
</small></address>
<!--END !GENERATE_TREEVIEW-->
</body>
</html>
